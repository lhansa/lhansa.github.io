<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Leonardo Hansa</title>
<link>https://lhansa.github.io/contenidos.html</link>
<atom:link href="https://lhansa.github.io/contenidos.xml" rel="self" type="application/rss+xml"/>
<description>Tips sobre análisis de datos</description>
<generator>quarto-1.4.553</generator>
<lastBuildDate>Mon, 18 Mar 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>Relaciones espurias</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2024-03-18-correlation/</link>
  <description><![CDATA[ 





<p>Tienes un datos de divorcio en estados de Estados Unidos (<a href="https://xcelab.net/rm/statistical-rethinking/">fuente</a>).</p>
<p>Parece que hay correlación entre el ratio de divorcio por estado y la edad mediana a la que se casa la gente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>())</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> MedianAgeMarriage, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Divorce)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-03-18-correlation/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El ratio de divorcio por estado dada la mediana de edad de casarse podrías modelizarlo como:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AD_i%20%5Csim%20%5Ctext%7BNormal%7D(%5Cmu_i,%20%5Csigma)%0A%5C%5C%0A%5Cmu_i%20=%20%5Calpha%20+%20%5Cbeta_AA_i%0A%5C%5C%0A%5Calpha%20%5Csim%20%5Ctext%7BNormal(0,%200,2)%7D%0A%5C%5C%0A%5Cbeta_A%20%5Csim%20%5Ctext%7BNormal(0,%200,5)%7D%0A%5C%5C%0A%5Csigma%20%5Csim%20%5Ctext%7BExponential(1)%7D%0A"></p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?D_i"> el ratio de divorcio estandarizado (media 0, desviación típica 1) para el Estado <img src="https://latex.codecogs.com/png.latex?i">.</li>
<li><img src="https://latex.codecogs.com/png.latex?A_i"> es la edad mediana a la que se casa la gente en el Estado <img src="https://latex.codecogs.com/png.latex?i">.</li>
<li>Como el ratio que modelizamos está centrado en 0, el intercept del modelo es esperable que sea cercano a 0.</li>
<li>Sobre <img src="https://latex.codecogs.com/png.latex?%5Cbeta_A">, si fuera igual a 1, estaríamos diciendo que por cada cambio de una desviación estándar de la edad, observaríamos un cambio de una desviación estándar en el ratio del divorcio. La desviación estándar de la edad es 1.2436303, por lo que si <img src="https://latex.codecogs.com/png.latex?%5Cbeta_A%20=%201">, un cambio de <img src="https://latex.codecogs.com/png.latex?%7B1,2%7D"> años en la mediana de edad de casarse aumentaría el ratio de divorcio en una desviación estándar, lo que parece ser demasiado fuerte.</li>
</ul>
<p>Ahora podemos ajustar el modelo y simular:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">m5<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quap</span>(</span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alist</span>(</span>
<span id="cb2-3">    D <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(mu, sigma), </span>
<span id="cb2-4">    mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> A, </span>
<span id="cb2-5">    a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), </span>
<span id="cb2-6">    bA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), </span>
<span id="cb2-7">    sigma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dexp</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-8">  ), </span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d</span>
<span id="cb2-10">)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb3-2">prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract.prior</span>(m5<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span>)</span>
<span id="cb3-3">mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">link</span>( m5<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span> , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">post=</span>prior , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) ) )</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>( <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span> , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) )</span>
<span id="cb3-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ( i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> ) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) , mu[i,] , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col.alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-03-18-correlation/index_files/figure-html/extract-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>



 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2024-03-18-correlation/</guid>
  <pubDate>Mon, 18 Mar 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>¿Cómo surge la distribución normal?</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2024-02-24-normality/</link>
  <description><![CDATA[ 





<p>La distribución normal siempre me ha parecido demasiado perfecta para esperar verla en unos datos reales.</p>
<p>Pero claro, eso me pasa por no saber de dónde viene.</p>
<p>Te cuento.</p>
<p>Imagina un grupo de personas que parten de una línea. Cada uno lanza una moneda al aire; si sale cara, da un paso a la izquierda, de máximo 1 metro; si no, lo da a la derecha. Los pasos estarán entre 0 y 1 metro. Al cabo de 16 lanzamientos, ¿a qué distancia estará del origen?</p>
<p>Será la suma de las distancias de esos pasos.</p>
<p>Podemos calcular esto para 1000 personas.</p>
<p>Primero si dan 4 pasos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(pos)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/pasos4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora si dan 8 pasos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(pos)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/pasos8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora si dan 16:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(pos)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/pasos16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Realmente, casi con cualquier distribución puedes hacer esto. La suma de valores de cualquier distribución seguirá una distribución normal (con algunas necesitarás una muestra más grande que con otras).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpois</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/suma-pois-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="ejemplo-de-modelo-basado-en-la-normalidad" class="level2">
<h2 class="anchored" data-anchor-id="ejemplo-de-modelo-basado-en-la-normalidad">Ejemplo de modelo basado en la normalidad</h2>
<p>La altura de varias personas adultas es esperable que se distribuya como una distribución normal.</p>
<p>La idea intuitiva es que la altura de una persona adulta es el resultado de muchos pequeños aumentos que se suman. Para distintos individuos, estas sumas darán resultados distintos, porque los aumentos progresivos entre ellos serán distintos al cabo de los años. Pero el conjunto de todas ellas será normal, si has esperado suficientes años para que los casos más altos (aumentos más grandes acumulados) se compensen con los más bajos (aumentos más pequeños).</p>
<p>Vamos a trabajar con una muestra de personas, de las que conocemos su altura.</p>
<p>Queremos modelizar la altura como una distribución normal, o sea, estimaremos la media y desviación típica.</p>
<p>El método bayesiano considerará todas las medias y desviaciones típicas posibles (realmente haremos una aproximación), y evaluaremos cada una en función de cómo de plausibles son, dados los datos que tenemos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rethinking)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(Howell1)</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(Howell1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   height   weight age male
1 151.765 47.82561  63    1
2 139.700 36.48581  63    0
3 136.525 31.86484  65    0
4 156.845 53.04191  41    1
5 145.415 41.27687  51    0
6 163.830 62.99259  35    1</code></pre>
</div>
</div>
<p>Por ahora, vamos a centrarnos solo en los casos adultos, porque la altura de los niños no se distribuye normalmente, sino que está correlada con la edad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">adultos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Howell1[Howell1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, ]</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(adultos<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>height, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Queremos modelizar la altura <img src="https://latex.codecogs.com/png.latex?h_i"> de cada individuo <img src="https://latex.codecogs.com/png.latex?i"> como <img src="https://latex.codecogs.com/png.latex?h_i%20%5Csim%20%5Ccal%7BN%7D(%5Cmu,%20%5Csigma)">. <strong>El objetivo es estimar</strong> <img src="https://latex.codecogs.com/png.latex?%5Cmu"> y <img src="https://latex.codecogs.com/png.latex?%5Csigma">.</p>
<p>Como estamos en un modelo bayesiano, necesitamos unos prioris para ambos parámetros. Los prioris son distribuciones de estos parámetros que consideramos razonables.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ah_i%20%5Csim%20%5Ccal%7BN%7D(%5Cmu,%20%5Csigma)%0A%5C%5C%0A%5Cmu%20%5Csim%20%5Ccal%7BN%7D(178,%2020)%0A%5C%5C%0A%5Csigma%20%5Csim%20%5Ccal%7BU%7D(0,%2050)%0A"></p>
<p>Estamos dando como distribución a priori de la media una normal centrada en <img src="https://latex.codecogs.com/png.latex?%5Ccal%7B178%7D"> y con un rango de <img src="https://latex.codecogs.com/png.latex?%5Ccal%7B40%7D">cm con una probablidad de 95%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/howell1-priori-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La priori sobre la desviación típica es plana, en el sentido de que no sabemos dar más importancia a unos valores frente a otros, dentro los propuestos en el intervalo de la uniforme.</p>
<p>Podemos simular cómo serían unos datos a partir de estas prioris.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">sample_mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb9-2">sample_sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb9-3"></span>
<span id="cb9-4">prior_h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, sample_mu, sample_sigma)</span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dens</span>(prior_h, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/simulacion-prioris-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Lo que hemos hecho es simular 10.000 pares de <img src="https://latex.codecogs.com/png.latex?%5Cmu"> y <img src="https://latex.codecogs.com/png.latex?%5Csigma"> y para cada par hemos simulado una altura. Así tenemos 10.000 alturas, cada una originada a partir de una población normal distinta (pero todas las poblaciones normales son tan plausibles como indica nuestra priori).</p>
<p>Si cambiáramos la priori, la simulación a priori de la altura se vería afectada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">sample_mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb10-2"></span>
<span id="cb10-3">prior_h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, sample_mu, sample_sigma)</span>
<span id="cb10-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dens</span>(prior_h, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/simulacion-prioris2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esa es una priori menos informativa, con una media mucho más dispersa. Pero puedes ver que las alturas que derivarían de unas prioris así no son realistas, dado que hay casos de altura negativa o también demasiado altos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">fit_altura <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quap</span>( </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alist</span>(</span>
<span id="cb11-3">    height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>( mu , sigma ) ,</span>
<span id="cb11-4">    mu <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>( <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span> , <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> ) ,</span>
<span id="cb11-5">    sigma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dunif</span>( <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> , <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> )</span>
<span id="cb11-6">  ), </span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> adultos</span>
<span id="cb11-8">)</span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">precis</span>(fit_altura)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           mean        sd       5.5%      94.5%
mu    154.65453 0.4172154 153.987737 155.321319
sigma   7.76233 0.2950801   7.290735   8.233925</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">posterior_h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract.samples</span>(fit_altura, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>)</span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(posterior_h<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mu, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/altura-posteriori-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2024-02-24-normality/</guid>
  <pubDate>Sat, 24 Feb 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Statistical Rethinking (2)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2024-01-24-rethinking-2/</link>
  <description><![CDATA[ 





<section id="por-qué-lo-normal-es-normal" class="level2">
<h2 class="anchored" data-anchor-id="por-qué-lo-normal-es-normal">Por qué lo normal es normal</h2>
<section id="normal-por-adición" class="level3">
<h3 class="anchored" data-anchor-id="normal-por-adición">Normal por adición</h3>
<p>Hay un experimento en el que pones a unas personas en línea con una moneda. Cada persona tiene una moneda que lanza 16 veces.</p>
<p>Por cada vez que sale cara, da un paso a la derecha; por cada vez que sale cruz, a la izquierda.</p>
<p>Cada paso será de una distancia aleatoria entre 0 y 1 metro. ¿Cuántos metros se ha desplazado cada persona con respecto al origen?</p>
<p>El experimento con una sola persona sería algo así:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">distancia_por_paso <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(distancia_por_paso)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.171815</code></pre>
</div>
</div>
<p>Nuestro sujeto ha recorrido 2.1718148 desde la línea.</p>
<p>Lo podemos extrapolar a 10000 sujetos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>())</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> pos), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-01-24-rethinking-2/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2024-01-24-rethinking-2/</guid>
  <pubDate>Wed, 24 Jan 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>¿Cómo se usan las prioris conjugadas?</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-31-conjugate-prior/</link>
  <description><![CDATA[ 





<p>En estadística bayesiana, cuando buscas estimar un parámetro, lo que vas a obtener es una distribución de este parámetro. O sea, no obtienes un valor preciso, sino unas probabilidades asociadas a varios valores, de forma que algunos serán más probables que otros.</p>
<p>Un método intuitivo de conseguir esta distribución es usar el método del mallado ( <em>grid approximation</em> ). Con este método, relacionas todos los casos posibles, calculas una verosimilitud para cada caso, y lo multiplicas por una probabilidad a priori que decidas. Ese producto es la distribución que buscas para tu parámetro, la posteriori.</p>
<p>En algunas situaciones, usar una priori en concreto te puede simplificar luego el cálculo, ya que no te hará falta aplicar los cálculos del mallado: puedes, pero el resultado será el mismo.</p>
<section id="prioris-conjugados" class="level2">
<h2 class="anchored" data-anchor-id="prioris-conjugados">Prioris conjugados</h2>
<p>En el caso de lanzar una moneda, estás trabajando con una binomial: tienes ciertos éxitos ante un número posible de casos.</p>
<p>Si en este caso, usas como priori la distribución beta, entonces surgirá la magia.</p>
<p>La distribución es</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">monedas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-2">caras <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, monedas, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-3">p_cara <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb1-4">sample_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-5"></span>
<span id="cb1-6">beta_alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-7">beta_beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbeta</span>(sample_size, beta_alpha, beta_beta), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-31-conjugate-prior/index_files/figure-html/setup-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(caras, p_cara))</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caras"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p_cara"</span>)</span></code></pre></div>
</div>
<p>Y podemos simular la posteriori con el método del mallado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbeta</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara, beta_alpha, beta_beta)</span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df$prior &lt;- dunif(df$p_cara)</span></span>
<span id="cb3-3"></span>
<span id="cb3-4">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbinom</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras, monedas, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara)</span>
<span id="cb3-5"></span>
<span id="cb3-6">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>likelihood <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior</span>
<span id="cb3-7">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>std_posteriori <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori)</span>
<span id="cb3-8"></span>
<span id="cb3-9"></span>
<span id="cb3-10">caras_observadas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb3-12">     df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas]), </span>
<span id="cb3-13">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"o"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilidad de cara"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilidad"</span>)</span>
<span id="cb3-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb3-15">      df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas]), </span>
<span id="cb3-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-31-conjugate-prior/index_files/figure-html/posterior1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La magia está en que, dado que la distribución a priori es una beta, no necesitamos simular la posteriori, sino que sabemos que ya seguirá una distribución en concreto (una beta también, con pequeños cambios en sus parámetros);</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">posteriori_simulation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbeta</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb4-2">                               beta_alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> caras_observadas, </span>
<span id="cb4-3">                               beta_beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> monedas <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> caras_observadas)</span>
<span id="cb4-4"></span>
<span id="cb4-5">posteriori_simulation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> posteriori_simulation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(posteriori_simulation)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb4-8">     df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas]), </span>
<span id="cb4-9">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"o"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilidad de cara"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilidad"</span>)</span>
<span id="cb4-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb4-11">      df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas]), </span>
<span id="cb4-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb4-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb4-14">      posteriori_simulation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-31-conjugate-prior/index_files/figure-html/posteriori-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-31-conjugate-prior/</guid>
  <pubDate>Sun, 31 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Statistical Rethinking (1)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-27-rethinking-1/</link>
  <description><![CDATA[ 





<p>En <a href="https://xcelab.net/rm/statistical-rethinking/">Statistical Rethinking</a> Richard McEalreath presenta los métodos generativos en estadística bayesiana.</p>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>El problema que plantea es el de estimar la proporción de agua que hay en la Tierra.</p>
<p>El procedimiento consiste en mirar en varios puntos de la Tierra y ver si hay agua o tierra. De esa forma obtienes una secuencia de valores: <code>"A", "A", "T", "A", "T", ...</code> y usas esos datos para estimar la proporción real.</p>
<p>Concretamente, en 9 observaciones has obtenido 6 porciones de agua.</p>
<p>Hay tres formas de ajustar un modelo estadístico. Las ejemplificaremos con ese problema de la proporción de agua.</p>
<p>Los códigos serán los del libro.</p>
</section>
<section id="mallado" class="level2">
<h2 class="anchored" data-anchor-id="mallado">Mallado</h2>
<p>La primera forma de ajustar un modelo estadístico es mediante mallado. Computacionalmente es costoso pero es más educativo que el resto de métodos.</p>
<p>Lo que vas a hacer es proponer unos posibles valores para el parámetro que buscas (la proporción de agua) y les das una distribución a priori a estos valores (no pasa nada ahora por que la distribución a priori no sume 1 porque luego estandarizarás el resultado final).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">grid_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define grid</span></span>
<span id="cb1-3">p_grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> grid_size)</span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define prior</span></span>
<span id="cb1-5">prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> , grid_size)</span></code></pre></div>
</div>
<p>Tus priori (20 proporciones equiprobables) ya están definidas y ahora te sirven para generar posibles escenarios. La idea es ver la verosimilitud de tus datos observados ante los distintos posibles valores del parámetro.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbinom</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p_grid)</span>
<span id="cb2-2">likelihood</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.000000e+00 1.518149e-06 8.185093e-05 7.772923e-04 3.598575e-03
 [6] 1.116095e-02 2.668299e-02 5.292110e-02 9.082698e-02 1.383413e-01
[11] 1.897686e-01 2.361147e-01 2.666113e-01 2.714006e-01 2.450051e-01
[16] 1.897686e-01 1.179181e-01 5.026670e-02 8.853845e-03 0.000000e+00</code></pre>
</div>
</div>
<p>Ahora calculas la posteriori, ponderando estas verosimilitudes por los prioris que tenías antes. Como los prioris no seguían una distribución de probabilidad, te toca estandarizar el resultado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">unstd_posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> likelihood <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> prior</span>
<span id="cb4-2">posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> unstd_posterior <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(unstd_posterior)</span>
<span id="cb4-3">posterior</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.000000e+00 7.989837e-07 4.307717e-05 4.090797e-04 1.893887e-03
 [6] 5.873873e-03 1.404294e-02 2.785174e-02 4.780115e-02 7.280739e-02
[11] 9.987296e-02 1.242643e-01 1.403143e-01 1.428349e-01 1.289433e-01
[16] 9.987296e-02 6.205890e-02 2.645477e-02 4.659673e-03 0.000000e+00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(p_grid, posterior, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>,</span>
<span id="cb6-2">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabidad de agua"</span> , </span>
<span id="cb6-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posteriori"</span>)</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mtext</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20 puntos"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-27-rethinking-1/index_files/figure-html/mallado-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora bien, ten en cuenta que <strong>los prioris forman parte del modelo</strong>. Deberías tener un criterio para elegir unos u otros.</p>
<p>Los puedes cambiar y los resultados se verán afectados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">p_grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> grid_size)</span>
<span id="cb7-2">prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(p_grid <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span>
<span id="cb7-3"></span>
<span id="cb7-4">likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbinom</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p_grid)</span>
<span id="cb7-5"></span>
<span id="cb7-6">unstd_posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  likelihood <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> prior</span>
<span id="cb7-7">posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> unstd_posterior <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(unstd_posterior)</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(p_grid, posterior, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>,</span>
<span id="cb7-10">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabidad de agua"</span> , </span>
<span id="cb7-11">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posteriori"</span>)</span>
<span id="cb7-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mtext</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%i puntos"</span>, grid_size))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-27-rethinking-1/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-27-rethinking-1/</guid>
  <pubDate>Wed, 27 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Introducción a análisis de supervivencia con R</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-22-survival-analysis/</link>
  <description><![CDATA[ 





<p>El nombre del análisis de supervivencia apunta maneras. Inevitablemente, yo lo relaciono con la muerte, porque seguramente se originara para saber cuánto tiempo le quedaba de vida a un paciente con alguna enfermedad.</p>
<p>Pero no sirve solo para eso.</p>
<p>Algunos ejemplos de casos que puedes resolver con análisis de supervivencia son:</p>
<ul>
<li>¿Cuál es la probabilidad de que un paciente con cáncer de mama viva más de 5 años?</li>
<li>¿Cuál es el tiempo de espera típico cuando llamas a un taxi?</li>
<li>De 100 parados, ¿cuántos esperas que encuentren trabajo pasados 2 meses?</li>
</ul>
<section id="teoría-del-análisis-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="teoría-del-análisis-de-supervivencia">Teoría del análisis de supervivencia</h2>
<p>Los modelos de supervivencia buscan modelizar la función de supervivencia, dada por esta ecuación:</p>
<p><img src="https://latex.codecogs.com/png.latex?S(t)%20=%201%20-%20F(t)%20=%20P(T%20%3E%20t)"></p>
<p>Viene a interpretarse como <strong>la probabilidad de que la duración del experimento sea mayor de <img src="https://latex.codecogs.com/png.latex?t"></strong>. <img src="https://latex.codecogs.com/png.latex?F(t)"> representa la función de distribución del evento.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-22-survival-analysis/index_files/figure-html/surv-func-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esa gráfica ya daría algo de información. Por ejemplo:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-22-survival-analysis/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Sabemos que la probabilidad de la probabilidad de superar el instante <img src="https://latex.codecogs.com/png.latex?t%20=%203"> es de 0,97.</li>
<li>Sabemos que el tercer cuartil es 5,65.</li>
</ul>
<p><strong>El objetivo del análisis de supervivencia es estimar esta función de supervivencia.</strong></p>
</section>
<section id="el-método-keplen-meier-para-estimar-la-función-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="el-método-keplen-meier-para-estimar-la-función-de-supervivencia">El método Keplen-Meier para estimar la función de supervivencia</h2>
<p>La fórmula que usa este método para estimar la función de supervivencia en <img src="https://latex.codecogs.com/png.latex?t"> es:</p>
<p><img src="https://latex.codecogs.com/png.latex?S(t)%20=%20%5Cprod_%7Bi:%20t_i%5Cleq%20t%7D%5Cfrac%7Bn_i%20-%20d_i%7D%7Bn_i%7D"></p>
<p>donde <img src="https://latex.codecogs.com/png.latex?t_i"> representa a cada uno de los instantes anteriores al instante <img src="https://latex.codecogs.com/png.latex?t">, <img src="https://latex.codecogs.com/png.latex?n_i"> es el número de individuos en <img src="https://latex.codecogs.com/png.latex?t_i"> y <img src="https://latex.codecogs.com/png.latex?d_i"> es el número de defunciones en <img src="https://latex.codecogs.com/png.latex?t_i">.</p>
<p>Lo podemos ver mejor con numeritos y este gráfico:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-22-survival-analysis/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(t)%20=%20%20%5Cprod_%7Bi:%20t_i%5Cleq%20t%7D%5Cfrac%7Bn_i%20-%20d_i%7D%7Bn_i%7D%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(2)%20=%20%5Cfrac%7B5-0%7D%7B5%7D%20=%20%5Cfrac%7B5%7D%7B5%7D%20=%201%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(3)%20=%20%5Cfrac%7B4-0%7D%7B4%7D%20=%20%5Cfrac%7B4%7D%7B4%7D%20=%201%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(4)%20=%20%5Cfrac%7B4-2%7D%7B4%7D%20=%20%5Cfrac%7B2%7D%7B4%7D%20=%200,5%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(5)%20=%20%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%20%5Cfrac%7B2-1%7D%7B2%7D%20=%20%5Cfrac%7B1%7D%7B4%7D%20=%200,25%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(6)%20=%20%5Cfrac%7B1%7D%7B4%7D%20%5Ccdot%20%5Cfrac%7B1-0%7D%7B1%7D%20=%20%5Cfrac%7B1%7D%7B4%7D%20=%200,25%0A"></p>
<p>Aunque después de avanzar un poco con el curso, me entero de que Keplen-Meier se usa principalmente con fines descritivos.</p>
</section>
<section id="método-weibull" class="level2">
<h2 class="anchored" data-anchor-id="método-weibull">Método Weibull</h2>
<p>Un método que sí se usa para estimar la curva es el de Weibull. Sinceramente, <strong>ni idea de cómo funciona.</strong></p>
<p>Pero una forma directa de ajustar y visualizarlo es esta (para visualizar simplifica mucho si usas la librería <strong>survminer</strong>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(survival)</span>
<span id="cb1-2">wb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survreg</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, lung)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve survival curve from model</span></span>
<span id="cb1-4">surv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">99</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>)</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get time for each probability</span></span>
<span id="cb1-7">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(wb, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quantile"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> surv, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create data frame with the information needed for ggsurvplot_df</span></span>
<span id="cb1-10">surv_wb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">surv =</span> surv, </span>
<span id="cb1-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">upper =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">std.err =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot</span></span>
<span id="cb1-14"></span>
<span id="cb1-15">survminer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot_df</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fit =</span> surv_wb, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">surv.geom =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>geom_line)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-22-survival-analysis/index_files/figure-html/weibull-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-22-survival-analysis/</guid>
  <pubDate>Fri, 22 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Comparativa pequeña entre tidyverse y R base</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-07-tidyverse-rbase/</link>
  <description><![CDATA[ 





<p>Me gusta leer <a href="https://github.com/matloff/TidyverseSkeptic">críticas contra tidyverse</a>. ¿Porque lo odio?</p>
<p>No, lo uso todo el rato. Todos los días. Mi trabajo se basa en <a href="https://www.tidyverse.org/">el tidyverse</a>.</p>
<p>¿Por qué leo críticas entonces?</p>
<p>Porque no entiendo que las haya. Así que me obligo a leer otros puntos de vista para ver en qué estoy equivocado.</p>
<p>Por ahora, gano yo. El link que publico al principio no es convincente. Un día le responderé al autor. Mientras tanto, estudio R base.</p>
<p>Me parece entretenido. Incluso bonito.</p>
<p>Y bromas aparte, le reconozco una cosa: <strong>me quita toda la gestión de dependencias.</strong> Cuando ejecuto este blog en GitHub Actions o cuando creo una librería, quitar dependencias simplifica mucho el trabajo y el proceso.</p>
<p>Eso sí me gusta de R base.</p>
<p>Pero para el día a día es un infierno.</p>
<p>Así que se me ha ocurrido hacerme un diccionario de R base y tidyverse, de cosas que consulto a veces.</p>
<p>Es un mini diccionario: faltarán muchas cosas aquí que te harán falta. Pero aquí encontrarás algunas que quizá te hagan falta. Y oye, si es así, tu búsqueda ha terminado.</p>
<section id="conversión-r-base---tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="conversión-r-base---tidyverse">Conversión R base - Tidyverse</h2>
<p>Para simplificar dependencias trabajaré, por supuesto, con <code>iris</code>.</p>
<table class="table">
<caption>Comparativa R base - Tidyverse</caption>
<colgroup>
<col style="width: 39%">
<col style="width: 18%">
<col style="width: 41%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Operación</strong></td>
<td><strong>Tidyverse</strong></td>
<td><strong>R base</strong></td>
</tr>
<tr class="even">
<td>Calcula la media de una métrica por grupo.</td>
<td><p><code>iris |&gt;</code></p>
<p><code>group_by(Species) |&gt;</code></p>
<p><code>summarise(mean(Sepal.Length))</code></p></td>
<td><p><code>aggregate(</code></p>
<p><code>Sepal.Length ~ Species,</code></p>
<p><code>iris,</code></p>
<p><code>mean)</code></p></td>
</tr>
<tr class="odd">
<td>Extrae los números de un texto (aplica a cualquer patrón, como DNI, razón social, etc).</td>
<td><p><code>str_extract(</code></p>
<p><code>"cosa123cosa",</code></p>
<p><code>"\\d+")</code></p></td>
<td><p><code>regmatches(</code></p>
<p><code>"cosa123cosa",</code></p>
<p><code>m = regexpr("\\d+", "cosa123cosa", perl = TRUE))</code></p></td>
</tr>
<tr class="even">
<td>Quédate con las observaciones cuyo valor (en una métrica) sea mayor que la media de su grupo.</td>
<td><p><code>iris |&gt;</code></p>
<p><code>group_by(Species) |&gt;</code></p>
<p><code>filter(Sepal.Lengh &gt;= mean(Sepal.Length))</code></p></td>
<td><p><code>do.call("rbind",</code></p>
<p><code>lapply(split(iris, iris$Species),</code></p>
<p><code>function(df) {               subset(df, Sepal.Length &gt;= mean(df$Sepal.Length)) }))</code></p></td>
</tr>
<tr class="odd">
<td>(*) Pasa de formato ancho a formato largo - Transformación <em>melt</em> - Pasa métricas a filas</td>
<td><p><code>iris |&gt;</code></p>
<p><code>pivot_longer(-Species)</code></p></td>
<td><p><code>iris$id &lt;- 1:nrow(iris)</code><br>
<code>reshape(iris,</code></p>
<p><code>idvar="id",</code></p>
<p><code>direction="long",          varying=list(1:4),         v.names = "value",         timevar="metric")</code></p></td>
</tr>
</tbody>
</table>
<p>En la 4ª he puesto un asterisco porque está mal. No soy capaz de hacer eso en R base de una manera razonablemente cómoda para mí.</p>
<p>Pero yo lo sigo intentando.</p>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-07-tidyverse-rbase/</guid>
  <pubDate>Thu, 07 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Advent of code (2)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-05-adventofcode-ii/</link>
  <description><![CDATA[ 





<p>Segundo ejercicio de <a href="https://adventofcode.com/">Advent of Code</a> de 2023. Voy con retraso, lo sé.</p>
<section id="parte-1" class="level2">
<h2 class="anchored" data-anchor-id="parte-1">Parte 1</h2>
<p>Mi propuesta con R base:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">total_cubes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">red =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">green =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">blue =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb1-2">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readLines</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-02.txt"</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4">data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Game 1: 12 red, 2 green, 5 blue; 9 red, 6 green, 4 blue; 10 red, 2 green, 5 blue; 8 blue, 9 red"
[2] "Game 2: 3 green, 7 red; 3 blue, 5 red; 2 green, 1 blue, 6 red; 3 green, 2 red, 3 blue"          
[3] "Game 3: 12 red, 18 blue, 3 green; 14 red, 4 blue, 2 green; 4 green, 15 red"                     
[4] "Game 4: 14 blue, 8 red, 10 green; 7 green, 9 blue, 4 red; 4 green, 5 red"                       
[5] "Game 5: 2 red, 1 blue, 4 green; 1 blue, 1 red, 5 green; 6 green, 3 red; 10 blue, 4 green, 1 red"</code></pre>
</div>
</div>
<p>Para cada juego (o sea, cada elemento en <code>data</code>) tengo que comprobar si las extracciones son posibles dada la cantidad de cubos original mencionada: 12 rojos, 13 verdes y 14 azules.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">validate_game <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(fila, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.total_cubes =</span> total_cubes){</span>
<span id="cb3-2">  fila <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Game [0-9]+: "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fila)</span>
<span id="cb3-3">  fila <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fila)</span>
<span id="cb3-4">  </span>
<span id="cb3-5">  is_valid_extract <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(fila, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], </span>
<span id="cb3-7">    validate_extract, </span>
<span id="cb3-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logical</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-9">  )</span>
<span id="cb3-10"> </span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(is_valid_extract)</span>
<span id="cb3-12"></span>
<span id="cb3-13">}</span>
<span id="cb3-14"></span>
<span id="cb3-15">validate_extract <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.total_cubes =</span> total_cubes) {</span>
<span id="cb3-16">  lgl_out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>),</span>
<span id="cb3-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(color, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> x) {</span>
<span id="cb3-19">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract with regex the number preceding word blue</span></span>
<span id="cb3-20">      pattern <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]+(?=%s)"</span>, color)</span>
<span id="cb3-21">      count_txt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regexpr</span>(pattern, text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb3-22">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(count_txt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb3-23">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-24">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>  {</span>
<span id="cb3-25">        count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(count_txt)</span>
<span id="cb3-26">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> total_cubes[[color]]  )</span>
<span id="cb3-27">      }</span>
<span id="cb3-28">      </span>
<span id="cb3-29">    }, </span>
<span id="cb3-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logical</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-31">  )</span>
<span id="cb3-32">  </span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(lgl_out)</span>
<span id="cb3-34">}</span>
<span id="cb3-35"></span>
<span id="cb3-36">valid_games <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-37">  data, </span>
<span id="cb3-38">  validate_game, </span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logical</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-40">)</span>
<span id="cb3-41"></span>
<span id="cb3-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count IDs of valid games</span></span>
<span id="cb3-43"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(valid_games))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2600</code></pre>
</div>
</div>
</section>
<section id="parte-2" class="level2">
<h2 class="anchored" data-anchor-id="parte-2">Parte 2</h2>
<p>Debería poner los enunciados aquí… pero paso.</p>
<p>Mi propuesta para la parte 2, siempre con R base:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">compute_power_game <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(fila){</span>
<span id="cb5-2">  fila <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Game [0-9]+: "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fila)</span>
<span id="cb5-3">  fila <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fila)</span>
<span id="cb5-4">  </span>
<span id="cb5-5">  color_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb5-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>),</span>
<span id="cb5-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(color) {</span>
<span id="cb5-8">      pattern <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]+(?=%s)"</span>, color)</span>
<span id="cb5-9">      color_count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(fila, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gregexpr</span>(pattern, fila, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb5-10">      color_count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(color_count)</span>
<span id="cb5-11">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(color_count)    </span>
<span id="cb5-12">    }, </span>
<span id="cb5-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-14">  )</span>
<span id="cb5-15">  </span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Reduce</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">*</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, color_counts)</span>
<span id="cb5-17"></span>
<span id="cb5-18">}</span>
<span id="cb5-19"></span>
<span id="cb5-20">game_powers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb5-21">  data, </span>
<span id="cb5-22">  compute_power_game, </span>
<span id="cb5-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-24">)</span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># part 2 solution</span></span>
<span id="cb5-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(game_powers)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86036</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-05-adventofcode-ii/</guid>
  <pubDate>Sat, 02 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Advent of code (1)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-01-adventofcode-i/</link>
  <description><![CDATA[ 





<p>Nunca he jugado con el <a href="https://adventofcode.com/">Advent of code</a>. Hoy me ha apetecido.</p>
<p>Para el ejercicio de hoy, me he empeñado <strong>en hacerlo en R base.</strong></p>
<section id="parte-1" class="level2">
<h2 class="anchored" data-anchor-id="parte-1">Parte 1</h2>
<p>El día 1 del <a href="https://adventofcode.com/2023">Advent of code 2023</a> nos pide que sumemos los números que aparecen en un texto.</p>
<p>El texto tiene una pinta así: <code>"four95qvkvveight5"</code>, y hay 1.000 como ese.</p>
<p>La idea es:</p>
<ul>
<li>tomar el primer dígito, 9,</li>
<li>y el último, 5</li>
<li>y concatenarlos: 95</li>
</ul>
<p>Así obtendrás 1000 números. La solución es la suma de esos 1.000 números.</p>
<p>Mi propuesta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readLines</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-01.txt"</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3">get_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb1-4">  str_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[^0-9]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, x)</span>
<span id="cb1-5">  len <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(str_number)</span>
<span id="cb1-6">  str_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(str_number, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(str_number, len, len))</span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(str_number))</span>
<span id="cb1-8">}</span>
<span id="cb1-9">numbers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb1-10">  data, </span>
<span id="cb1-11">  get_number,</span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-13">)</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(numbers)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55208</code></pre>
</div>
</div>
</section>
<section id="parte-2" class="level2">
<h2 class="anchored" data-anchor-id="parte-2">Parte 2</h2>
<p>Ahora hay un matiz. Fíjate de nuevo en el texto: <code>"four95qvkvveight5"</code>. Realmente, el primer número es <code>"four"</code>, o sea, 4. Lo que hay que hacer ahora es identificar el primer dígito y el último pero tanto si viene en número como en texto.</p>
<p>Luego igual, concatenarlos y sumarlos.</p>
<p>Mi propuesta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a character vector with the numbers from zero to nine in letters</span></span>
<span id="cb3-2">words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zero"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"one"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"two"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"three"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"four"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"five"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"six"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seven"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eight"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nine"</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4">split_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(words, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb3-5">words_inv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-6">  split_words, </span>
<span id="cb3-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>), </span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-9">)</span>
<span id="cb3-10"></span>
<span id="cb3-11">words_regex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-12">words_inv_regex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(words_inv, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-13"></span>
<span id="cb3-14">pattern <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]"</span>, words_regex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-15">pattern_inv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]"</span>, words_inv_regex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change the order of a text</span></span>
<span id="cb3-18">invert <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb3-19">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb3-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(x)</span>
<span id="cb3-21">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb3-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) )</span>
<span id="cb3-23">  }</span>
<span id="cb3-24">}</span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert a text to a number, based on the words and words_inv vectors</span></span>
<span id="cb3-27">to_numeric <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words_inv =</span> words_inv) {</span>
<span id="cb3-28">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb3-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(x))</span>
<span id="cb3-30">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> words) {</span>
<span id="cb3-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(words <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-32">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb3-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(words_inv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-34">  }</span>
<span id="cb3-35">}</span>
<span id="cb3-36"></span>
<span id="cb3-37">get_number2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, </span>
<span id="cb3-38">                        pattern, </span>
<span id="cb3-39">                        pattern_inv,</span>
<span id="cb3-40">                        words, </span>
<span id="cb3-41">                        words_inv) {</span>
<span id="cb3-42">  </span>
<span id="cb3-43">  first <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regexpr</span>(pattern, x))</span>
<span id="cb3-44">  first <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_numeric</span>(first, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words_inv =</span> words_inv)</span>
<span id="cb3-45">  </span>
<span id="cb3-46">  x_inv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">invert</span>(x)</span>
<span id="cb3-47">  last <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(x_inv, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regexpr</span>(pattern_inv, x_inv))</span>
<span id="cb3-48">  last <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">invert</span>(last)</span>
<span id="cb3-49">  last <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_numeric</span>(last, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words_inv =</span> words_inv)</span>
<span id="cb3-50">  </span>
<span id="cb3-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(first <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> last)</span>
<span id="cb3-52">  </span>
<span id="cb3-53">}</span>
<span id="cb3-54"></span>
<span id="cb3-55"></span>
<span id="cb3-56">numbers2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-57">  data, </span>
<span id="cb3-58">  get_number2,</span>
<span id="cb3-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> pattern,</span>
<span id="cb3-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern_inv =</span> pattern_inv,</span>
<span id="cb3-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> words, </span>
<span id="cb3-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words_inv =</span> words_inv,</span>
<span id="cb3-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN.VALUE =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-64">)</span>
<span id="cb3-65"></span>
<span id="cb3-66"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(numbers2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54578</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-01-adventofcode-i/</guid>
  <pubDate>Fri, 01 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>¿Qué formato de datos es más rápido de leer y escribir?</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-11-26-comparativa-tiempos-formatos-ficheros/</link>
  <description><![CDATA[ 





<p>He leído <a href="https://www.blog.dailydoseofds.com/p/the-most-overlooked-source-of-optimization">aquí</a> una comparativa entre tiempos de ejecución de lectura y escritura de varios tipos de ficheros de datos. Con Python.</p>
<p>Y he pensado:</p>
<blockquote class="blockquote">
<p>Lo voy a hacer yo con R.</p>
</blockquote>
<p>He creado dos data frames, a los que he llamado <code>df_numeric</code> y <code>df_mixed</code>. Ambos tienen un millón de filas y 20 columnas.</p>
<ul>
<li><code>df_numeric</code> tiene todas las columnas numéricas</li>
<li><code>df_mixed</code> tiene 10 columnas de tipo <code>character</code> y otras 10 de tipo <code>numeric</code>.</li>
</ul>
<p>Y lo que quiero es ver cuánto tardo en guardar cada uno en disco, en función del tipo de fichero y la función que elija.</p>
<section id="ficheros-con-columnas-numéricas" class="level2">
<h2 class="anchored" data-anchor-id="ficheros-con-columnas-numéricas">Ficheros con columnas numéricas</h2>
<p>Empiezo con el de todo numérico. Uso mi librería favorita, <code>microbenchmark</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">runtimes_numeric <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> microbenchmark<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">microbenchmark</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">csv_utils =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_utils.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">csv_readr =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_readr.csv"</span>),</span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fwrite =</span> data.table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fwrite</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_fwrite.csv"</span>),</span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rds_base =</span> base<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_base.rds"</span>),</span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rds_readr =</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_rds</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_readr.rds"</span>),</span>
<span id="cb1-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parquet =</span> arrow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_parquet</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric.parquet"</span>),</span>
<span id="cb1-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feather =</span> arrow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_feather</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric.feather"</span>),</span>
<span id="cb1-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>L</span>
<span id="cb1-10">)</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Unit: milliseconds
      expr         min         lq       mean     median         uq        max
 csv_utils 202203.9288 266623.082 282231.496 281121.287 302487.454 331668.044
 csv_readr   9055.3445   9846.454  20284.347  10764.766  12634.343 104354.622
    fwrite   1610.8502   8701.182   8911.451   9409.666  10717.019  11205.837
  rds_base  25460.8486  26287.225  29357.257  28765.523  32329.897  35358.147
 rds_readr    330.9374   3041.022   3080.719   3132.418   3334.561   5672.141
   parquet   3234.5500   8282.600   9649.330   9843.929  12261.475  12863.989
   feather    410.0282   4370.313   4700.664   4539.408   5586.161   7597.147
 neval
    10
    10
    10
    10
    10
    10
    10</code></pre>
</div>
</div>
<p>Voy a visualizar esto (se puede hacer directamente sobre la salida de la función <code>microbenchmark()</code> pero lo paso a data frame porque he querido hacer algunas pruebas con las que necesitaba más control, aunque al final no las muestro aquí porque no aportan nada).</p>
<p>Creo dos data frames para pintar los tiempos de cómputo y el tamaño de los ficheros. Los tiempos (milisegundos) vienen dados para ejecución: aquí están los primeros casos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       case       time
1   feather   410.0282
2    fwrite  1610.8502
3 rds_readr   330.9374
4   parquet  3234.5500
5  rds_base 27254.9053
6   feather  4436.2614
7   feather  7597.1466</code></pre>
</div>
</div>
<p>Tomo también el tamaño de los ficheros generados:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       size      case
1 106522192  rds_base
2 359999269    fwrite
3 385418847 csv_readr
4 160000514 rds_readr
5 359998865 csv_utils
6 133286834   feather
7 143632169   parquet</code></pre>
</div>
</div>
<p>Creo los gráficos por separado aunque se puede visualizar todo junto (pero me parece ganas de complicar).</p>
<p>Estos son los tiempos de cómputo (quito <code>utils::write.csv()</code> porque ya sabemos que tarda mucho).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-11-26-comparativa-tiempos-formatos-ficheros/index_files/figure-html/plot-numeric-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-11-26-comparativa-tiempos-formatos-ficheros/</guid>
  <pubDate>Sun, 26 Nov 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Cómo interpretas un intervalo de confianza</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-11-05-confianza/</link>
  <description><![CDATA[ 





<p>Creo que no entendí qué eran los intervalos de confianza en ninguna clase de estadística.</p>
<p>A ver, no digo que no me los explicaran.</p>
<p>Digo que, pese a que me los explicaron, no entendí nada de ellos.</p>
<p>En el mundo laboral me encuentro con dos situaciones contradictorias:</p>
<ul>
<li>Hay personas que defienden que todas las estimaciones que se dan deberían incluir los intervalos de confianza.</li>
<li>Pero hay personas, normalmente los consumidores o clientes de esas estimaciones, que no tienen ni idea de qué es un intervalo de confianza.</li>
</ul>
<p>Y no digo que sea culpa suya.</p>
<p>La verdad, con lo complicado que es el concepto (porque no tiene ni pies ni cabeza) y lo mal que lo dan, normal que no se enteren.</p>
<p>¿Se deberían dar los intervalos de confianza? Pues dado que algo de la incertidumbre de tus estimaciones deberías dar, mientras no tengas nada mejor, sí, deberías darlos.</p>
<p>Te muestro aquí un ejemplo de <strong>cómo se interpretan.</strong></p>
<section id="cálculo-del-intervalo" class="level2">
<h2 class="anchored" data-anchor-id="cálculo-del-intervalo">Cálculo del intervalo</h2>
<p>Voy a usar un ejemplo muy concreto.</p>
<p>¿Significa eso que lo que te voy a explicar solo sirve para este ejemplo?</p>
<p>No, es extrapolable. Pero necesito un ejemplo concreto porque si no, pasa lo de siempre: que nadie se entera de nada.</p>
<p>El ejemplo es <strong>estimar la media de una población a partir de la media de una muestra.</strong> Parece una bobada, lo sé, pero verás en breve que hay cierta incertidumbre al usar la media muestral para esto.</p>
<p>Con esto no digo que no uses la media muestral. Lo que digo es que seas consciente de que hay cierta incertidumbre.</p>
<p>Para jugar con esta incertidumbre, voy a recrear un ejemplo del que conozco la media poblacional, y veremos qué tal se comporta la media muestra.</p>
<p>Uso una población de distribución <strong>normal de media 1000 y desviación típica 100</strong>. ¿Lo puedes hacer con otros números? Sí, claro. Ya te he dicho que esto es extrapolable a cualquier cosa de estimación.</p>
<p>Voy a tomar una muestra de tamaño 100 de esta población. Y calculo la media y desviación típica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3718</span>)</span>
<span id="cb1-2">sample_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-3">population_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-4">population_sd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-5"></span>
<span id="cb1-6">norm_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(sample_size, population_mean, population_sd)</span>
<span id="cb1-7"></span>
<span id="cb1-8">sample_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(norm_values)</span></code></pre></div>
</div>
<p>La media muestral es 1007.718297.</p>
<p>El objetivo de estos párrafos es calcular el intervalo de confianza para esa estimación, o sea, a la hora de usar la media muestral como estimación de la media poblacional.</p>
<p>Para ello necesitamos la media y <strong>desviación típica poblacional</strong>[^1] (las tenemos), el tamaño muestral (me lo he inventado yo, 100).</p>
<p>[^1 Si no tienes la poblacional y usas una muestral necesitas hacer un ajuste en lo que voy a contar hoy. Te lo cuento otro día.]</p>
<p>Y necesitamos también los valores de la distribución normal que delimitan la confianza al nivel que queramos (95% para no salir de lo habitual). En R lo puedes calcular con <code>qnorm(0.975)</code> y <code>qnorm(0.025)</code>.</p>
<p>El intervalo estará centrado en tu media muestral. Las cotas vendrán dadas por un margen de error.</p>
<p>Este margen de error se calcula con:</p>
<ul>
<li>La desviación típica <strong>poblacional.</strong></li>
<li>La raíz cuadrada del tamaño muestral.</li>
<li>Un valor que ahora te explico.</li>
</ul>
<p>La desviación típica de la muestra dividida por la raíz cuadrada del tamaño muestral no es un valor cualquiera. Es <strong>la desviación típica de la media muestral.</strong></p>
<p>O sea, tienes una población, y tomas una muestra; con esa muestra te calculas la media y te la guardas. Ahora tomas otra muestra, vuelves a calcular la media y te la guardas. Y así muchas veces. Todas estas medias no serán iguales entre sí: serán parecidas, y deberían estar cerca de la media poblacional, pero varían. Varían con una desviación típica. ¿Cuál? Ese valor que hemos dicho.</p>
<p>Mira.</p>
<p>Voy a calcular 1000 medias muestrales de diferentes muestras de tamaño 100 y calculo su desviación típica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">muchas_medias <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, {</span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(sample_size, population_mean, population_sd))</span>
<span id="cb2-3">})</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(muchas_medias)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.00571</code></pre>
</div>
</div>
<p>Y ahora lo comparo con la división de la desviación típica de la población entre la raíz cuadrada del tamaño muestral: 10. ¿A que se parecen bastante?</p>
<p>Pero el margen de error no depende solo de eso, sino que falta el numerito extra. O sea, tiene sentido que el margen de error dependa de la desviación típica de lo que estás estimando, pero falta lo de la <em>confianza</em>. Si quieres mucha confianza, tendrás que aumentar de alguna forma el margen de error; y si quieres menos confianza, tendrás que reducirlo.</p>
<p>Para eso necesitas el estadístico <img src="https://latex.codecogs.com/png.latex?z">. Nos interesa el intervalo de confianza al 95%, ¿no? Pues este valor <img src="https://latex.codecogs.com/png.latex?z"> lo puedes ver como el valor de la distribución normal <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BN%7D(0,%201)"> que deja a su izquierda el 95% de la probabilidad. O sea, los números mayores que él, solo aparecerán en una distribución normal con un 5% de probabilidad.</p>
<p>Al multiplicar este valor por la desviación típica de la media muestral, lo que estás haciendo es llevar el margen de error a la escala de tu población (y no dejarla en la de una normal 0-1).</p>
<p>Pues ahora ya está todo.</p>
<p>Si eres alguien anclado en el siglo XX, buscarás el valor de <img src="https://latex.codecogs.com/png.latex?z"> en una tabla. Si vives en el presente, usarás algún software que te lo busque.</p>
<p>En R puedes usar la función <code>qnorm()</code>.</p>
<p>Quieres el 95% de probabilidad, pero ten en cuenta que la distribución normal es simétrica. Así que necesitas el extremo que deje el 2.5% a su derecha y el que deje el 2.5% a su izquierda. Lo puedes hacer con <code>qnorm(c(0.025, 0.975))</code>.</p>
<p>El resultado es que el intervalo es (988.1186572, 1027.3179369).</p>
<p>Si tienes en cuenta que la media poblacional era 1000, no es una estimación horrible.</p>
<p>Pero…</p>
</section>
<section id="interpretación-del-intervalo" class="level2">
<h2 class="anchored" data-anchor-id="interpretación-del-intervalo">Interpretación del intervalo</h2>
<p>¿Cómo interpretas esos valores? La interpretación <strong>no</strong> es que el valor de la media poblacional está ahí dentro con un 95% de probabilidad.</p>
<p>La media poblacional es un dato, es una realidad. No sabemos si está dentro o no, pero no hay una probabilidad para indicar dónde está.</p>
<p>Vamos a ver cómo se interpreta.</p>
<p>En lugar de dar la definición formal de intervalo de confianza, que no hay dios que la entienda, vamos a construir muchos intervalos de confianza.</p>
<p>Construyo 10^{4} intervalos de confianza, cada uno a partir de una muestra diferente, pero todas provenientes de la misma población.</p>
<p>Cada muestra tendrá una media, que aprovecho y calculo también.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(purrr)</span>
<span id="cb4-2">experiments <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(computations), <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(i) {</span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_interval</span>(sample_size, population_mean, population_sd) </span>
<span id="cb4-4">})</span></code></pre></div>
</div>
<p>Fíjate en el siguiente gráfico. Ha habido muestras cuya media muestral ha sido cercana a 960 ó a 1040. Y esas muestras tendrán sus intervalos de confianza centrados en ese valor… tiene pinta de que van a estar lejos de la media poblacional.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-11-05-confianza/index_files/figure-html/sample-mean-distribution-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>De esos experimentos que hemos hecho, podemos extraer también los intervalos de confianza. Voy a pintártelos para que veas dónde han caído.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-11-05-confianza/index_files/figure-html/plot-confints-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Toda esa banda morada son los 10^{4} intervalos de confianza calculados. La línea amarilla realmente es una sucesión de puntos (como todas las líneas) con cada media muestral.</p>
<p>La línea negra es la media poblacional. Y fíjate en que hay unos pocos intervalos (los de más abajo y los de más arriba, los extremos) que no tocan esa línea negra. O sea, <strong>hay intervalos que no contienen a la media poblacional.</strong></p>
<p>Esto es muy fuerte.</p>
<p>Al principio he tomado una muestra, he calculado la media muestral como estimación de la poblacional, y en torno a ella he construido un intervalo de confianza.</p>
<p>Ese intervalo era un posible intervalo de confianza al 95% por ciento. Y en ese caso sí contenía a la media poblacional (cosa que sé porque estoy en un experimento controlado, pero lo normal es que no sepas la media poblacional).</p>
<p><strong>Pero si me hubiera salido como muestra una diferente, podría haber ocurrido que el intervalo no hubiera contenido a la media poblacional.</strong></p>
<p>Muy fuerte esto.</p>
<p>Pero la pregunta que surge ahora es: <strong>¿cuántos intervalos no contienen a la media poblacional?</strong></p>
<p>Pues aquí entra el 95%.</p>
<section id="el-95-de-los-intervalos-de-confianza-al-95-contienen-la-media-poblacional" class="level3">
<h3 class="anchored" data-anchor-id="el-95-de-los-intervalos-de-confianza-al-95-contienen-la-media-poblacional">El 95% de los intervalos de confianza al 95% contienen la media poblacional</h3>
<p>A continuación calculo el porcentaje de intervalos que sí contienen a la media poblacional, teniendo en cuenta a los 10^{4} que he calculado.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9519</code></pre>
</div>
</div>
<p>Me sale que el 95,19% de los intervalos calculados contienen a la media poblacional.</p>
<p>Eso es lo que quiere decir que tengas un intervalo de confianza al 95%. Significa que, de todos los intervalos que puedes calcular, el 95% tendrá al parámetro real. Pero el tuyo no sabes si está en ese 95% o no lo está (repito, en este experimento sí sabemos si está en ese porcentaje porque es un experimento controlado pero normalmente no lo sabes).</p>
<p>De hecho, puedo cambiar el nivel de confianza, y el porcentaje cambiará acorde a ello:</p>
<p><strong>Confianza al 99%</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
    pct
  &lt;dbl&gt;
1 0.990</code></pre>
</div>
</div>
<p><strong>Confianza al 80%</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
    pct
  &lt;dbl&gt;
1 0.803</code></pre>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-11-05-confianza/</guid>
  <pubDate>Sat, 11 Nov 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Pirámide de población española, desde 1971</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-10-20-piramide-de-poblacion/</link>
  <description><![CDATA[ 





<p>Te traigo una película de terror, llamada <em>La quiebra de las pensiones en España</em>.</p>
<p>Es un GIF que he hecho con la librería ggplot2 de R, y gganimate.</p>
<p>Si quieres el código, me lo pides y te lo mando (o lo buscas en mi GitHub).</p>
<p>Los datos vienen del INE.</p>
<p>En el gráfico aparecen unos valores missing en un momento dado, pero ni idea de por qué, porque dato hay.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] ""</code></pre>
</div>
</div>
<p><img src="https://lhansa.github.io/posts/2023-10-20-piramide-de-poblacion/piramide-poblacion.gif" class="img-fluid"></p>
<p>Puede serte más práctico tener todos los gráficos seguidos, en lugar de quedarte mirando un GIF.</p>
<p>Aquí los tienes:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-10-20-piramide-de-poblacion/facets.jpeg" class="img-fluid figure-img"></p>
<figcaption>Pirámides de población desde 1971 hasta 2021</figcaption>
</figure>
</div>



 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-10-20-piramide-de-poblacion/</guid>
  <pubDate>Fri, 20 Oct 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Paseo en bicicleta eléctrica por Madrid</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-10-12-bicimad/</link>
  <description><![CDATA[ 





<p>Últimamente tengo la sensación de que las estaciones de Bicimad, el servicio de bicis públicas de Madrid, están vacías.</p>
<p>Cuando abro la app, veo que las estaciones de la mitad sur de Madrid están llenas, y las de la mitad norte están vacías.</p>
<p>Quería ver si los datos públicos me decían algo pero:</p>
<ul>
<li>He tardado casi dos horas en leer el json de datos, porque está escrito como si… no sé. O sea, se suele decir que los datos en json están semiestructurados. Pues mira, los datos de una fotografía tienen más estructura que el json de estos datos públicos.</li>
<li>Los datos que me he puesto a ver (los de estaciones) solo están hasta diciembre de 2022. Como me di cuenta de esto en verano, he cogido los datos de julio de 2022.</li>
</ul>
<p>Los datos de junio los he agregado a nivel horario y calculo la proporción media horaria de bases disponibles.</p>
<p>Eso es lo que puedes ver aquí:</p>
<p><img src="https://lhansa.github.io/posts/2023-10-12-bicimad/output.gif" class="img-fluid"></p>



 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-10-12-bicimad/</guid>
  <pubDate>Thu, 12 Oct 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Cómo visualizar cualquier conjunto de datos en 2 dimensiones</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-09-30-tsne/</link>
  <description><![CDATA[ 





<p>En este post te muestro cómo puedes usar el algoritmo t-SNE con R para visualizar datos de grandes dimensiones en solo 2.</p>
<p>Utilizo el conjunto de datos MNIST, que tiene 60.000 observaciones de cifras escritas a mano, determinadas por una malla de 28x28 con un indicador del nivel de gris que hay en cada píxel del mallado.</p>
<p>Cada una de las observaciones viene dada por el nivel de gris que hay en cada píxel, o sea, por 784 variables.</p>
<p>Si quisieras hacer una visualización de cómo se distribuyen tus observaciones en todas esas variables… pues simplemente no podrías.</p>
<p>t-SNE te lo proyecta todo en 2 dimensiones, para que puedas luego visualizarlo.</p>
<section id="preparación-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="preparación-de-datos">Preparación de datos</h2>
<p>He hecho un poco de trampa y los datos ya los tengo preparados. Pero vamos, que voy a usar los datos que tienes si ejecutas <code>keras::dataset_mnist()</code>. Concretamente la parte de entrenamiento.</p>
<p>Y bueno, tendrás que ejecutar eso y configurarlo bien, porque menuda aventura: Python y sus entornos virtuales.</p>
<p>Aparte, usaré librerías de tidyverse para dar forma a los datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(purrr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(Rtsne)</span>
<span id="cb1-6"></span>
<span id="cb1-7">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>())</span></code></pre></div>
</div>
<p>Para lo que quiero hacer no necesito las 60.000 observaciones que hay, así que me quedo con las 1000 primeras.</p>
<div class="cell" data-labs="prep-data">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">max_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># map_dfr(seq_len(dim(mnist)[1]), function(i) {</span></span>
<span id="cb2-3">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dfr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(max_number), <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(i) {</span>
<span id="cb2-4">  data_aux <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mnist[i, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>] </span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data_aux) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>)</span>
<span id="cb2-6">  </span>
<span id="cb2-7">  data_aux <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unite</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"variable"</span>, x, y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> i)  </span>
<span id="cb2-13">})</span>
<span id="cb2-14"></span>
<span id="cb2-15">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> variable, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> value)</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000  785</code></pre>
</div>
</div>
<p>La columna extra es la que me indica que son observaciones diferentes.</p>
</section>
<section id="cómo-aplicas-t-sne" class="level2">
<h2 class="anchored" data-anchor-id="cómo-aplicas-t-sne">Cómo aplicas t-SNE</h2>
<p>Mira, sinceramente ni idea.</p>
<p>O sea, tú ejecuta <code>Rtsne()</code> sobre tu <em>data frame</em> y surge la magia.</p>
<div class="cell" data-labs="tsne">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">tsne_fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Rtsne</span>(data)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(tsne_fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000    2</code></pre>
</div>
</div>
</section>
<section id="cómo-puedes-visualizar-t-sne" class="level2">
<h2 class="anchored" data-anchor-id="cómo-puedes-visualizar-t-sne">Cómo puedes visualizar t-SNE</h2>
<p>Recupero de los datos originales la etiqueta del número que se supone que representa cada mallado. Como estoy trabajando solo con los 1.000 primeros, me quedo solo con esos.</p>
<p>En el gráfico muestro cómo se distribuyen los puntos y los coloreo en función de si son un 0, 1, 2, 3, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">df_to_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(tsne_fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Y)</span>
<span id="cb6-2">df_to_plot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(number_labels[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>max_number])</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_to_plot) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> V1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> V2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> label)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb6-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t-SNE applied to MNIST dataset"</span>,</span>
<span id="cb6-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample of first %i elements"</span>, max_number), </span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: keras::dataset_mnist()"</span></span>
<span id="cb6-10">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-09-30-tsne/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-09-30-tsne/</guid>
  <pubDate>Sat, 30 Sep 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>¿Existe la suerte?</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-09-28-fooled-by-randomness/</link>
  <description><![CDATA[ 





<ul>
<li><p><strong>Probabilidad:</strong> falta de certidumbre en nuestro conocimiento y el desarrollo de métodos para lidiar con nuestra ignorancia. en el mundo real muchas veces tienes que averiguar el problema más que la solución.</p></li>
<li><p>De la misma forma que un antepasado se rescaba la nariz y veía llover, pensaba que el rascarse la nariz inducía lluvia, acualmente ligamos la prosperidad económica a un recorte de los bancos centrales.</p></li>
<li><p>Presentamos conjeturas como verdades porque no manejamos bien las probabilidades.</p></li>
<li><p>Lo que obtienes por suerte es fácil que te desaparezca por azar. Lo que obtienes sin la cción de la suerte es más robusto a la incertidumbre.</p></li>
<li><p>Dos problemas ante un estado:</p>
<ul>
<li>Los cisnes negros.</li>
<li>La simetría (de poco sirven muchos éxitos si un fracaso te lo quita todo)</li>
</ul></li>
<li><p>Experimento s xix. Paciente amnésica, hay que presentarse cada 15 minutos. Un día, estrechan la mano con una chincheta. Al día siguiente, la paciente no recuerda al interlocutor pero retira la mano de manera instintiva.</p></li>
<li><p>Nos fijamos en los éxitos (como tecnologías que han cambiado nuestra vida) pero no en los fracasos (como patentes que se han quedado en el olvido)</p></li>
<li><p>El ratio de información no verificada frente a la verificada aumenta.</p>
<ul>
<li>Misma idea de <em>la señal y el ruido</em> de Nate Silver.</li>
</ul></li>
<li><p>En la Italia renacentista, las aseguradoras cobraban la misma tasa a un varón de 20 años que a uno de 50, porque su vida extra esperada era la misma (alguien que sobrepasaba los 40 había demostrado resistencia a muchos obstáculos y posiblemente ya llegaría a viejo).</p></li>
<li><p>Lo que uno observa en los mercados financieros es, en el mejor de los casos, varianza más retornos, no solo retornos.</p></li>
<li><p>Centrarse en la aleatoriedad, en el corto plazo, desgasta, quema, frustra y deprime, por la constante exposición a sus golpes de dolor.</p></li>
<li><p>my problem is that I’m not rational and I’m extremely prone to drown in randomness and to incur emotional torture. My only advantage in life is that i know some of my weaknesses, mostly that I’m incapable of taming my emotions facing news and incapable of seeing a performance with a clear head. Silence is far better.</p></li>
<li><p>Fashionable nonsense, by alan sokal</p></li>
<li><p><em>and such a crowd</em> (y esta banda)</p></li>
<li><p>si lo siguiente se parece a un discurso de un mandamás de tu empresa, búscate otro trabajo:</p></li>
</ul>
<blockquote class="blockquote">
<p>We look after our customer’s interests/the road ahead / our assets are our people / creation of shareholder value / our vision / our expertise lies in / we provide interactive solutions / we position ourselves in this market / how to serve our customers better / short- term pain for long-term gain/we will be rewarded in the long run / we play from our strength and improve our weaknesses / courage and determination will prevail / we are committed to innovation and technology / a happy employee is a productive employee / commitment to excellence / strategic plan / our work ethics.</p>
</blockquote>
<ul>
<li><p>Le preguntaron en un evento si creía que el mercado iba a subir o bajar en la próxima semana. Dijo que subiría. Y respondieron que entonces por qué estaba en corto. Por asimetría. Él creía que había mucha probabilidad de que subiera (pero muy poco, solo un 1%). - Pero había una probabilidad de 30% de bajar 10%. Con todo, el resultado esperado era una bajada.</p></li>
<li><p>we could either be too lax or too stringent in accepting past information as a prediction of the future. I need a lot more than data. My major reason is the rare event, but i have plenty of others.</p></li>
<li><p>la historia nos enseña que cosas que nunca han ocurrido ocurren.</p></li>
<li><p>Tiendes a ser más sensible a la presencia o ausencia de un estímulo que a la variación en su magnitud. Esto implica (en mercados financieros) que una pérdida es al principio solo una pérdida, con drásticas consecuencias a la larga</p></li>
<li><p>Emocionalmente, prefieres muchas ganancias y pocas pérdidas, aunque en magnitud eso no tenga que ser bueno.</p></li>
<li><p>En ciencia, puedes estar haciendo experimentos fallidos muchas veces, hasta que una por fin sale un resultado exitoso.</p></li>
<li><p>La serie temporal de éxito puede parecer plana con un pico al final, pero se puede ver como una probabilidad acumulada (relación con James Clear)</p></li>
<li><p>Esto mismo se puede aplicar al mercado editorial, a entrenamiento físico (basado en el ritmo de cazadores recolectores del paleolítico) o inversión para aprovechar crisis.</p></li>
<li><p>La estadística nos falla cuando tenemos distribuciones asimétricas: imagina una urna con bolas rojas y negras, pero en la que sacar bola roja tiene una probabilidad muy muy baja. Si quiero saber si hay bolas rojas y mi método consiste en ir sacando bolas (por probabilidad, serán casi siempre negras), el aumentar el tamaño muestral no me ayuda a estar más seguro de si hay bolas rojas o no si siempre saco bolas negras. Y si saco una roja, aumentar el tamaño muestral tampoco me aporta más información.</p></li>
<li><p>Lo importante de esto es que aumentar progresivamente el tamaño muestral no garantiza que aumente la información</p></li>
<li><p>Robert Lucas: si la gente fuera racional, entonces aplicarían es razón para entender patrones del pasado y adaptarse, de forma que la información pasada seria inutil para predecir el futuro.</p></li>
<li><p>Aprende a gestionar la aleatoriedad manteniendo una mente abierta y cambiando de opinión sin que te dé vergüenza.</p></li>
<li><p>Usaré la estadística cuando me beneficie y la evitaré cuando me perjudique. Aprenderé del pasado pero sin caer en sus peligros. Por ello usaré la estadística para hacer apuestas agresivas (estadísticamente, qué probabilidad hay de que algo poco probable pero beneficioso ocurra) pero no la usaré para protegerme frente a riesgos (que algo malo históricamente nunca haya ocurrido no significa que no vaya a ocurrir).</p></li>
<li><p>El coste de estar equivocado en una apuesta tiene que ser asumible y estar limitado.</p></li>
<li><p>Si juntas a infinitos monos frente a un teclado, alguno acabará tecleando la Iliada. Ahora bien, ¿cuál es la probabilidad de que ese mono esceiba a continuación la Odisea? Dicho de otra forma, ¿hasta qué punto el rendimiento pasado es un buen indicador del rendimiento futuro?</p></li>
<li><p>De cara a valorar una empresa, si tienes muchas empresas, es probable que alguna lo esté haciendo bien por casualidad, no por capacidad. ¿Cómo sabes cuál es para no invertir en ella? y en inversiones, ves a inversores que les sale bien su inversión, pero ¿cómo sabes que no es por casualidad? Además, solo ves a los buenos. Los fracasados están escondidos y no conoces la probabilidad de ser bueno.</p></li>
<li><p>El sesgo del superviviente es habitual porque estamos acostumbrados a aprovechar la información que tenemos delante de nosotros e ignorar la que no vemos.</p></li>
<li><p>Nadie acepta la aleatoriedad en su éxito; solo en su fracaso.</p></li>
<li><p>Si la nariz de Cleopatra hubiera sido distinta el mundo sería totalmente diferente (porque Julio César quedó prendado por su nariz). - (Pascal, ejemplo de caos)</p></li>
<li><p>what has gone wrong with the development of economics as a science? Answer: there was a bunch of inteligent people who felt compelled to use mathematics just to tell themselves that they were rigorous in their thinking, that theirs was a science.</p></li>
<li><p>El camino hacia el éxito no tiene por qué depender de la suerte, sino de la constancia. La constancia en un camino sin frutos es la que acaba llevándote al evento raro, al momento en que ves que has avanzado y progresado. El camino hacia el éxito puede no ser alestorio, pero muy poca gente tiene la entereza de seguirlo hasta el final. Aquellos que dan el paso extra son los recompensados.</p></li>
<li><p>Me estoy dando cuenta del efecto no lineal tras el éxito en cualquier campo. Es mejor tener unos pocos entusiastas de tu trabajo que muchos seguidores a los que les pareces bien. Mejor ser amado por una docena que gustar a cientos.</p></li>
<li><p>El valor esperado es aquel en el que si te quieres ir de vacaciones a París o al Caribe, puedes imaginarte a la vez tumbado en una playa paridisíaca visitando el museo de Orsay. O sea, algo imposible pero que se usa una y otra vez para cuantificar escenarios. las reglas tienen su utilidad. No las seguimos porque sean correctas, sino porque nos ahorran tiempo y esfuerzo (por ejemplo, salir corriendo cuando ves algo que pueda ser un depredador, lo sea o no lo sea).</p></li>
<li><p>Sesgos cognitivos: si vemos un número, tendemos a anclarnos a él en nuestras estimaciones. Las emociones son atajos para tomar decisiones. Una decisión puramente matemática requeriría tiempo infinito por la cantidad de información que hay que procesar.</p></li>
<li><p>Si estás pensando en equipaje para un viaje, la varianza en la temperatura puede condicionarte más que el valor esperado.</p></li>
<li><p>No soy tan inteligente ni tan fuerte como para controlar mis emociones. Es más, las necesito para tomar decisiones y ejecutarlas.</p></li>
<li><p>Si mides una mesa con una regla de cuya precisión no te fías, obtienes más información de la regla que de la mesa. Si lees una valoración de un usuario al que no conoces, obtienes más información del usuario que del contenido revisado. tratado sobre la risa, henri Bergson</p></li>
<li><p>A los 25, ignoraba totalmente la ciencia del comportamiento. Me habían hecho creer erróneamente en mi juventud que mis supersticiones eran culturales, y que por ello podía deshacerme de ellas mediante el uso del raciocinio.</p></li>
<li><p>La ciencia está bien; los científicos son humanos. Un científico puede tener que actuar como un picapleitos defensor de una causa sin sentido en lugar de limitarse a buscar la verdad.</p></li>
<li><p>No culpes a otros por tu destino (incluso aunque tengan algo de culpa).</p></li>
<li><p>Lo único de ti sobre lo que no tiene control la suerte es tu comportamiento.</p></li>
<li><p>Cuanto más asciendes profesionalmente, más te pagan. Esto puede estar justificado, ya que tiene sentido pagar a un trabajador acorde a su contribución. Sin embargo, cuanto más asciendes, la evidencia de esta contribución disminuye.</p></li>
<li><p>Un empleado en un nivel bajo en la jerarquía (un perfil técnico) se le evalúa tanto por sus resultados como por su metodología. A medida que asciende, se le evalúa más por resultados. En niveles altos, cómo llegar a buenos resultados da igual, con tal de que se llegue a buenos resultados. Pero el jefe de una gran compañía se puede enfrentar a unas cuantas grandes decisiones cuyo método no se puede repetir (porque las circunstancias del mercado y de la empresa no se repitan). Así, “ser CEO” puede no requerir unas habilidades especiales para conseguir buenos resultados, ya que estos dependen en gran medida de que la empresa esté en las circunstancias adecuadas. Y lo que requiere realmente es tener el carisma y las habilidades sociales correspondientes para caer bien, sin más.</p></li>
<li><p>Si algo se rige por normas aleatorias, viene a funcionarte de la misma forma que si no lo conocieras.</p></li>
<li><p>Valoramos lo visible, lo asentado, lo personal, lo narrado, lo medible, lo tangible; desdeñamos lo abstracto.</p></li>
</ul>



 ]]></description>
  <category>lecturas</category>
  <guid>https://lhansa.github.io/posts/2023-09-28-fooled-by-randomness/</guid>
  <pubDate>Thu, 28 Sep 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Muertes de humanos causadas por otros animales</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-08-14-muertes-humanas/</link>
  <description><![CDATA[ 





<p>Siempre me ha fascinado el dato que te voy a enseñar ahora.</p>
<p><strong>¿Cuál es el animal que más humanos mata al año?</strong></p>
<p>Hay gente que se come el coco sin llegar a nada. Otros dicen que el humano.</p>
<p>Pero no.</p>
<p>El gráfico siguiente además ayudar a desmitificar peligros, como los tiburones.</p>
<p><strong>Observación.</strong> No consigo encontrar la fuente original de los datos. No es el único sitio donde lo he visto y me gusta la idea general, pero los números quizá no sean fiables (y la traducciones menos todavía, porque esas las he hecho yo, así que eso sí que no xD)</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-08-14-muertes-humanas/index_files/figure-html/everything-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hay 5 ideas que me encantan de esto:</p>
<ul>
<li>Los insectos matan a mazo, mazo de humanos.</li>
<li>Los tiburones, mal vistos por películas, no suponen mucho problema.</li>
<li>Los humanos matamos mucho, pero no somos lo peor (casi sí).</li>
<li>Los perros, ellos tan amigos, pero cuidado con ellos.</li>
<li>¿Algo parecido a regla de Pareto?</li>
</ul>
<p>La fuente es <a href="https://www.cbsnews.com/pictures/the-20-deadliest-animals-on-earth-ranked/">esta.</a></p>



 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-08-14-muertes-humanas/</guid>
  <pubDate>Mon, 14 Aug 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Muestreo (II)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-07-21-muestreo-ii/</link>
  <description><![CDATA[ 





<p><a href="https://longitudsinanchura.com/posts/2023-07-18-muestreo/">Hace unos días</a> cacharreaba con algunos conceptos sobre el muestro.</p>
<p>Hoy verás conceptos sobre distribuciones de un estadístico de una muestra.</p>
<section id="distribución-muestral-exacta" class="level2">
<h2 class="anchored" data-anchor-id="distribución-muestral-exacta">Distribución muestral exacta</h2>
<p>Imagina que tienes cuatro dados y los lanzas. El primer dado puede sacar uno de seis posibles valores; el segundo, igual; y así… Es decir, el primero puede sacar 6 valores, el segundo, otros 6… Matemáticamente:</p>
<p><img src="https://latex.codecogs.com/png.latex?6%20%5Ctimes%206%20%5Ctimes%206%20%5Ctimes%206%20=%206%20%5E%204%20=%206%20%5E%20%7B%5Cmbox%7Bdados%7D%7D"></p>
<p>Lanzas una vez y calculas la suma de las caras que ves sobre la mesa (un juego de dados típicos es apostar a la suma de las caras tras lanzar dos dados). Lanzas otra vez y calculas la suma de nuevo. Y así…</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/generate-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Este, con 4 dados, es un caso razonablemente pequeño y has podido calcular todos los resultados posibles. Concretamente, ese gráfico representa la distribución exacta de la suma de lanzar 4 dados.</p>
<p>En el gráfico puedes ver que el resultado con más casos favorables es 14, con 146 repeticiones.</p>
<p><strong>¿Pero qué ocurre si tienes más dados?</strong></p>
</section>
<section id="simulación-de-la-distribución-muestral" class="level2">
<h2 class="anchored" data-anchor-id="simulación-de-la-distribución-muestral">Simulación de la distribución muestral</h2>
<p>En el curso de Datacamp de donde estoy sacando estas ideas dicen que, si tiras 100 dados, tienes tantas combinaciones posibles como átomos hay en el universo: 6.5331862^{77}</p>
<p>Cuando no puedes replicar la distribución exacta porque el número de casos es enorme, o porque no tienes acceso a toda la población (bien por tecnología, bien por coste, …), necesitas una aproximación a esa distribución.</p>
<p>Por ejemplo, si en el caso de 4 dados no pudiéramos replicar todos los lanzamientos, podríamos buscar una aproximación mediante algunos lanzamientos. En el gráfico anterior están los 1296 casos posibles. Vamos a ver cómo queda esa distribución si lo aproximamos con 750 simulaciones.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/sim750-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No es igual pero la forma es parecida. <strong>Una nota importante:</strong> en este caso estamos simulando, o sea, no estamos tomando los resultados posibles reales, sino que estamos haciendo como que tiramos los dados y apuntamos la suma. Es decir, como no es el caso teórico, incluso aunque repitiéramos la simulación tantas veces como casos posibles hay, nada garantiza que vayamos a obtener la distribución exacta de antes.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/sim1296-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="y-esto-para-qué-sirve" class="level3">
<h3 class="anchored" data-anchor-id="y-esto-para-qué-sirve">Y esto, ¿para qué sirve?</h3>
<p><em>Oye, Leo, pero yo ya he calculado la distribución exacta. ¿Para qué quiero esta aproximación?</em></p>
<p>Como esa aproximación se parece a la distribución exacta, cuando no puedes acceder a la exacta, puedes usar esta:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/sim10000-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="teorema-central-del-límite" class="level2">
<h2 class="anchored" data-anchor-id="teorema-central-del-límite">Teorema central del límite</h2>
<p>Imagina que fijas un tamaño muestral. Y para ese tamaño muestral, replicas muchas veces un experimento.</p>
<p>El experimento va a consistir en calcular la media de la profundidad de unos <a href="https://ggplot2.tidyverse.org/reference/diamonds.html">diamantes.</a></p>
<p>La media de toda la muestra es 61.7494049.</p>
<p>En el siguiente gráfico tienes la distribución de la media muestral cuando el tamaño muestral es 5, 100, 500 y 1.000 (el total de la muestra es superior a 50.000).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/diamonds-sample-mean-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Lo interesante de este gráfico es que puedes ver cómo, a medida que aumenta el tamaño muestral, los cálculos de la media con ese tamaño son cada vez más estables. La línea vertical es la media <em>poblacional</em> y puedes ver que las colas son cada vez menos pesadas (más <em>normales</em>).</p>
<hr>
<p>Pero realmente he hablado de estadístico poblacional cuando realmente estoy trabajando con una muestra (aunque tenga 50.000 diamantes, eso no es toda la población de la muestra).</p>
<p>La solución a este problema te lo cuento el próximo día.</p>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-07-21-muestreo-ii/</guid>
  <pubDate>Fri, 21 Jul 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Personas centenarias [tidytuesday]</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-07-21-tidytuesday-oldest-people/</link>
  <description><![CDATA[ 





<p>Exploración de datos del <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-05-30/readme.md">tidytuesday del 30 de mayo de 2023.</a></p>
<p>Sitúo por año de nacimiento a los centenarios. Habrá en los años más recientes, seguramente porque la población era mayor (en un periodo tan breve, no creo que los avances médicos supusieran tanta diferencia).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-tidytuesday-oldest-people/index_files/figure-html/per-year-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="cómo-varía-en-función-de-las-variables-que-hay" class="level2">
<h2 class="anchored" data-anchor-id="cómo-varía-en-función-de-las-variables-que-hay">¿Cómo varía en función de las variables que hay?</h2>
<p>No tengo a mano los datos de población de los países pero me vale esto para hacerme una idea.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-tidytuesday-oldest-people/index_files/figure-html/per-country-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No hay diferencia entre chico/chica:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Género</th>
<th style="text-align: right;">Personas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-07-21-tidytuesday-oldest-people/</guid>
  <pubDate>Fri, 21 Jul 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>7 hábitos de la gente altamente efectiva</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-07-20-7-habitos-gente-altamente-efectiva/</link>
  <description><![CDATA[ 





<section id="ideas-introductorias" class="level2">

<ul>
<li>Mapa y territorio. Un cambio de paradigma te puede ayudar a controlar mejor el territorio.
<ul>
<li>Mucha autoayuda falla porque enseñan un mapa sobre un territorio equivocado. Si estás usando un mapa que no se ajusta a tu territorio, no lo puedes aplicar.</li>
</ul></li>
<li>Inside-out. Las victorias personales van antes que las públicas. Para mejorar las relaciones con los demás debes mejorar antes la tuya contigo mismo.</li>
</ul>
</section>
<section id="sé-proactivo" class="level2">
<h2 class="anchored" data-anchor-id="sé-proactivo">1. Sé proactivo</h2>
<ul>
<li>El amor es un verbo. La gente proactiva se sacrifica por otros.</li>
<li>Aplicación:
<ol type="1">
<li>Durante un día fíjate en tu lenguaje y el de los demás. “Cuántas veces escuchas no puedo”, “ojalá”, “tengo que”…</li>
<li>Identifica una experiencia con la que si te encuentras reaccionarías de manera reactiva. ¿Cómo la convertirás en proactiva?</li>
<li>Elige un problema personal o profesional que te frustre. ¿Qué puedes hacer que ayude a mejorarlo.</li>
<li>Durante treinta días trabaja en tu círculo de influencia con pequeños compromisos: no juzgues, no critiques, no discutas, no culpes. Trabaja en las cosas sobre las que tienes control.</li>
</ol></li>
</ul>
</section>
<section id="empieza-con-el-final-en-mente" class="level2">
<h2 class="anchored" data-anchor-id="empieza-con-el-final-en-mente">2. Empieza con el final en mente</h2>
<ul>
<li>En tu funeral van a decir unas palabras sobre ti. ¿Qué te gustaría que dijeran? ¿Cómo te gustaría que te recordaran?</li>
<li>Empieza cada día con la imagen del final de tu vida, que ese sea tu criterio para evaluar tus acciones.</li>
<li>Todo se crea en dos fases: una mental y otra física. Tú eres la segunda creación de tu propio diseño proactivo previo, o la segunda creación de los planes de otras personas, o circunstancias o costumbres pasadas.</li>
<li>El hábito 1 es “tú eres el creador”. El hábito 2 es la primera creación.</li>
<li>Solemos necesitar más un destino y una brújula (conjunto de principios y direcciones) y menos una hoja de ruta. <strong>El camino por delante no lo conocemos y necesitarás improvisar más de lo previsto.</strong></li>
<li>Soy quien soy hoy por las decisiones que tomé ayer.</li>
<li>Cuando quieras ser efectivo, piensa de manera amplia. No tiene sentido que te centres en tu éxito profesional si dejas de lado tu salud.</li>
<li>Piensa en tu visión a largo y misión en varios roles. Eso te dará balance</li>
</ul>
</section>
<section id="pon-primero-lo-primero" class="level2">
<h2 class="anchored" data-anchor-id="pon-primero-lo-primero">3. Pon primero lo primero</h2>
<ul>
<li>Las personas exitosas tienen el hábito de hacer lo que los fracasados no quieren hacer.</li>
<li>La gente poco efectiva dedica mucho tiempo a <strong>cosas urgentes poco importantes</strong> (en general, actividades con origen en otras personas). Luego desconectan un poco con actividades poco urgentes y poco importantes (Netflix…).</li>
<li>No te hagas planes de organización diarios sino semanales.</li>
</ul>
</section>
<section id="piensa-en-winwin" class="level2">
<h2 class="anchored" data-anchor-id="piensa-en-winwin">4. Piensa en win/win</h2>
<ul>
<li>Busca soluciones que beneficien a todas las partes involucradas.</li>
<li>Hay casos contrarios a eso:
<ul>
<li>Hay incentivos para pensar en <strong>win/lose</strong>. La ley está motivada por el que hay un enemigo al que hay que ganar, mediante abogados y juicios.</li>
<li>El <strong>lose/lose</strong> ocurre cuando se juntan dos personas cuyo objetivo es hacer que su enemigo pierda, aunque sea a costa de su propio bienestar.</li>
</ul></li>
<li><strong>win/win or no deal.</strong> Si no podemos llegar a un acuerdo en el que los dos salgamos beneficiados, es mejor no cerrar acuerdo.</li>
<li>la actitud de un individuo tiene dos dimensiones: valor y consideración. <strong>Win/win</strong> consiste en maximizar ambos.</li>
<li><strong>Mentalidad de abundancia:</strong> hay suficiente para todos.</li>
</ul>
</section>
<section id="busca-primero-entender-luego-ser-entendido" class="level2">
<h2 class="anchored" data-anchor-id="busca-primero-entender-luego-ser-entendido">5. Busca primero entender, luego ser entendido</h2>
<ul>
<li>Imagina un óptico que recomienda a un cliente las gafas que tiene él, sin diagnosticar.</li>
<li>Historia del Padre que no escucha a su hijo…</li>
<li>Las necesidades cubiertas no motivan.</li>
</ul>
</section>
<section id="sinergiza" class="level2">
<h2 class="anchored" data-anchor-id="sinergiza">6. Sinergiza</h2>
<ul>
<li>Trabaja en equipo y crea sinergias para buscar equipos comunes.</li>
<li>Ejemplo de los fundadores de Apple</li>
</ul>
</section>
<section id="afila-la-sierra" class="level2">
<h2 class="anchored" data-anchor-id="afila-la-sierra">7. Afila la sierra</h2>
<ul>
<li>Cuidar y mejorar continuamente los cuatro aspectos de tu vida: físico, mental, emocional y espiritual.
<ul>
<li>Queremos estar saludables pero no dedicamos 30 minutos al ejercicio.</li>
<li>Queremos ser inteligentes pero no pasamos 20 minutos leyendo.</li>
<li><strong>Trabajo, familia, relajación…</strong></li>
</ul></li>
<li>Cuatro dimensiones de control introspectivo: físico, mental, social y espiritual.</li>
<li>Ejercicio de fuerza. Hay que apurar hasta el final porque es como el cuerpo sabrá que hay que regenerar fibras musculares más fuertes. Igual pasa con la paciencia.</li>
<li>Aspecto espiritual: hay personas que encuentran en la inmersión en la música o literatura la misma satisfacción espiritual que otras personas en la meditación o en la lectura de escrituras sagradas.</li>
<li>Prescripción médica: ve a un sitio que tengas buen recuerdo de niño. A las 9, escucha. A las 12, try reaching back (estudia el pasado). A las 3, explora tus motivos (si tus motivos están mal, entonces todo lo que haces está mal). A las 6, escribe tus preocupaciones en la arena.</li>
<li>La lectura nos ayuda con el hábito de primero entender, ya que nos educa en el hábito de no poner nuestra autobiografía en medio de cada idea que nos llegue.</li>
<li>Hans Selye: “una vida larga, sana y feliz es el resultado de hacer contribuciones”</li>
<li>“Trata a una persona como es, y seguirá igual. Trata a un persona como puede ser, y llegará a ello” (Goethe)</li>
</ul>


</section>

 ]]></description>
  <category>lecturas</category>
  <guid>https://lhansa.github.io/posts/2023-07-20-7-habitos-gente-altamente-efectiva/</guid>
  <pubDate>Thu, 20 Jul 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>12 reglas para la vida</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-07-19-12-reglas-para-la-vida/</link>
  <description><![CDATA[ 





<p><em>Comentario mío: el libro no me ha gustado. Creo que está mal planteado, porque tiene conceptos interesantes pero muy mal hilados. Pero eso: tiene conceptos interesantes. De algún capítulo no hay notas o bien porque me parecía una tontería o bien porque no tenía nada a mano para apuntar. Y algunas de las notas son frases literales, otras son reinterpretadas; con algunas estoy a favor, con otras estoy en contra, y otras me han llamado la atención pero no me he posicionado (aún)</em></p>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<ul>
<li>La pérdida de creencias grupales lleva a una vida caótica. Y la presencia de creencias grupales lleva a conflictos con otros grupos.
<ul>
<li>En occidente llevamos tiempo reduciendo nuestra tradición, religión y sentimientos nacionales, en parte para evitar los conflictos grupales. Pero así cada vez tendemos más a a vidas sin sentido, ni valores.</li>
</ul></li>
<li>la serotonina da una postura de victoria a las langostas. La octapina, de derrota.</li>
<li>ley de price, para distribución financiera y creativa</li>
<li>Mateo 25:29: para los que tenéis todo, se os dará más; para los que no tienen nada, todo se os quitará</li>
<li>la tradición oral religiosa tiene más un fin moral que un fin descriptivo</li>
</ul>
</section>
<section id="regla-1.-enderézate-y-echa-los-hombros-hacia-atrás" class="level2">
<h2 class="anchored" data-anchor-id="regla-1.-enderézate-y-echa-los-hombros-hacia-atrás">Regla 1. Enderézate y echa los hombros hacia atrás</h2>
<ul>
<li>Una langosta victoriosa tiene una postura más amplia. Y mayor proporción de serotonina que de octopamina. Inyectar serotonina en una langosta derrotada hace que cambie su postura.</li>
<li>Las hembras dejan que los varones se peleen y luego eligen entre los más fuertes.
<ul>
<li>Confían en que el comportamiento de estos se calme.</li>
<li>Es un esquema llevado a la Bella y la Bestia o 50 sombras de Grey.</li>
</ul></li>
<li>La naturaleza selecciona pero no es un concepto estático.
<ul>
<li>“En mi reino tienes que correr con todas tus fuerzas para no quedarte en el mismo lugar” (Reina, Alicia en el País de las Maravillas)</li>
</ul></li>
<li>Atrévete a ser un peligro</li>
<li>Erguirse significa aceptar voluntariamente la carga del Ser.</li>
<li>Si te presentas físciamente como alguien derrotado, la ente te tratará como alguien derrotado. Y te sentirás como tal.</li>
<li>Si comienzas a erguirte, la gente te mirará como a tal.</li>
</ul>
</section>
<section id="regla-2.-trátate-a-ti-mismo-como-tratarías-a-alguien-que-depende-de-ti" class="level2">
<h2 class="anchored" data-anchor-id="regla-2.-trátate-a-ti-mismo-como-tratarías-a-alguien-que-depende-de-ti">Regla 2. Trátate a ti mismo como tratarías a alguien que depende de ti</h2>
<ul>
<li>El equilibrio entre caos y orden es importante para no frustrarnos pero que haya algo de motivación. Algo de riesgo.</li>
<li>El orden puede descontrolarse y convertirse en una migración forzosa o un campo de concentración.</li>
<li>El caos se relaciona con lo femenino. Todo se origina en el desorden y todos nos originamos en una madre.</li>
<li>Incluso el jardín del Edén tenía una serpiente porque toda calma tiene un punto de caos, como el punto negro en la serpiente blanca tahoista.</li>
<li>siempre hay un enemigo. Incluso aunque derrotáramos a todos, estaríamos nosotros mismos.</li>
<li>Es mejor enseñar a quienes dependen de ti a que sean competentes que protegerlos demasiado.</li>
<li>Nuestra vista (aguda) nos permite identificar rápidamente los frutos maduros de los árboles, que son los comestibles.</li>
<li>igual que pensamos mal de otras personas, hay personas que de quienes realmente piensan mal es de sí mismas.</li>
<li>Alguien que tiene un porqué tendrá casi siempre un cómo (Nietzsche)</li>
</ul>
</section>
<section id="regla-3.-hazte-amigo-de-aquellos-que-queran-lo-mejor-para-ti" class="level2">
<h2 class="anchored" data-anchor-id="regla-3.-hazte-amigo-de-aquellos-que-queran-lo-mejor-para-ti">Regla 3. Hazte amigo de aquellos que queran lo mejor para ti</h2>
<ul>
<li>Freud: compulsión de repetición. Gente que no tiene buena impresión de sí misma, busca rodearse del mismo tipo de personas que en el pasado le hicieron algún mal. Consideran que no merecen nada mejor.</li>
<li>La gente suele aceptar o incluso magnificar su propio sufrimiento, o incluso el de los demás , si lo pueden presentar como demostración de las injusticias del mundo.</li>
<li>Cuando metes en un grupo civilizado (un equipo de trabajo, reclusos organizados) a una persona más rebelde, el grupo no influye en el individuo, sino al revés, y el grupo empeora sus hábitos. Es más fácil ir hacia abajo.</li>
<li>Cuando ayudas a alguien, ¿lo haces porque quieres ayudarlo? ¿O porque quieres demostrar lo bondadoso que eres?</li>
<li>Hay quien se rodea de gente irresponsable porque en comparativa ellos están mejor. Es una comparativa fácil para hacerte creer especialmente bondadoso.</li>
<li>Si tienes un amigo que no lo recomendarías a tu hermana, a tu padre o a tu hijo, ¿por qué lo tienes tú?</li>
</ul>
</section>
<section id="regla-4.-no-te-compares-con-otro-sino-con-cómo-eras-tú-antes" class="level2">
<h2 class="anchored" data-anchor-id="regla-4.-no-te-compares-con-otro-sino-con-cómo-eras-tú-antes">Regla 4. No te compares con otro, sino con cómo eras tú antes</h2>
<ul>
<li>En el mundo rural es más fácil destacar porque hay menos personas que en las ciudades.</li>
<li>hay sobrerrepresentación de personajes famosos nacidos en pueblos.</li>
<li>Tiempos de espuma de pomelo y helado de whisky con tabaco.</li>
<li>“siempre habrá alguien mejor que tú” es un tópico nihilista. No aporta información esa frase.</li>
<li>la religión se encarga de lo que es correcto. Un religioso buscará hacer lo que es correcto, lo que está bien, aunque eso simplemente sea ser obediente.</li>
<li>Que tu te creas algo, que te etiquetes en una identidad, no significa que lo seas. Tus acciones dicen qué eres. Y eres demasiado complejo para entenderte a ti mismo.</li>
<li>La Biblia como documento escrito durante mucho tiempo por muchos y nadie.</li>
<li>Presta atención a lo que molesta:
<ul>
<li>¿Qué me molesta?</li>
<li>es algo que podría arreglar?</li>
<li>estaría verdaderamente dispuesto a arreglarlo?</li>
<li>si alguna respuesta es no, busca molestaias en otro lado.</li>
</ul></li>
<li>No sobrestimes tu conocimiento de ti mismo.</li>
<li>Pregúntate “qué podría hacer y estoy dispuesto a hacer para que me vida sea un poquito mejor?”. Puede ser algo tan básico como una gestión pendiente. O si crees que un tarea te va a llevar media hora y no te pones porque es mucho tiempo, dedícale 5 minutos hoy. Ayudará a que la veas como algo más asequible.</li>
<li>La vida no tiene el problema; lo tienes tú. Si la vida no te va bien, quizá es tu conocimiento lo que resulta insuficiente. Quizá tu estructura de valores necesita una remodelación. Quizá lo que quieres e ciega y no te deja ver oras posibilidades.</li>
</ul>
</section>
<section id="regla-6.-antes-de-criticar-a-alguien-asegúrate-de-tener-tu-casa-en-perfecto-orden" class="level2">
<h2 class="anchored" data-anchor-id="regla-6.-antes-de-criticar-a-alguien-asegúrate-de-tener-tu-casa-en-perfecto-orden">Regla 6. Antes de criticar a alguien, asegúrate de tener tu casa en perfecto orden</h2>
<ul>
<li>Cuando te das cuenta de las injusticias del mundo, puedes ignorarlo, puedes bucar el placer, puedes resignarte y aceptarlo o puedes tomar medidas y suicidarte.</li>
<li>A la gente le sorprende que haya tantas masacres en EEUU o similares, pero es el primer acontecimiento narrado según la Biblia.</li>
<li>Tolstoi entiende que no hay otra escapatoria que el asesinato para combatir las injusticias “el bien de los muertos es mejor que el bien de los vivos”</li>
<li>los asesinos de masacres (y Caín) asesinan para contrariar el sistema, porque el mundo es injusto en sí mismo.</li>
</ul>
</section>
<section id="regla-7.-dedica-tus-esfuerzos-a-hacer-cosas-con-significado-no-lo-que-más-te-convenga" class="level2">
<h2 class="anchored" data-anchor-id="regla-7.-dedica-tus-esfuerzos-a-hacer-cosas-con-significado-no-lo-que-más-te-convenga">Regla 7. Dedica tus esfuerzos a hacer cosas con significado, no lo que más te convenga</h2>
<ul>
<li>La vida es sufrimiento.</li>
<li>“No tentaraás al señor tu Dios” ( Mateo 4:7) No renuncies a tu responsabilidad. No pidas que una tercera persona intervenga en tu favor cuando tú tienes margen de acción y no lo estás aprovechando.</li>
<li>el socialismo se motiva más por una motivación de odio a los ricos y triunfadores más que en un verdadero interés por los pobres.</li>
<li>los socialistas creen en el dinero igual que los capitalistas y acaban siendo capitalistas.</li>
<li>Dios castigó al humano echándolo del Edén y condenándolo a trabajar.</li>
<li>A veces cuando las cosas van mal, elproblema viene de cómo interpretas las cosas.</li>
<li>Si el mundo que ves no es el que quieres, revisa tus valores.</li>
<li>Es hora de que sacrifiques lo que más quieres para convertirte en quien quieres convertirte y dejar de ser quien eres.</li>
</ul>
</section>
<section id="regla-9.-da-por-hecho-que-la-persona-a-la-que-escuchas-sabe-algo-que-tú-no-sabes" class="level2">
<h2 class="anchored" data-anchor-id="regla-9.-da-por-hecho-que-la-persona-a-la-que-escuchas-sabe-algo-que-tú-no-sabes">Regla 9. Da por hecho que la persona a la que escuchas sabe algo que tú no sabes</h2>
<ul>
<li>Cuando participas en una verdadera conversación, hablas y escuchas, pero sobre todo escuchas.</li>
<li>Puedes ser bastante listo si te limitas a callarte.</li>
<li>No sabemos escuchar. Tendemos a evaluar porque escuchar es peligroso. Puede cambiarte (Carl Rogers)</li>
<li>regla: cuando estés en una discusión, antes de aportar una idea tuya o una opinión, tienes que repetir la idea anterior que ha dicho la otra persona, para que ella valide si lo has entendido bien.</li>
<li>Al escuchar, permites que la otra persona piense. La primera vez que alguien expone algo en voz alta, llega a contradicciones y tiene que orientarlas, deciendo qué olvida de sus anécdotas para dejar claros sus sentimientos.</li>
<li>si una conversación te resulta aburrida, es que no estás escuchando.</li>
<li>la gente organiza su cabeza conversando</li>
</ul>
</section>
<section id="regla-10.-cuando-hables-procura-expresarte-con-precisión" class="level2">
<h2 class="anchored" data-anchor-id="regla-10.-cuando-hables-procura-expresarte-con-precisión">Regla 10. Cuando hables, procura expresarte con precisión</h2>
<ul>
<li>Los objetos como extensión de un sistema, de un árbol con ramas u hojas. No pasa nada porque se rompa un objeto, porque el sistema sigue en pie.</li>
<li>tú no acabas en lo que acota tu piel. Llegas más allá. Si usas una herramienta, pasa a formar parte de ti y la usas como si sintieras con su extremo. Tu familia o amigos forman parte de ti (¿qué prefieres perder: un brazo o un ser querido?). Tus niveles de testosterona varían si tu equipo pierde o gana.</li>
<li>Cuando usas una herramienta, no hace falta que la entiendas: solo te hace falta saber con precisión qué quieres hacer con ella.</li>
<li>Somos más conscientes de nuestras limitaciones cuando algo que siempre usamos deja de funcionar y no lo sabemos arreglar, como un coche u ordenador. Simplificamos el mundo en el día a día.</li>
<li>El mundo es fácil mientras es simple, y eso solo ocurre cuando ignoramos cómo funciona. Ante una catástrofe, un desastre, o un simple desajuste, nos damos cuenta de que nuestra percepción era equivocada.</li>
<li>Si no hay una tradición consesuada de quién hace qué, se acaba en tres escenarios. La esclavitud, en la que el esclavo se acaba revelando y llega el caos; la tiranía, en la que el tirano se aburre por exceso de obediencia y abandona al subordinado a su propia suerte; o la negociación. Esta exige que ambos jugadores hablen con franqueza y admitan que hay un problema.</li>
<li>vivir significa realizar una labor constante de mantenimiento</li>
<li>las relaciones pueden acabarse por problemas que nunca nos atrevemos a solucionar ni siquiera plantear.</li>
<li>Nos negamos a ser específicos con un problema porque el serlo signfica admitir su existencia.</li>
<li>si no eres específico, no solo no defines el triunfo, sino que tampoco defines tu fracaso. Pero eso en sí mismo está abocado al fracaso.</li>
</ul>
</section>
<section id="regla-11.-deja-en-paz-a-los-chavales-que-montan-en-monopatín" class="level2">
<h2 class="anchored" data-anchor-id="regla-11.-deja-en-paz-a-los-chavales-que-montan-en-monopatín">Regla 11. Deja en paz a los chavales que montan en monopatín</h2>
<ul>
<li>Los que patinan no se ponen protección porque no buscan la falsa seguridad de un equipo protector, sino la seguridad mediante la competencia.</li>
<li>Según Orwell, el socialismo en reino unido estaba representado políticamente por unas personas que no defendían a la clase obrera, sino que odiaban a los ricos.</li>
<li>Los chicos actualmente tienden a ser etiquetados de peores estudiantes que las chicas y menos simpáticos y más desobedientes. Pero también más independientes y menos susceptibles a la depresión. Los intereses de los chicos tienden a relacionarse con cosas, y los de las chicas con personas.</li>
<li>Estas diferencias están influidas por razones biológicos.</li>
<li>Políticas igualitarias como intentar que dos personas con el mismo trabajo cobren igual tienen la dificultad de decidir qué significa que dos trabajos sean iguales.</li>
<li>hay políticas que buscan que se eduque igual a los chicos que a las chicas, con la idea de que sean menos violentos. Pero la violencia a veces es innata. Y además hay mujeres que el psicólogo les recomienda ser más violentas, porque un exceso de simpatía hace que te seas demasiado servicial y te afecta en la autoestima.</li>
</ul>
</section>
<section id="regla-12.-si-ves-un-gato-por-la-calle-acarícialo" class="level2">
<h2 class="anchored" data-anchor-id="regla-12.-si-ves-un-gato-por-la-calle-acarícialo">Regla 12. Si ves un gato por la calle, acarícialo</h2>
<ul>
<li>Somos frágiles. Tenemos que aceptarnos y querernos entre nosotros con nuestras limitaciones sin intentar corregir.</li>
<li>¿Qué le falta a un ser omnisciente, omnipresente y omnipotente? Limitación. Si uno no tiene limitaciones, consigue todo, y entonces no tiene una historia. La limitación te da una historia.</li>
<li>“En una vasija, es su interior vacío lo que la hace útil. En una ventana, es su interior vacío lo que la hace útil. Lo que hay es provecho; lo que no hay, útil.” (Lao Tse)</li>
</ul>


</section>

 ]]></description>
  <category>lecturas</category>
  <guid>https://lhansa.github.io/posts/2023-07-19-12-reglas-para-la-vida/</guid>
  <pubDate>Wed, 19 Jul 2023 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
