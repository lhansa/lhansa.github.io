<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Leonardo Hansa</title>
<link>https://lhansa.github.io/contenidos.html</link>
<atom:link href="https://lhansa.github.io/contenidos.xml" rel="self" type="application/rss+xml"/>
<description>Tips sobre análisis de datos</description>
<generator>quarto-1.4.552</generator>
<lastBuildDate>Sun, 31 Mar 2024 00:00:00 GMT</lastBuildDate>
<item>
  <title>Distancia de Mahalanobis</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2024-03-31-mahalanobis/</link>
  <description><![CDATA[ 





<p>Tienes este conjunto de datos (una nube de puntos que sigue una regresión y un atípico):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>())</span>
<span id="cb1-3"></span>
<span id="cb1-4">n_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-5"></span>
<span id="cb1-6">beta_0 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb1-7">beta_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-8"></span>
<span id="cb1-9">x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n_size, beta_0)</span>
<span id="cb1-10">y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> beta_0 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> beta_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(n_size, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-11"></span>
<span id="cb1-12">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caso =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nube"</span>)</span>
<span id="cb1-13"></span>
<span id="cb1-14">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb1-15">  df, </span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb1-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb1-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> beta_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quantile</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probs =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.75</span>), </span>
<span id="cb1-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caso =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"extra"</span></span>
<span id="cb1-20">  )</span>
<span id="cb1-21">)</span>
<span id="cb1-22"></span>
<span id="cb1-23"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> caso)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-03-31-mahalanobis/index_files/figure-html/generacion-datos-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Y haces una selección de dos puntos, dentro de la nube. La selección no es aleatoria: he seleccionado los puntos con menor y mayor valor en el eje <img src="https://latex.codecogs.com/png.latex?x">.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caso[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.min</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x))] <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"selección"</span></span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row.names</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb2-3"></span>
<span id="cb2-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> caso)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb2-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caso <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"selección"</span>, ], </span>
<span id="cb2-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y), </span>
<span id="cb2-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span></span>
<span id="cb2-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-03-31-mahalanobis/index_files/figure-html/seleccion-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La situación que te planteo es: ¿entre qué pares de puntos hay más distancia: entre el azul derecho y el rojo, o entre los dos azules?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">df_segment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caso <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nube"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]</span>
<span id="cb3-2">df_segment <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df_segment[<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(df_segment<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x), ]</span>
<span id="cb3-3"></span>
<span id="cb3-4">df_segment<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>xend <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)]</span>
<span id="cb3-5">df_segment<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>yend <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which.max</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)]</span>
<span id="cb3-6"></span>
<span id="cb3-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row.names</span>(df_segment) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> caso)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(</span>
<span id="cb3-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caso <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"selección"</span>, ], </span>
<span id="cb3-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y), </span>
<span id="cb3-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span></span>
<span id="cb3-15">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(</span>
<span id="cb3-17">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_segment,</span>
<span id="cb3-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> yend), </span>
<span id="cb3-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colour =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grey"</span></span>
<span id="cb3-20">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_manual</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lightblue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"darkblue"</span>))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-03-31-mahalanobis/index_files/figure-html/segmentos-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="distancia-euclídea" class="level2">
<h2 class="anchored" data-anchor-id="distancia-euclídea">Distancia euclídea</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">df_dists <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caso <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nube"</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]</span>
<span id="cb4-2">m_dists <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dist</span>(df_dists)</span>
<span id="cb4-3">m_dists</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            87       762
762  12.499770          
1001  3.810869 14.525021</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(m_dists)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            87      762      1001
87    0.000000 12.49977  3.810869
762  12.499770  0.00000 14.525021
1001  3.810869 14.52502  0.000000</code></pre>
</div>
</div>
<p>La distancia entre ambos puntos azules es 14.5250213 mientras que la distancia entre el punto azul máximo y el rojo es 3.8108694. Dicho así, la diferencia está clara… en el mundo euclídeo.</p>
<p>Pero en este caso estamos trabajando con dos métricas, <code>x</code> e <code>y</code>, y es posible qu tengan algún sentido de negocio (imagina que estás trabajando en un proyecto tuyo comparando dos métricas).</p>
<p>Bajo esa premisa, los puntos azules pertenecen a la misma nube de puntos pero el rojo no. O sea, los puntos azules tienen algo en común que el rojo no tiene.</p>
<p><strong>Desde ese punto de vista, el punto rojo debería estar más lejos de los puntos, que los puntos entre sí.</strong> Los puntos <em>están cerca</em> desde un punto de vista de negocio porque se explican bajo la misma regla matemática (<img src="https://latex.codecogs.com/png.latex?y%20=%20%5Cbeta_0%20+%20%5Cbeta_1%5Ccdot%20x">) mientras que el rojo no la sigue.</p>
<p>¿Qué hacemos aquí?</p>
</section>
<section id="distancia-de-mahalanobis" class="level2">
<h2 class="anchored" data-anchor-id="distancia-de-mahalanobis">Distancia de Mahalanobis</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1">df</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                x            y      caso
1    -0.187463830 -0.809695460      nube
2     0.725326834  1.942780067      nube
3     1.209149319  3.028543614      nube
4    -0.569458254 -0.631143022      nube
5    -0.817960645 -1.330156407      nube
6     2.445793339  6.460223960      nube
7    -0.384375208  0.587292676      nube
8     0.132087447  1.730924803      nube
9     1.224047146  3.359865552      nube
10   -0.173213402  2.310468816      nube
11    1.148690634  3.044949541      nube
12    0.717526199  0.714251793      nube
13   -0.796639548 -2.167617210      nube
14   -1.908827945 -2.020860331      nube
15    1.535941196  2.113993919      nube
16    2.251392394  3.703599339      nube
17    1.664706059  5.207202053      nube
18    1.912755713  4.877944179      nube
19   -0.563149428 -0.047839516      nube
20    0.720768002  1.662885027      nube
21   -1.522738049 -2.453604801      nube
22   -1.229084342 -0.898174428      nube
23   -0.921352306 -0.594402237      nube
24   -0.807129064 -0.215289384      nube
25   -0.013459090  0.759222000      nube
26   -0.462659428  0.196680521      nube
27    0.396059829  1.456756622      nube
28   -0.041784800  0.452610589      nube
29   -0.451490267 -1.521308766      nube
30    0.065491915 -0.140733175      nube
31    0.564090866  0.856893887      nube
32   -0.569139515 -0.567591725      nube
33   -0.597433701 -0.015731768      nube
34   -0.833535247 -1.437372043      nube
35   -0.055210538  1.510768261      nube
36   -0.090636570  0.566044226      nube
37    1.147081943  1.447118830      nube
38    0.246253282  0.269480483      nube
39   -0.125350143 -1.274985379      nube
40   -0.476603979 -1.249395160      nube
41   -1.211362742 -0.830377580      nube
42   -0.837968369 -1.880845523      nube
43   -2.048957418 -3.810734325      nube
44    0.268827552  0.448753260      nube
45    0.858574729  1.998404819      nube
46    0.297387281  0.209789059      nube
47   -0.916745447 -2.844709520      nube
48    0.097811540 -1.033162565      nube
49   -1.022532425 -1.837672098      nube
50    1.311462806  2.679496041      nube
51   -0.682625215 -2.628237966      nube
52   -0.622270033 -0.631059363      nube
53    1.467458292  2.952660268      nube
54   -1.826114727 -3.965609202      nube
55   -1.693177004 -3.605108502      nube
56    0.064519175  0.469847745      nube
57    1.850853120  2.885032136      nube
58   -1.491955063 -4.017737275      nube
59   -0.598846423 -0.775871913      nube
60    0.204320313  1.584112557      nube
61   -0.428405119 -1.712654681      nube
62    0.307478807  0.062794258      nube
63   -0.164353865 -0.134483041      nube
64   -0.994415606 -2.481216815      nube
65   -1.097855352 -1.403380863      nube
66    2.678922248  5.445472028      nube
67    2.660876526  5.026813176      nube
68    1.562264515  4.681179172      nube
69    0.138645024  0.757854227      nube
70    0.262148138  1.109629654      nube
71    0.718933457  1.531928030      nube
72   -0.808092084 -0.920521294      nube
73    0.112383477 -1.713658347      nube
74   -0.878288945 -1.715969929      nube
75    1.016892336  2.653120918      nube
76   -0.003630719  0.182668341      nube
77    0.063580057 -0.622290811      nube
78    0.508998122  2.150454400      nube
79    1.303843585  3.474297119      nube
80   -0.606896677 -1.943665256      nube
81   -0.697307166 -0.191556986      nube
82   -1.207532670 -1.720541359      nube
83    0.400119485  0.072959174      nube
84    1.687066246  5.915380346      nube
85    0.199904291  0.126906378      nube
86    0.553447102  3.754616698      nube
87    3.041785555  5.315707810 selección
88    1.033393715 -0.066733234      nube
89    1.476644410  3.496542712      nube
90   -0.795063984 -1.646352148      nube
91   -0.360426410 -0.288034374      nube
92    0.396039751  1.904481593      nube
93   -1.337205921 -2.384671205      nube
94    1.215883659  3.290697220      nube
95    0.291788263  0.045210148      nube
96    2.397227516  4.256304125      nube
97   -0.117983628 -0.463455997      nube
98   -0.421323112  0.280750709      nube
99    2.398753654  6.906500396      nube
100   0.210935620  0.730426685      nube
101   0.035385844  0.416612001      nube
102   0.126174349  1.425143560      nube
103  -2.488780695 -4.371304303      nube
104  -0.729485483 -1.084771487      nube
105  -0.087102379 -0.066280404      nube
106   0.850049982  2.433375866      nube
107  -0.729736406 -1.475072435      nube
108   0.182509413 -0.625139775      nube
109   0.899683974  0.164915772      nube
110  -0.330810206  0.052010419      nube
111  -1.565100527 -2.535030035      nube
112   1.096319917  1.953228226      nube
113  -0.380697319  0.610466390      nube
114   1.616386472  2.433150263      nube
115  -0.092477786 -0.591954255      nube
116   2.567940627  5.854229238      nube
117   0.246459808 -0.443614685      nube
118  -0.093839382 -1.781710290      nube
119  -1.389282505 -4.656819422      nube
120  -0.485945847 -1.264093306      nube
121  -0.440802519 -0.115128085      nube
122  -0.514569552  0.020573426      nube
123   0.550196114  1.222880248      nube
124   0.188220955  0.331517658      nube
125   1.039961303  3.775324267      nube
126   0.790121934  1.240355856      nube
127  -0.841580029 -1.626319878      nube
128  -0.845142408 -1.768753745      nube
129  -2.594475906 -4.460806378      nube
130   1.133239872  3.028148902      nube
131  -0.650351551 -0.123506057      nube
132   1.246850369  1.991413200      nube
133   0.014216552  0.422743730      nube
134   1.380802498  2.886896144      nube
135  -0.145984036  1.490806186      nube
136   1.406328488  3.487014170      nube
137  -0.212684636 -0.780349086      nube
138   1.229369977  2.554069042      nube
139  -1.412095541 -0.974294628      nube
140   0.747488925  1.393824648      nube
141   0.191814048  0.732932581      nube
142   1.545715011  2.745038698      nube
143   0.345701528  1.762086908      nube
144   0.100115694 -0.226398780      nube
145   0.244187146 -0.924856104      nube
146   0.983873279  0.381619552      nube
147  -1.068865020 -1.007449626      nube
148  -0.614518408 -0.652060336      nube
149  -0.732181493 -0.332786667      nube
150   1.279059545  2.904512090      nube
151   1.146784433  1.579683581      nube
152   0.238702202  0.423728735      nube
153  -1.190841295 -2.466812283      nube
154  -0.737133714 -1.615398226      nube
155   1.051357665  2.506994195      nube
156   0.215815958 -0.581236781      nube
157   0.564032214  1.792836406      nube
158   0.179357889  0.843374644      nube
159   1.120841003  3.859721868      nube
160   0.074400812  1.004971891      nube
161   0.325763984  0.305433501      nube
162  -0.648580973 -1.282334306      nube
163   1.076292061  2.330833143      nube
164  -0.116453090  0.548153742      nube
165  -0.896173406 -1.677773530      nube
166  -1.792765914 -1.620832895      nube
167  -0.701771265 -1.032233091      nube
168  -1.137915094 -2.543805480      nube
169  -0.761924539  0.213872409      nube
170   1.746083888  3.850291356      nube
171   0.547780609  0.639065066      nube
172  -1.190238629 -1.998131818      nube
173  -0.014687765  0.047906556      nube
174  -0.166080895  0.866610569      nube
175  -0.632956086  0.351187793      nube
176  -0.519078428 -1.494668510      nube
177   1.495010395  3.273565080      nube
178  -0.017066072  0.435713804      nube
179   1.134611395  2.516764713      nube
180  -0.111812895  0.848802930      nube
181  -1.525432007 -3.500128559      nube
182  -0.784478325 -0.933434682      nube
183  -0.911198371 -1.794065067      nube
184  -1.009327793 -1.747469198      nube
185   0.643320792  0.552510837      nube
186  -0.808401448 -3.223605970      nube
187   0.728131185  0.796887834      nube
188   0.159563650  0.417960040      nube
189   1.425627518  1.834769985      nube
190  -1.777675070 -2.696716315      nube
191  -0.111507591 -1.669745711      nube
192  -0.425295486 -0.500619840      nube
193  -0.353291758 -1.979096416      nube
194  -1.056030383 -2.018489734      nube
195   0.381005030  1.327315164      nube
196  -1.112515722 -3.379849148      nube
197  -0.064527282 -1.720061582      nube
198   3.005588237  5.459111628      nube
199   1.072280399  1.538538038      nube
200  -0.917576578 -1.524974455      nube
201   0.428577595 -0.581309574      nube
202  -0.527523890 -2.579922287      nube
203   0.556827791 -0.306029732      nube
204  -2.229229997 -5.333499648      nube
205  -1.429105405 -2.761092336      nube
206   0.509429468  1.396656073      nube
207   0.477015193 -0.015268855      nube
208   0.766371058 -0.364068572      nube
209  -0.661012299 -0.865353411      nube
210   0.735880024  1.185458803      nube
211   0.012716235 -0.487683825      nube
212  -0.022694916  0.247219824      nube
213   0.395978844  0.420749346      nube
214   1.322295877  4.088061379      nube
215  -0.377450786 -1.274864981      nube
216  -1.922468208 -4.661636808      nube
217  -0.701436511 -1.370112498      nube
218  -0.279908377 -0.214168447      nube
219   0.286064596  1.568388229      nube
220  -1.517052968 -1.054998945      nube
221   0.430057378  0.697483142      nube
222  -0.964101332 -1.079465150      nube
223  -1.132805823 -1.816139829      nube
224  -2.089610715 -4.619326622      nube
225   0.563491410  1.188046125      nube
226  -1.351881140 -1.367423666      nube
227   0.152978853  0.589908733      nube
228   0.203110757 -1.942294238      nube
229  -0.952400214 -1.439113722      nube
230  -0.346492318 -0.975471334      nube
231  -0.832097543 -1.046940814      nube
232   0.147368350 -0.634820186      nube
233   0.761214845  0.445572195      nube
234  -0.766303951 -1.892047383      nube
235   0.228439006  0.147835062      nube
236   1.003325890  4.663838168      nube
237   0.920030422  2.412226154      nube
238   1.362661467  5.237657331      nube
239   0.093141184 -1.145215168      nube
240  -0.101845912  0.382314799      nube
241   1.481365949  2.801784642      nube
242  -0.014653565  0.596610530      nube
243   0.772087620  1.338092444      nube
244  -0.475182810  0.049762891      nube
245   1.668816377  3.689830032      nube
246  -0.214211244  0.106011228      nube
247  -0.401292313 -0.924203772      nube
248  -0.439822247 -2.176469747      nube
249  -0.704310921 -1.743050148      nube
250   1.672837696  1.818343085      nube
251  -0.205500859 -0.822369516      nube
252  -0.296776084  0.814798752      nube
253  -0.658657423  0.468967218      nube
254  -0.092633814 -0.463645035      nube
255   0.754695775  0.734569354      nube
256  -1.723895520 -2.267617323      nube
257  -0.919270102 -2.671839230      nube
258   1.705071100  2.908677403      nube
259  -0.500074670 -2.507470597      nube
260   0.305560219  0.597101310      nube
261  -1.146613733 -2.203671484      nube
262  -0.769852699 -2.721320541      nube
263  -0.637355711 -1.712951491      nube
264   0.098239346 -0.276353793      nube
265  -1.165815884 -0.657989486      nube
266  -0.222259180  1.427055421      nube
267  -1.892011314 -3.190994915      nube
268  -0.291311576 -0.962153339      nube
269  -0.740042069 -2.752951192      nube
270   0.247294934  0.320599829      nube
271   0.626042522  2.363907654      nube
272  -1.050185268 -3.746714511      nube
273  -0.867801611 -2.152485563      nube
274  -0.612627763  0.389959100      nube
275   1.481016474  4.583263748      nube
276   1.737940674  4.252499431      nube
277  -1.115841495 -2.582326457      nube
278   0.358683906 -0.334288420      nube
279   0.545218770  0.165171291      nube
280  -0.027144948 -1.083136578      nube
281   0.154557213  0.958553726      nube
282  -1.025945015 -1.161725986      nube
283  -0.803460129 -2.852541274      nube
284  -0.966155595 -0.485758480      nube
285  -1.760843435 -1.899107276      nube
286   0.391404079  2.626118300      nube
287   0.559532277 -0.417216943      nube
288  -0.084061949 -0.518215072      nube
289  -0.275528249 -0.419111993      nube
290  -1.705010533 -4.495445848      nube
291   0.631594656  0.984691716      nube
292   1.709175626  4.065758894      nube
293  -1.342505426 -3.003946506      nube
294  -1.916417877 -3.326156777      nube
295   0.543830550  2.245392833      nube
296   0.420202226  0.555534152      nube
297   0.892374870  4.243093728      nube
298   0.983603443  3.199482648      nube
299  -2.194288455 -1.970818682      nube
300   1.664308189  5.458475659      nube
301  -2.575865360 -6.161391102      nube
302   0.918919125  2.930368672      nube
303   0.106261763  0.339706667      nube
304  -0.010534608 -0.397126409      nube
305  -1.942049817 -4.063802004      nube
306  -0.450846754  0.305183122      nube
307  -0.282766259 -1.658954471      nube
308  -0.556922459 -0.833746512      nube
309   0.340427661  1.720636865      nube
310   0.867117035  3.748148343      nube
311   0.124724439 -0.524894142      nube
312  -1.963831456 -5.010292242      nube
313   0.638130780  1.785045215      nube
314   0.895717595  2.137792402      nube
315   1.345596569  2.803201078      nube
316   0.010139773  0.608675157      nube
317  -0.893430378 -1.776894100      nube
318  -1.196479641 -3.239153692      nube
319  -0.726051339 -1.674993289      nube
320  -0.378763836 -1.016131713      nube
321   1.367507636  2.655773871      nube
322   1.164564556  2.271323120      nube
323  -0.805742925 -1.069708950      nube
324  -0.794762589 -1.963077654      nube
325  -0.043745632  0.922569999      nube
326   0.139761883  0.490646859      nube
327   0.711670794  1.410615272      nube
328  -0.624360698 -3.949497706      nube
329   1.164059586  2.005359989      nube
330  -1.916178785 -2.526500828      nube
331   1.801029864  3.443915424      nube
332  -2.209629876 -5.013003177      nube
333  -0.013091299  0.957360918      nube
334  -0.472565839 -1.370914812      nube
335   0.390182921  0.783343090      nube
336  -1.067293984 -1.424796810      nube
337   0.405310795  1.052658546      nube
338   1.222623189  2.482871851      nube
339  -0.550716030 -1.572318562      nube
340  -2.093584111 -5.288719472      nube
341   1.724345099  2.996663082      nube
342  -0.148500789 -1.433659859      nube
343   0.585713074  0.572608098      nube
344  -0.876638782 -0.430104331      nube
345  -0.134797974  0.610716694      nube
346   0.166000941 -0.471722120      nube
347  -0.152645494  2.983072255      nube
348  -1.161804556 -2.139564485      nube
349  -0.942420809 -2.082105538      nube
350   0.964478544  1.320747300      nube
351  -1.057616612 -3.461307211      nube
352   1.675026035  3.995358400      nube
353  -0.705344830 -1.557520761      nube
354  -0.069391911 -0.633645926      nube
355   0.775044216  2.029579469      nube
356   0.171895874  0.492084684      nube
357   1.153367417  0.356028714      nube
358  -0.342486254 -0.167500468      nube
359  -1.120706556 -2.716892755      nube
360  -0.417640298 -2.727798872      nube
361   1.423759271  2.244805326      nube
362   2.046776813  4.107367970      nube
363   0.351148615  1.663043475      nube
364  -0.322707580 -1.136779233      nube
365  -0.755073847 -1.612308575      nube
366   0.466902822  0.887328784      nube
367  -0.625433802 -2.514669974      nube
368  -1.200704489 -3.097305558      nube
369   0.468369326  0.861459867      nube
370   1.610476593  4.041567514      nube
371  -0.820773163 -0.953583134      nube
372  -0.815637672 -1.728688218      nube
373  -0.791847179 -3.092145087      nube
374   0.095960974 -0.368715632      nube
375   2.040539657  4.696472450      nube
376  -0.309163652 -0.520129320      nube
377  -0.330631872 -2.757238686      nube
378   0.093621381 -0.326844578      nube
379  -0.997006304 -2.635391228      nube
380  -0.388866490  1.089967469      nube
381  -1.091126094 -2.479770987      nube
382  -1.414853849 -2.248372245      nube
383   1.101792544  0.453507740      nube
384  -0.639910864 -1.522089798      nube
385  -2.162896647 -4.705486728      nube
386   0.587957613  0.927861582      nube
387  -0.358145143 -1.618408727      nube
388  -0.120681737 -1.029760331      nube
389   0.651692903  0.472186275      nube
390  -0.186613345  0.450167810      nube
391  -0.506469593 -2.556616042      nube
392  -0.815142187 -0.584798539      nube
393  -0.593485756 -0.454808919      nube
394  -0.162669597 -1.209112167      nube
395   0.158071783 -0.883034625      nube
396   0.219799262  1.333319609      nube
397   1.151259540  3.239459125      nube
398   1.111071941  1.566654794      nube
399  -2.681298694 -5.057386656      nube
400  -0.426868817  0.323655101      nube
401  -1.465462402 -2.743793351      nube
402   0.486370553  1.433478334      nube
403  -1.178329425 -4.774660187      nube
404  -1.220389433 -1.006205386      nube
405   0.030453845 -0.614230638      nube
406  -0.817506134 -1.467799835      nube
407   1.878523567  2.605529829      nube
408   0.539022760 -0.420353433      nube
409   1.121984543  3.211542759      nube
410  -1.075845623 -0.783952127      nube
411  -0.909872512 -1.571481864      nube
412   0.395625388 -0.728602373      nube
413  -0.660359340 -1.828660332      nube
414   0.685223251  0.352590877      nube
415   0.481639177  2.082155073      nube
416   0.259495012  0.428370116      nube
417   0.941708210  2.439840374      nube
418   0.091658283 -1.016204167      nube
419   0.291881245  4.014003809      nube
420  -0.428728141 -1.151250054      nube
421  -0.451565620 -1.236607841      nube
422  -1.377286747 -2.204520204      nube
423   0.024859038  0.328744359      nube
424   0.377118825  2.266868609      nube
425  -0.911936170 -1.430197209      nube
426   0.536309738  2.092205782      nube
427   1.507137853  1.753898003      nube
428  -0.595013227 -0.594190574      nube
429   0.277664316  1.351222949      nube
430  -1.067275069 -1.902401145      nube
431   0.524194059  1.002597412      nube
432   1.430369153  1.170329868      nube
433  -1.076095588 -2.694340877      nube
434  -0.052135079 -0.266285949      nube
435   0.174803541  0.127345314      nube
436  -0.479538178 -0.100437372      nube
437  -0.250329777 -0.115718586      nube
438  -0.444596730 -1.219034211      nube
439  -0.759617803 -1.186252939      nube
440  -0.538080709 -2.207314241      nube
441  -0.142148971  1.318924444      nube
442   0.755675922  1.948990231      nube
443   0.465052945  1.183921161      nube
444   0.543388576  2.341701990      nube
445   1.551891411  4.007060905      nube
446   0.972036879  2.464820902      nube
447   1.835451868  2.628602752      nube
448   0.905219850  1.596892642      nube
449   1.469937938  1.879636786      nube
450  -0.331142508  0.057249629      nube
451   2.710551187  5.669006832      nube
452   0.040272512  2.652919157      nube
453  -0.241883760 -1.638115934      nube
454   0.514243812  3.117922528      nube
455  -0.435495297 -2.074977726      nube
456  -0.623457938 -1.548710072      nube
457   0.716711271  1.689781556      nube
458   0.579165924  2.918043587      nube
459   0.842449206  1.646167518      nube
460  -0.979088151 -1.568881587      nube
461   0.160685686  0.724877791      nube
462   1.660681025  2.757009609      nube
463   0.272228912  0.341225562      nube
464  -0.122554690 -0.857890983      nube
465   0.482792800  0.765708243      nube
466   1.075901563  2.296831870      nube
467   0.615778469  0.490926515      nube
468   0.156830609  0.907636069      nube
469  -1.554513607 -1.771829057      nube
470   0.042607146  3.035971246      nube
471   0.716148590  1.778254520      nube
472   0.301818986  1.039603170      nube
473  -0.212027799  1.370814249      nube
474   0.990574113  1.640457225      nube
475   1.161709802  2.751046468      nube
476  -1.215768064 -2.349436857      nube
477   0.037135413 -1.225106348      nube
478  -1.799355966 -3.174778878      nube
479   0.947213855  1.331135902      nube
480   1.047744980  3.654270512      nube
481  -0.762120019 -1.205261967      nube
482   0.431523095  0.557682381      nube
483   2.788937755  6.571971357      nube
484   1.002372391  0.354751905      nube
485   0.619031973  2.572653031      nube
486  -0.566251518 -2.571210680      nube
487  -0.613910578 -0.201646156      nube
488  -0.377111933 -1.083111468      nube
489  -1.294738348 -4.057910237      nube
490  -0.961776457 -1.966347486      nube
491   1.244954603  2.467431295      nube
492  -0.272267147 -1.098822259      nube
493  -1.451374083 -3.950148635      nube
494   0.759239861  1.113406877      nube
495   0.778399386  1.817035194      nube
496   1.239054565  2.558794547      nube
497   1.037504592  2.753425130      nube
498  -1.370211159 -3.621359831      nube
499  -0.394873093 -0.959636696      nube
500  -0.014821060 -0.341352209      nube
501  -1.778888587 -1.911049163      nube
502   0.701046517  1.580518775      nube
503  -1.410084307 -2.140745037      nube
504   0.197213195  1.087355658      nube
505  -2.000917051 -4.848346877      nube
506  -1.385123740 -2.564209336      nube
507   0.629150449  2.650552697      nube
508   1.158798210  3.241168761      nube
509   1.225738685  1.763656884      nube
510  -1.584696042 -2.020935280      nube
511   1.209094018  2.583883915      nube
512  -0.856061332 -1.931350059      nube
513  -0.297339822 -0.036835540      nube
514   0.185258032  1.036595812      nube
515   2.004713402  3.806257459      nube
516   0.316811367 -0.120520558      nube
517   0.376325415 -0.459502830      nube
518   0.842364896  1.348747073      nube
519   2.253091176  3.511772070      nube
520  -2.244957251 -3.486482646      nube
521   0.268726941  0.052173929      nube
522  -0.547780720 -0.312308168      nube
523  -1.229925756 -2.818884771      nube
524   0.995961190  2.613258196      nube
525  -0.336351591 -0.742614251      nube
526  -0.145817736  0.017889354      nube
527   1.250950219  4.133973320      nube
528   1.076036641  1.411863711      nube
529   1.049275023  0.139071077      nube
530   0.916076256  3.018540105      nube
531   1.081123939  2.903111275      nube
532  -0.058178581  1.369797008      nube
533  -1.066111898 -1.836675866      nube
534  -1.600752779 -1.599290424      nube
535   0.071414050 -0.180869920      nube
536   0.742796612  2.241826960      nube
537  -0.021590834 -0.306569501      nube
538   0.723954044  1.357398615      nube
539  -2.070816776 -3.718636925      nube
540  -0.755092625  0.162623236      nube
541   1.927407685  3.467162410      nube
542   1.136526961  2.572436893      nube
543   0.404911569 -0.321521316      nube
544  -1.141194433 -3.027976701      nube
545  -0.168645197  0.404835655      nube
546  -1.207741858 -0.566375090      nube
547   2.595763134  4.461274674      nube
548   0.776499162  1.476617387      nube
549   1.869805341  4.002146721      nube
550   0.201758989  0.706401101      nube
551  -0.804077076 -1.169124001      nube
552  -0.192187803  0.471437272      nube
553  -0.981048790 -2.025872936      nube
554  -0.270271735  0.040112064      nube
555   0.875162716  2.845368861      nube
556  -0.195166643 -0.370992400      nube
557   0.060480955 -0.346163214      nube
558  -0.974544860 -1.270837629      nube
559  -0.317001683 -1.561054638      nube
560  -0.279816050 -2.314753643      nube
561  -0.888268038 -2.128876598      nube
562  -1.051218672 -3.303227278      nube
563   1.560792441  1.869553525      nube
564  -1.135654571 -3.101376028      nube
565  -0.497300178 -1.270346490      nube
566   0.720456420  1.162371837      nube
567   0.613234737  1.624286906      nube
568   0.457120604  1.306084742      nube
569  -0.276190208 -1.104872901      nube
570   0.601960775  2.034495790      nube
571   1.464242664  3.503387444      nube
572   1.273830628  2.151968880      nube
573   0.499333658  2.460303425      nube
574   0.244373666 -1.290222152      nube
575  -0.487461718 -0.221655381      nube
576   0.827385531  1.727160884      nube
577   1.489776271  1.987946571      nube
578  -0.604260556 -0.911616908      nube
579   1.469875203  3.075416581      nube
580   0.454334241  0.249489188      nube
581  -1.139449385 -2.562510617      nube
582   0.072962418  0.376646310      nube
583  -0.178893977 -1.601618026      nube
584   1.112166442  1.361535373      nube
585   0.461776372 -0.931086841      nube
586   0.342107403  1.020155894      nube
587   0.144950477  0.313105716      nube
588  -0.466460376 -0.977493019      nube
589  -0.527619052  0.485124663      nube
590  -1.113869411 -2.151062927      nube
591   0.468580961 -0.933746861      nube
592  -0.134735067  0.951509546      nube
593   1.410053250  2.918830879      nube
594   0.438767129  1.270918920      nube
595  -1.358137046 -2.901774792      nube
596  -0.306753947 -2.391716619      nube
597  -0.194600222 -0.540333932      nube
598   0.498283864  2.988432300      nube
599   1.139933195  1.636951792      nube
600  -0.132620680 -0.704378906      nube
601  -0.846379729 -0.505782186      nube
602   0.364476849 -1.553436305      nube
603  -0.683967319 -1.421733625      nube
604   0.409781064  2.764138633      nube
605   2.458452501  3.383036010      nube
606   1.200451963  3.156245590      nube
607   0.616453411  1.954285603      nube
608  -1.368592053 -2.632624570      nube
609   0.622957312  2.176890851      nube
610  -0.366100338  1.839045577      nube
611  -0.509997388 -3.401816670      nube
612  -1.041217605 -1.937640796      nube
613  -0.480426138 -0.410380868      nube
614  -0.654713982 -2.657384394      nube
615  -0.554473440 -1.220770840      nube
616   1.430075816  3.074445718      nube
617   0.667242568  1.878642906      nube
618   0.754908354  1.595789832      nube
619  -1.032143897 -3.132080070      nube
620  -1.814733915 -4.693628053      nube
621  -0.736291222 -3.230682007      nube
622   0.846557487  2.878982746      nube
623   0.069962031 -0.417425293      nube
624  -1.039476928 -1.449324839      nube
625  -0.209497829 -1.593294080      nube
626  -1.752599519 -2.553108121      nube
627  -0.414762054  1.050246388      nube
628   1.252421668  2.054506936      nube
629  -0.231320939  0.476291798      nube
630   0.756349791  1.012165896      nube
631  -2.275933343 -4.184435810      nube
632  -0.292573474 -1.587309470      nube
633   0.988608577  2.042136161      nube
634   1.302773051  2.571237549      nube
635   0.837687779  0.433308411      nube
636   0.614756477  1.200732133      nube
637  -0.097430986 -0.151766595      nube
638   1.827733260  2.170563899      nube
639  -0.586708768 -0.810631854      nube
640  -1.674901912 -3.245695129      nube
641  -0.108548497  0.110919438      nube
642   0.126350896  0.600944718      nube
643   1.414032017  1.929777559      nube
644   0.881245091  1.580956641      nube
645   0.488528249  1.952068252      nube
646   0.191163486 -0.617780303      nube
647   0.601625362  0.129390294      nube
648  -0.174651697  0.251037991      nube
649   0.325312153 -0.324582142      nube
650  -0.959712758 -1.225684676      nube
651  -1.353484134 -2.391159788      nube
652  -0.393899624  0.244934966      nube
653   0.412843999  0.658480212      nube
654  -0.304292447 -0.093919284      nube
655  -0.138570249  0.040021637      nube
656  -1.792506739 -4.400318660      nube
657   1.926964043  3.733118515      nube
658  -0.416013232 -0.948769987      nube
659   0.673314123  1.192446285      nube
660   3.011493130  5.414482328      nube
661   0.508967375  1.145100805      nube
662  -0.740423915 -1.382745343      nube
663   0.242495478  1.645117428      nube
664   0.353142683  1.360390474      nube
665   0.930838589  2.473964679      nube
666  -0.316425384  0.401583493      nube
667  -0.785717905 -3.180319530      nube
668  -0.994012556 -1.043538240      nube
669   2.364801421  6.576042146      nube
670  -0.653786981 -3.213017607      nube
671   1.638959962  4.146943268      nube
672   0.407984747  0.633145636      nube
673  -0.049859316 -1.382845739      nube
674  -0.789694364 -0.932564690      nube
675   1.972599692  5.387200908      nube
676  -0.352341602 -0.973763777      nube
677  -0.357457821 -2.558974452      nube
678   0.672176377  1.559564046      nube
679  -0.988898501 -1.033707958      nube
680   0.045915652  1.820570379      nube
681   0.494733345  1.527629017      nube
682   1.682530038  3.147415030      nube
683   0.169219779 -0.463257042      nube
684   0.590694053  1.653262612      nube
685  -0.916046553 -2.448381807      nube
686  -0.489980002  0.234031811      nube
687   1.666562348  2.587460514      nube
688   1.447685810  1.782604490      nube
689  -0.603238328 -2.971382946      nube
690   0.292076691 -0.646306534      nube
691   0.439877598  1.014249410      nube
692  -1.836626380 -5.091431969      nube
693  -1.578418026 -3.151550781      nube
694  -0.951947150 -1.010603387      nube
695   0.374527264  1.598921386      nube
696   1.576562423  3.022829319      nube
697   1.624787903  3.405131443      nube
698  -0.766260330 -1.691801590      nube
699   1.277200166  2.863299301      nube
700  -0.732105037 -1.495062191      nube
701   0.832798160  0.440788780      nube
702   0.839103308  1.681626331      nube
703   1.248117325  3.396598429      nube
704   1.224335832  0.656406538      nube
705   0.731233795  2.665594696      nube
706  -0.527125606  0.683719206      nube
707  -0.820139448 -1.433222775      nube
708   1.131085282  1.883816026      nube
709   0.764537583  0.299630484      nube
710   0.388389430  0.079478000      nube
711  -0.127139106 -0.159477355      nube
712  -1.520579882 -3.264476241      nube
713  -0.689399287 -2.438316287      nube
714  -0.470608768 -0.505251179      nube
715   1.018115891  0.151434000      nube
716  -0.613160408 -0.762516846      nube
717  -0.439673626 -1.455106636      nube
718  -0.677394991 -2.035704308      nube
719   1.459402035  2.210744578      nube
720   0.936619915  2.411514970      nube
721  -0.714422570 -0.578986999      nube
722  -0.733234835 -0.210016749      nube
723  -1.271511262 -3.026285961      nube
724   0.580933480  1.644931495      nube
725  -1.772610457 -3.482084200      nube
726   1.251538513  2.211048745      nube
727  -1.280117333 -2.116355180      nube
728  -0.353804134  0.617694740      nube
729   0.319107993  0.854554877      nube
730  -0.395409393 -0.872062773      nube
731   0.032017970 -1.409151073      nube
732  -0.578158585 -0.045119272      nube
733  -0.513267597 -1.877635168      nube
734   0.225702155 -0.146613220      nube
735   1.481582593  1.882068822      nube
736   1.068176020  1.422691572      nube
737  -1.077865622 -0.968201943      nube
738   0.728189639  1.899154696      nube
739  -1.052583059 -1.571015934      nube
740   0.798558633  0.478896263      nube
741  -1.057404110 -0.733276729      nube
742  -1.139883770 -0.231634649      nube
743   0.494418717  0.378756798      nube
744   1.575532919  4.320845406      nube
745  -1.403951586 -2.838680384      nube
746   0.819837992  1.101481082      nube
747   1.653180461  4.864985409      nube
748   1.088082473  2.794106622      nube
749  -1.105410628 -5.230722787      nube
750  -0.658310816 -1.020295295      nube
751  -0.961451505 -4.229727905      nube
752  -1.141821718 -3.339418440      nube
753  -1.105711652 -2.139915862      nube
754   0.487457681  0.568722079      nube
755  -1.521233095 -2.216461488      nube
756  -0.672773817 -2.388896134      nube
757   0.519662215  2.745331622      nube
758  -1.617740545 -3.555024358      nube
759   0.081807016 -0.408595355      nube
760  -1.500043532 -2.781831024      nube
761   1.616352838  4.201594362      nube
762  -2.703472812 -5.785475210 selección
763  -0.134452752  0.601502567      nube
764   0.111624572  0.835066335      nube
765  -0.161497167 -0.149303719      nube
766   1.203801855  4.923639570      nube
767   1.309517844  2.844210001      nube
768   0.724900405 -1.468761589      nube
769   0.246364496  0.357454019      nube
770  -1.866807263 -1.453840401      nube
771   0.282877857  1.553546652      nube
772  -0.920227127 -0.965901664      nube
773   0.825479735  1.410758812      nube
774  -0.803412083 -3.416935549      nube
775  -0.885414201 -0.471405117      nube
776   0.345634264 -0.442220104      nube
777   0.680694851  3.208559027      nube
778  -0.147326780 -0.606208880      nube
779   0.420871829 -0.527525927      nube
780  -1.153363350 -1.727780300      nube
781  -1.527545541 -2.913919270      nube
782   1.332873553  3.546332577      nube
783  -0.401481903 -1.567495560      nube
784  -0.483843038  1.589673974      nube
785  -1.069930887 -2.206230818      nube
786   0.708782265  3.208171540      nube
787  -0.271659795 -0.864349583      nube
788  -0.473446438 -2.102829877      nube
789   0.387698779 -0.756925209      nube
790  -0.681122707 -0.322887868      nube
791   0.340351108  1.050663885      nube
792   1.802409817  2.723948489      nube
793   0.417177239  1.807513437      nube
794  -1.031730960 -1.420818533      nube
795  -0.129829202  0.240010929      nube
796   1.663736956  2.787786373      nube
797  -0.120779482 -0.898666494      nube
798   0.331152453  2.188913265      nube
799  -0.256797176  1.071592319      nube
800   0.675141843  1.251294273      nube
801   0.675334791  1.510530495      nube
802  -0.841392134 -2.221396505      nube
803   0.482736926  2.925595798      nube
804   0.579066477  0.236111398      nube
805  -1.758176743 -3.041628072      nube
806   0.050460186  2.124799724      nube
807  -0.187905251 -0.994464270      nube
808   1.332486307  1.874772458      nube
809   0.184662223 -0.802370210      nube
810   0.727946484  3.305442674      nube
811  -0.439078694 -0.972728191      nube
812   0.183948496 -1.122733628      nube
813   1.476459475  2.755559652      nube
814  -0.687050932 -0.971467968      nube
815   0.226410389  1.030091808      nube
816   0.270513067  1.494677794      nube
817   0.791298388  2.059319929      nube
818  -0.157272734  0.499870621      nube
819   1.459750869  3.381067281      nube
820   0.456556953  0.539291126      nube
821  -0.956898823 -2.939605805      nube
822   1.065080407  3.177597732      nube
823   1.319357169  4.724796017      nube
824  -0.920648935 -3.083014646      nube
825   0.089779109  0.465846608      nube
826  -0.640043494  0.462196994      nube
827   0.848460745 -0.302924471      nube
828   0.249151602  0.008986181      nube
829   0.370438247  0.940070554      nube
830  -1.482551302 -1.371657225      nube
831   1.889781778  3.038291315      nube
832   0.415063723  0.878612407      nube
833  -0.984876058 -1.778914862      nube
834   0.357519553  0.697714832      nube
835  -1.813591414 -3.164297377      nube
836   0.759412098  0.182985635      nube
837  -2.279699291 -4.553541258      nube
838  -0.406026363 -2.955617678      nube
839  -0.018182874  1.711244417      nube
840   0.417095118  0.995709957      nube
841  -0.041797038  0.012675785      nube
842   0.752774796  0.749113841      nube
843  -0.785980836 -2.413867397      nube
844  -0.497406912 -0.918314130      nube
845   0.824484880  1.096000544      nube
846  -0.901348542 -0.941774820      nube
847  -1.649701076 -3.942935646      nube
848   0.877195995  1.919336340      nube
849   0.801607021  0.338164156      nube
850  -1.254447639 -1.266375655      nube
851  -0.820956440 -0.812778686      nube
852   0.110253426 -0.616793397      nube
853  -1.105385825 -1.107546386      nube
854  -0.405771277 -1.199516884      nube
855   1.467101308  2.108019867      nube
856  -0.828602536 -0.620610849      nube
857   0.217293496 -0.479010867      nube
858   0.029401241  1.121068071      nube
859  -0.612385041 -1.015349783      nube
860  -1.236301103 -2.280759928      nube
861  -0.941226056 -3.216347998      nube
862   1.111820121  2.676181161      nube
863   0.090157232 -0.314212994      nube
864   0.300236119 -0.323531144      nube
865  -1.187831899 -3.222736025      nube
866   0.343869497 -0.009261204      nube
867   2.097003032  5.670147830      nube
868  -1.148275314 -3.755993656      nube
869   0.683087967  1.596061517      nube
870   0.148575226  1.640330036      nube
871   0.638929328  0.350923016      nube
872   0.170778613  1.109300780      nube
873  -1.516241048 -2.592040658      nube
874  -1.026155791 -3.093715549      nube
875   1.479057336  4.089775258      nube
876  -0.118911385 -1.104301121      nube
877   0.968380759  1.226684988      nube
878  -0.863653354 -3.292579721      nube
879  -0.706927753 -2.668052935      nube
880  -0.136573504  0.439406341      nube
881   0.848075046  1.469353719      nube
882  -0.563605829 -0.920783014      nube
883  -0.816162346 -2.104482623      nube
884  -1.613039186 -3.511713945      nube
885  -1.061991814 -3.189256840      nube
886  -1.453535838 -3.932342826      nube
887   0.133953993 -0.121932811      nube
888  -0.323401566 -2.102529652      nube
889  -0.398651018 -0.870003285      nube
890  -0.549856600 -1.105681141      nube
891  -0.244733051 -1.082656329      nube
892   0.530824522 -0.317010739      nube
893   0.447058651  0.681025686      nube
894  -1.549191127 -3.091501497      nube
895   0.140114869  1.481646789      nube
896  -0.860909049 -3.498805285      nube
897   1.777538817  3.191561613      nube
898   0.973663901  2.301786444      nube
899   0.652787491  0.378558482      nube
900   0.863804275  0.805481381      nube
901   0.182080163  0.330333072      nube
902  -0.267163236 -0.648054234      nube
903  -0.307248769 -0.276114336      nube
904  -1.710220218 -2.844824240      nube
905  -1.417137918 -3.438186200      nube
906  -0.330760933 -0.079244182      nube
907   0.636030246  0.618581288      nube
908  -0.513907726 -1.282900233      nube
909  -1.045444835 -3.451116740      nube
910   1.440189339  4.497358347      nube
911   0.498418764  2.073618048      nube
912   1.791412939  3.317497758      nube
913   0.275587427  0.224174532      nube
914   0.223327335  1.336932821      nube
915  -0.188189473 -0.394349331      nube
916   1.331681236  3.242771952      nube
917   0.238696543  0.562513261      nube
918  -0.683882706 -1.363469862      nube
919  -0.647446229  1.246554024      nube
920   1.193077122  3.211912137      nube
921   0.064390561 -1.077854518      nube
922   0.233189382  0.991772712      nube
923  -0.799845515 -0.328591941      nube
924   0.333391509 -0.042889259      nube
925  -0.466048361 -1.516096896      nube
926  -0.738821449 -1.075682243      nube
927  -0.232615187 -0.857253351      nube
928  -1.549819929 -5.126550091      nube
929  -0.479942870 -0.889946270      nube
930   0.097806291 -1.167810389      nube
931  -0.141296391 -0.514107194      nube
932  -2.089530348 -3.158282271      nube
933  -1.078573644 -1.474950286      nube
934   1.106258698  1.805284360      nube
935  -0.806480392 -1.554930187      nube
936   0.309296252  1.165437451      nube
937  -0.381063737 -1.785995533      nube
938   0.917893198  3.417934907      nube
939   1.358869365  2.713917097      nube
940   0.481319213  3.476262337      nube
941  -0.500012405 -0.092361401      nube
942  -1.964098832 -4.323124287      nube
943   0.072905125 -0.684865482      nube
944   1.706217415  2.205626309      nube
945  -0.054096856  0.013423298      nube
946  -0.854888438 -0.185087251      nube
947  -1.142273373 -3.039741739      nube
948  -0.455728222 -1.669676891      nube
949   1.643438087  3.387236557      nube
950  -0.722641820 -3.019849308      nube
951   0.568502565  2.046796167      nube
952  -0.347554564 -1.108414256      nube
953   0.204641793  1.582219683      nube
954  -0.918467005 -1.172124535      nube
955  -0.378477441 -0.115563591      nube
956  -0.503409994  0.413114675      nube
957   0.152893317 -0.270017951      nube
958  -1.990507347 -3.252845465      nube
959  -1.223861808 -3.366025486      nube
960   0.001507376 -0.429350615      nube
961   0.379932403 -0.285119372      nube
962   0.256552409  0.638127393      nube
963  -0.281344563 -0.252919826      nube
964  -1.319520814 -3.627508072      nube
965  -0.879940043  0.784502967      nube
966  -0.980618473 -0.321530877      nube
967   1.212322254  3.404819249      nube
968   0.839345693  0.114417026      nube
969  -1.256989555 -2.173294234      nube
970   1.355329880  3.404125973      nube
971   0.634769570  0.702889685      nube
972  -1.302178416 -0.380371752      nube
973  -0.680837424 -3.020193290      nube
974   0.942121962  0.741064219      nube
975   0.340127325 -0.118238696      nube
976  -0.625217088 -2.427489691      nube
977   0.490403761  0.308027643      nube
978  -1.294782498 -2.878287469      nube
979   0.166955789  0.472481160      nube
980   0.689883152  0.290131756      nube
981  -0.043984545 -0.364799494      nube
982   0.308993123  1.874156305      nube
983   1.229914021  1.713600266      nube
984   0.820355547  3.072776542      nube
985  -0.068937476  0.859327622      nube
986   1.603884584  2.330287723      nube
987  -0.793202675  1.126225051      nube
988  -1.161660578 -1.997070786      nube
989   0.356137095  1.300322517      nube
990  -0.360453073 -2.219028362      nube
991  -0.769138934 -1.858476113      nube
992  -0.574469093 -0.912362169      nube
993   0.282434035 -0.118092968      nube
994   1.317944734  2.554259537      nube
995   1.871378942  3.412270628      nube
996   1.926933600  3.524015211      nube
997  -0.276208055 -2.573360810      nube
998  -1.048563415 -4.423459810      nube
999   1.466123426  4.103568831      nube
1000  0.722681202 -0.650209618      nube
1001  0.712790243  8.332080883     extra</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">dists_maha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mahalanobis</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.matrix</span>(df_dists), </span>
<span id="cb10-2">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colMeans</span>(df[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]), </span>
<span id="cb10-3">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cov</span>(df[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>)]))</span>
<span id="cb10-4">dists_maha</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       87       762      1001 
 9.751899  7.537031 45.360449 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sqrt(dists_maha[1] + dists_maha[2])</span></span></code></pre></div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2024-03-31-mahalanobis/</guid>
  <pubDate>Sun, 31 Mar 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Relaciones espurias</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2024-03-18-correlation/</link>
  <description><![CDATA[ 





<p>Tienes un datos de divorcio en estados de Estados Unidos (<a href="https://xcelab.net/rm/statistical-rethinking/">fuente</a>).</p>
<p>Parece que hay correlación entre el ratio de divorcio por estado y la edad mediana a la que se casa la gente:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>())</span>
<span id="cb1-4"></span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(d, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> MedianAgeMarriage, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> Divorce)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_smooth</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">method =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lm"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-03-18-correlation/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>El ratio de divorcio por estado dada la mediana de edad de casarse podrías modelizarlo como:</p>
<p><img src="https://latex.codecogs.com/png.latex?%0AD_i%20%5Csim%20%5Ctext%7BNormal%7D(%5Cmu_i,%20%5Csigma)%0A%5C%5C%0A%5Cmu_i%20=%20%5Calpha%20+%20%5Cbeta_AA_i%0A%5C%5C%0A%5Calpha%20%5Csim%20%5Ctext%7BNormal(0,%200,2)%7D%0A%5C%5C%0A%5Cbeta_A%20%5Csim%20%5Ctext%7BNormal(0,%200,5)%7D%0A%5C%5C%0A%5Csigma%20%5Csim%20%5Ctext%7BExponential(1)%7D%0A"></p>
<ul>
<li><img src="https://latex.codecogs.com/png.latex?D_i"> el ratio de divorcio estandarizado (media 0, desviación típica 1) para el Estado <img src="https://latex.codecogs.com/png.latex?i">.</li>
<li><img src="https://latex.codecogs.com/png.latex?A_i"> es la edad mediana a la que se casa la gente en el Estado <img src="https://latex.codecogs.com/png.latex?i">.</li>
<li>Como el ratio que modelizamos está centrado en 0, el intercept del modelo es esperable que sea cercano a 0.</li>
<li>Sobre <img src="https://latex.codecogs.com/png.latex?%5Cbeta_A">, si fuera igual a 1, estaríamos diciendo que por cada cambio de una desviación estándar de la edad, observaríamos un cambio de una desviación estándar en el ratio del divorcio. La desviación estándar de la edad es 1.2436303, por lo que si <img src="https://latex.codecogs.com/png.latex?%5Cbeta_A%20=%201">, un cambio de <img src="https://latex.codecogs.com/png.latex?%7B1,2%7D"> años en la mediana de edad de casarse aumentaría el ratio de divorcio en una desviación estándar, lo que parece ser demasiado fuerte.</li>
</ul>
<p>Ahora podemos ajustar el modelo y simular:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">m5<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span> <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quap</span>(</span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alist</span>(</span>
<span id="cb2-3">    D <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(mu, sigma), </span>
<span id="cb2-4">    mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> A, </span>
<span id="cb2-5">    a <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2</span>), </span>
<span id="cb2-6">    bA <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>), </span>
<span id="cb2-7">    sigma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dexp</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-8">  ), </span>
<span id="cb2-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> d</span>
<span id="cb2-10">)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb3-2">prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract.prior</span>(m5<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span>)</span>
<span id="cb3-3">mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">link</span>( m5<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span> , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">post=</span>prior , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>( <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) ) )</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>( <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span> , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylim=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) )</span>
<span id="cb3-5"><span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">for</span> ( i <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> ) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>( <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) , mu[i,] , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">col.alpha</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.4</span>) )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-03-18-correlation/index_files/figure-html/extract-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>



 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2024-03-18-correlation/</guid>
  <pubDate>Mon, 18 Mar 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>¿Cómo surge la distribución normal?</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2024-02-24-normality/</link>
  <description><![CDATA[ 





<p>La distribución normal siempre me ha parecido demasiado perfecta para esperar verla en unos datos reales.</p>
<p>Pero claro, eso me pasa por no saber de dónde viene.</p>
<p>Te cuento.</p>
<p>Imagina un grupo de personas que parten de una línea. Cada uno lanza una moneda al aire; si sale cara, da un paso a la izquierda, de máximo 1 metro; si no, lo da a la derecha. Los pasos estarán entre 0 y 1 metro. Al cabo de 16 lanzamientos, ¿a qué distancia estará del origen?</p>
<p>Será la suma de las distancias de esos pasos.</p>
<p>Podemos calcular esto para 1000 personas.</p>
<p>Primero si dan 4 pasos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(pos)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/pasos4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora si dan 8 pasos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(pos)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/pasos8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora si dan 16:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb3-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(pos)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/pasos16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Realmente, casi con cualquier distribución puedes hacer esto. La suma de valores de cualquier distribución seguirá una distribución normal (con algunas necesitarás una muestra más grande que con otras).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rpois</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/suma-pois-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="ejemplo-de-modelo-basado-en-la-normalidad" class="level2">
<h2 class="anchored" data-anchor-id="ejemplo-de-modelo-basado-en-la-normalidad">Ejemplo de modelo basado en la normalidad</h2>
<p>La altura de varias personas adultas es esperable que se distribuya como una distribución normal.</p>
<p>La idea intuitiva es que la altura de una persona adulta es el resultado de muchos pequeños aumentos que se suman. Para distintos individuos, estas sumas darán resultados distintos, porque los aumentos progresivos entre ellos serán distintos al cabo de los años. Pero el conjunto de todas ellas será normal, si has esperado suficientes años para que los casos más altos (aumentos más grandes acumulados) se compensen con los más bajos (aumentos más pequeños).</p>
<p>Vamos a trabajar con una muestra de personas, de las que conocemos su altura.</p>
<p>Queremos modelizar la altura como una distribución normal, o sea, estimaremos la media y desviación típica.</p>
<p>El método bayesiano considerará todas las medias y desviaciones típicas posibles (realmente haremos una aproximación), y evaluaremos cada una en función de cómo de plausibles son, dados los datos que tenemos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rethinking)</span>
<span id="cb5-2"></span>
<span id="cb5-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data</span>(Howell1)</span>
<span id="cb5-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">head</span>(Howell1)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   height   weight age male
1 151.765 47.82561  63    1
2 139.700 36.48581  63    0
3 136.525 31.86484  65    0
4 156.845 53.04191  41    1
5 145.415 41.27687  51    0
6 163.830 62.99259  35    1</code></pre>
</div>
</div>
<p>Por ahora, vamos a centrarnos solo en los casos adultos, porque la altura de los niños no se distribuye normalmente, sino que está correlada con la edad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">adultos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> Howell1[Howell1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>age <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>, ]</span>
<span id="cb7-2"></span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(adultos<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>height, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Queremos modelizar la altura <img src="https://latex.codecogs.com/png.latex?h_i"> de cada individuo <img src="https://latex.codecogs.com/png.latex?i"> como <img src="https://latex.codecogs.com/png.latex?h_i%20%5Csim%20%5Ccal%7BN%7D(%5Cmu,%20%5Csigma)">. <strong>El objetivo es estimar</strong> <img src="https://latex.codecogs.com/png.latex?%5Cmu"> y <img src="https://latex.codecogs.com/png.latex?%5Csigma">.</p>
<p>Como estamos en un modelo bayesiano, necesitamos unos prioris para ambos parámetros. Los prioris son distribuciones de estos parámetros que consideramos razonables.</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Ah_i%20%5Csim%20%5Ccal%7BN%7D(%5Cmu,%20%5Csigma)%0A%5C%5C%0A%5Cmu%20%5Csim%20%5Ccal%7BN%7D(178,%2020)%0A%5C%5C%0A%5Csigma%20%5Csim%20%5Ccal%7BU%7D(0,%2050)%0A"></p>
<p>Estamos dando como distribución a priori de la media una normal centrada en <img src="https://latex.codecogs.com/png.latex?%5Ccal%7B178%7D"> y con un rango de <img src="https://latex.codecogs.com/png.latex?%5Ccal%7B40%7D">cm con una probablidad de 95%.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">curve</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>(x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lwd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/howell1-priori-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La priori sobre la desviación típica es plana, en el sentido de que no sabemos dar más importancia a unos valores frente a otros, dentro los propuestos en el intervalo de la uniforme.</p>
<p>Podemos simular cómo serían unos datos a partir de estas prioris.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">sample_mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb9-2">sample_sigma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb9-3"></span>
<span id="cb9-4">prior_h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, sample_mu, sample_sigma)</span>
<span id="cb9-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dens</span>(prior_h, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/simulacion-prioris-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Lo que hemos hecho es simular 10.000 pares de <img src="https://latex.codecogs.com/png.latex?%5Cmu"> y <img src="https://latex.codecogs.com/png.latex?%5Csigma"> y para cada par hemos simulado una altura. Así tenemos 10.000 alturas, cada una originada a partir de una población normal distinta (pero todas las poblaciones normales son tan plausibles como indica nuestra priori).</p>
<p>Si cambiáramos la priori, la simulación a priori de la altura se vería afectada:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">sample_mu <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb10-2"></span>
<span id="cb10-3">prior_h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>, sample_mu, sample_sigma)</span>
<span id="cb10-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dens</span>(prior_h, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/simulacion-prioris2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esa es una priori menos informativa, con una media mucho más dispersa. Pero puedes ver que las alturas que derivarían de unas prioris así no son realistas, dado que hay casos de altura negativa o también demasiado altos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">fit_altura <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">quap</span>( </span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">alist</span>(</span>
<span id="cb11-3">    height <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>( mu , sigma ) ,</span>
<span id="cb11-4">    mu <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dnorm</span>( <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">178</span> , <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span> ) ,</span>
<span id="cb11-5">    sigma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dunif</span>( <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> , <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> )</span>
<span id="cb11-6">  ), </span>
<span id="cb11-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> adultos</span>
<span id="cb11-8">)</span>
<span id="cb11-9"></span>
<span id="cb11-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">precis</span>(fit_altura)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           mean        sd       5.5%      94.5%
mu    154.65453 0.4172154 153.987737 155.321319
sigma   7.76233 0.2950801   7.290735   8.233925</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">posterior_h <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">extract.samples</span>(fit_altura, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e4</span>)</span>
<span id="cb13-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(posterior_h<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>mu, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-02-24-normality/index_files/figure-html/altura-posteriori-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2024-02-24-normality/</guid>
  <pubDate>Sat, 24 Feb 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Statistical Rethinking (2)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2024-01-24-rethinking-2/</link>
  <description><![CDATA[ 





<section id="por-qué-lo-normal-es-normal" class="level2">
<h2 class="anchored" data-anchor-id="por-qué-lo-normal-es-normal">Por qué lo normal es normal</h2>
<section id="normal-por-adición" class="level3">
<h3 class="anchored" data-anchor-id="normal-por-adición">Normal por adición</h3>
<p>Hay un experimento en el que pones a unas personas en línea con una moneda. Cada persona tiene una moneda que lanza 16 veces.</p>
<p>Por cada vez que sale cara, da un paso a la derecha; por cada vez que sale cruz, a la izquierda.</p>
<p>Cada paso será de una distancia aleatoria entre 0 y 1 metro. ¿Cuántos metros se ha desplazado cada persona con respecto al origen?</p>
<p>El experimento con una sola persona sería algo así:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">distancia_por_paso <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(distancia_por_paso)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.171815</code></pre>
</div>
</div>
<p>Nuestro sujeto ha recorrido 2.1718148 desde la línea.</p>
<p>Lo podemos extrapolar a 10000 sujetos:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">pos <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)))</span>
<span id="cb3-2"></span>
<span id="cb3-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb3-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_minimal</span>())</span>
<span id="cb3-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_histogram</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> pos), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2024-01-24-rethinking-2/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2024-01-24-rethinking-2/</guid>
  <pubDate>Wed, 24 Jan 2024 00:00:00 GMT</pubDate>
</item>
<item>
  <title>¿Cómo se usan las prioris conjugadas?</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-31-conjugate-prior/</link>
  <description><![CDATA[ 





<p>En estadística bayesiana, cuando buscas estimar un parámetro, lo que vas a obtener es una distribución de este parámetro. O sea, no obtienes un valor preciso, sino unas probabilidades asociadas a varios valores, de forma que algunos serán más probables que otros.</p>
<p>Un método intuitivo de conseguir esta distribución es usar el método del mallado ( <em>grid approximation</em> ). Con este método, relacionas todos los casos posibles, calculas una verosimilitud para cada caso, y lo multiplicas por una probabilidad a priori que decidas. Ese producto es la distribución que buscas para tu parámetro, la posteriori.</p>
<p>En algunas situaciones, usar una priori en concreto te puede simplificar luego el cálculo, ya que no te hará falta aplicar los cálculos del mallado: puedes, pero el resultado será el mismo.</p>
<section id="prioris-conjugados" class="level2">
<h2 class="anchored" data-anchor-id="prioris-conjugados">Prioris conjugados</h2>
<p>En el caso de lanzar una moneda, estás trabajando con una binomial: tienes ciertos éxitos ante un número posible de casos.</p>
<p>Si en este caso, usas como priori la distribución beta, entonces surgirá la magia.</p>
<p>La distribución es</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">monedas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-2">caras <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, monedas, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-3">p_cara <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.01</span>)</span>
<span id="cb1-4">sample_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-5"></span>
<span id="cb1-6">beta_alpha <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-7">beta_beta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hist</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbeta</span>(sample_size, beta_alpha, beta_beta), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#800080"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-31-conjugate-prior/index_files/figure-html/setup-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.data.frame</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand.grid</span>(caras, p_cara))</span>
<span id="cb2-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">names</span>(df) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"caras"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"p_cara"</span>)</span></code></pre></div>
</div>
<p>Y podemos simular la posteriori con el método del mallado:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbeta</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara, beta_alpha, beta_beta)</span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df$prior &lt;- dunif(df$p_cara)</span></span>
<span id="cb3-3"></span>
<span id="cb3-4">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbinom</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras, monedas, df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara)</span>
<span id="cb3-5"></span>
<span id="cb3-6">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>likelihood <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior</span>
<span id="cb3-7">df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>std_posteriori <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori)</span>
<span id="cb3-8"></span>
<span id="cb3-9"></span>
<span id="cb3-10">caras_observadas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span></span>
<span id="cb3-11"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb3-12">     df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas]), </span>
<span id="cb3-13">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"o"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilidad de cara"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilidad"</span>)</span>
<span id="cb3-14"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb3-15">      df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas]), </span>
<span id="cb3-16">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-31-conjugate-prior/index_files/figure-html/posterior1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La magia está en que, dado que la distribución a priori es una beta, no necesitamos simular la posteriori, sino que sabemos que ya seguirá una distribución en concreto (una beta también, con pequeños cambios en sus parámetros);</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">posteriori_simulation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbeta</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb4-2">                               beta_alpha <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> caras_observadas, </span>
<span id="cb4-3">                               beta_beta <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> monedas <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> caras_observadas)</span>
<span id="cb4-4"></span>
<span id="cb4-5">posteriori_simulation <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> posteriori_simulation <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(posteriori_simulation)</span>
<span id="cb4-6"></span>
<span id="cb4-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb4-8">     df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>posteriori[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas]), </span>
<span id="cb4-9">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"o"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilidad de cara"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabilidad"</span>)</span>
<span id="cb4-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb4-11">      df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>prior[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas]), </span>
<span id="cb4-12">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>)</span>
<span id="cb4-13"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lines</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p_cara[df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>caras <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> caras_observadas], </span>
<span id="cb4-14">      posteriori_simulation, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-31-conjugate-prior/index_files/figure-html/posteriori-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-31-conjugate-prior/</guid>
  <pubDate>Sun, 31 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Statistical Rethinking (1)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-27-rethinking-1/</link>
  <description><![CDATA[ 





<p>En <a href="https://xcelab.net/rm/statistical-rethinking/">Statistical Rethinking</a> Richard McEalreath presenta los métodos generativos en estadística bayesiana.</p>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>El problema que plantea es el de estimar la proporción de agua que hay en la Tierra.</p>
<p>El procedimiento consiste en mirar en varios puntos de la Tierra y ver si hay agua o tierra. De esa forma obtienes una secuencia de valores: <code>"A", "A", "T", "A", "T", ...</code> y usas esos datos para estimar la proporción real.</p>
<p>Concretamente, en 9 observaciones has obtenido 6 porciones de agua.</p>
<p>Hay tres formas de ajustar un modelo estadístico. Las ejemplificaremos con ese problema de la proporción de agua.</p>
<p>Los códigos serán los del libro.</p>
</section>
<section id="mallado" class="level2">
<h2 class="anchored" data-anchor-id="mallado">Mallado</h2>
<p>La primera forma de ajustar un modelo estadístico es mediante mallado. Computacionalmente es costoso pero es más educativo que el resto de métodos.</p>
<p>Lo que vas a hacer es proponer unos posibles valores para el parámetro que buscas (la proporción de agua) y les das una distribución a priori a estos valores (no pasa nada ahora por que la distribución a priori no sume 1 porque luego estandarizarás el resultado final).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">grid_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define grid</span></span>
<span id="cb1-3">p_grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">from =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">to =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> grid_size)</span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># define prior</span></span>
<span id="cb1-5">prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> , grid_size)</span></code></pre></div>
</div>
<p>Tus priori (20 proporciones equiprobables) ya están definidas y ahora te sirven para generar posibles escenarios. La idea es ver la verosimilitud de tus datos observados ante los distintos posibles valores del parámetro.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbinom</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p_grid)</span>
<span id="cb2-2">likelihood</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.000000e+00 1.518149e-06 8.185093e-05 7.772923e-04 3.598575e-03
 [6] 1.116095e-02 2.668299e-02 5.292110e-02 9.082698e-02 1.383413e-01
[11] 1.897686e-01 2.361147e-01 2.666113e-01 2.714006e-01 2.450051e-01
[16] 1.897686e-01 1.179181e-01 5.026670e-02 8.853845e-03 0.000000e+00</code></pre>
</div>
</div>
<p>Ahora calculas la posteriori, ponderando estas verosimilitudes por los prioris que tenías antes. Como los prioris no seguían una distribución de probabilidad, te toca estandarizar el resultado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">unstd_posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> likelihood <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> prior</span>
<span id="cb4-2">posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> unstd_posterior <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(unstd_posterior)</span>
<span id="cb4-3">posterior</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.000000e+00 7.989837e-07 4.307717e-05 4.090797e-04 1.893887e-03
 [6] 5.873873e-03 1.404294e-02 2.785174e-02 4.780115e-02 7.280739e-02
[11] 9.987296e-02 1.242643e-01 1.403143e-01 1.428349e-01 1.289433e-01
[16] 9.987296e-02 6.205890e-02 2.645477e-02 4.659673e-03 0.000000e+00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(p_grid, posterior, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>,</span>
<span id="cb6-2">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabidad de agua"</span> , </span>
<span id="cb6-3">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posteriori"</span>)</span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mtext</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"20 puntos"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-27-rethinking-1/index_files/figure-html/mallado-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ahora bien, ten en cuenta que <strong>los prioris forman parte del modelo</strong>. Deberías tener un criterio para elegir unos u otros.</p>
<p>Los puedes cambiar y los resultados se verán afectados.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">p_grid <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> grid_size)</span>
<span id="cb7-2">prior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">exp</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(p_grid <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>))</span>
<span id="cb7-3"></span>
<span id="cb7-4">likelihood <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dbinom</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> p_grid)</span>
<span id="cb7-5"></span>
<span id="cb7-6">unstd_posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span>  likelihood <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> prior</span>
<span id="cb7-7">posterior <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> unstd_posterior <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(unstd_posterior)</span>
<span id="cb7-8"></span>
<span id="cb7-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(p_grid, posterior, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"b"</span>,</span>
<span id="cb7-10">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xlab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Probabidad de agua"</span> , </span>
<span id="cb7-11">     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ylab =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Posteriori"</span>)</span>
<span id="cb7-12"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mtext</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%i puntos"</span>, grid_size))</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-27-rethinking-1/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-27-rethinking-1/</guid>
  <pubDate>Wed, 27 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Introducción a análisis de supervivencia con R</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-22-survival-analysis/</link>
  <description><![CDATA[ 





<p>El nombre del análisis de supervivencia apunta maneras. Inevitablemente, yo lo relaciono con la muerte, porque seguramente se originara para saber cuánto tiempo le quedaba de vida a un paciente con alguna enfermedad.</p>
<p>Pero no sirve solo para eso.</p>
<p>Algunos ejemplos de casos que puedes resolver con análisis de supervivencia son:</p>
<ul>
<li>¿Cuál es la probabilidad de que un paciente con cáncer de mama viva más de 5 años?</li>
<li>¿Cuál es el tiempo de espera típico cuando llamas a un taxi?</li>
<li>De 100 parados, ¿cuántos esperas que encuentren trabajo pasados 2 meses?</li>
</ul>
<section id="teoría-del-análisis-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="teoría-del-análisis-de-supervivencia">Teoría del análisis de supervivencia</h2>
<p>Los modelos de supervivencia buscan modelizar la función de supervivencia, dada por esta ecuación:</p>
<p><img src="https://latex.codecogs.com/png.latex?S(t)%20=%201%20-%20F(t)%20=%20P(T%20%3E%20t)"></p>
<p>Viene a interpretarse como <strong>la probabilidad de que la duración del experimento sea mayor de <img src="https://latex.codecogs.com/png.latex?t"></strong>. <img src="https://latex.codecogs.com/png.latex?F(t)"> representa la función de distribución del evento.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-22-survival-analysis/index_files/figure-html/surv-func-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Esa gráfica ya daría algo de información. Por ejemplo:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-22-survival-analysis/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Sabemos que la probabilidad de la probabilidad de superar el instante <img src="https://latex.codecogs.com/png.latex?t%20=%203"> es de 0,97.</li>
<li>Sabemos que el tercer cuartil es 5,65.</li>
</ul>
<p><strong>El objetivo del análisis de supervivencia es estimar esta función de supervivencia.</strong></p>
</section>
<section id="el-método-keplen-meier-para-estimar-la-función-de-supervivencia" class="level2">
<h2 class="anchored" data-anchor-id="el-método-keplen-meier-para-estimar-la-función-de-supervivencia">El método Keplen-Meier para estimar la función de supervivencia</h2>
<p>La fórmula que usa este método para estimar la función de supervivencia en <img src="https://latex.codecogs.com/png.latex?t"> es:</p>
<p><img src="https://latex.codecogs.com/png.latex?S(t)%20=%20%5Cprod_%7Bi:%20t_i%5Cleq%20t%7D%5Cfrac%7Bn_i%20-%20d_i%7D%7Bn_i%7D"></p>
<p>donde <img src="https://latex.codecogs.com/png.latex?t_i"> representa a cada uno de los instantes anteriores al instante <img src="https://latex.codecogs.com/png.latex?t">, <img src="https://latex.codecogs.com/png.latex?n_i"> es el número de individuos en <img src="https://latex.codecogs.com/png.latex?t_i"> y <img src="https://latex.codecogs.com/png.latex?d_i"> es el número de defunciones en <img src="https://latex.codecogs.com/png.latex?t_i">.</p>
<p>Lo podemos ver mejor con numeritos y este gráfico:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-22-survival-analysis/index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(t)%20=%20%20%5Cprod_%7Bi:%20t_i%5Cleq%20t%7D%5Cfrac%7Bn_i%20-%20d_i%7D%7Bn_i%7D%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(2)%20=%20%5Cfrac%7B5-0%7D%7B5%7D%20=%20%5Cfrac%7B5%7D%7B5%7D%20=%201%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(3)%20=%20%5Cfrac%7B4-0%7D%7B4%7D%20=%20%5Cfrac%7B4%7D%7B4%7D%20=%201%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(4)%20=%20%5Cfrac%7B4-2%7D%7B4%7D%20=%20%5Cfrac%7B2%7D%7B4%7D%20=%200,5%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(5)%20=%20%5Cfrac%7B1%7D%7B2%7D%20%5Ccdot%20%5Cfrac%7B2-1%7D%7B2%7D%20=%20%5Cfrac%7B1%7D%7B4%7D%20=%200,25%20%5C%5C%0A"> <img src="https://latex.codecogs.com/png.latex?%0A%5Chat%7BS%7D(6)%20=%20%5Cfrac%7B1%7D%7B4%7D%20%5Ccdot%20%5Cfrac%7B1-0%7D%7B1%7D%20=%20%5Cfrac%7B1%7D%7B4%7D%20=%200,25%0A"></p>
<p>Aunque después de avanzar un poco con el curso, me entero de que Keplen-Meier se usa principalmente con fines descritivos.</p>
</section>
<section id="método-weibull" class="level2">
<h2 class="anchored" data-anchor-id="método-weibull">Método Weibull</h2>
<p>Un método que sí se usa para estimar la curva es el de Weibull. Sinceramente, <strong>ni idea de cómo funciona.</strong></p>
<p>Pero una forma directa de ajustar y visualizarlo es esta (para visualizar simplifica mucho si usas la librería <strong>survminer</strong>):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(survival)</span>
<span id="cb1-2">wb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">survreg</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Surv</span>(time, status) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, lung)</span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Retrieve survival curve from model</span></span>
<span id="cb1-4">surv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">99</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>)</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get time for each probability</span></span>
<span id="cb1-7">t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">predict</span>(wb, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"quantile"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> surv, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">newdata =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb1-8"></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create data frame with the information needed for ggsurvplot_df</span></span>
<span id="cb1-10">surv_wb <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">time =</span> t, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">surv =</span> surv, </span>
<span id="cb1-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">upper =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lower =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">std.err =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>)</span>
<span id="cb1-12"></span>
<span id="cb1-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plot</span></span>
<span id="cb1-14"></span>
<span id="cb1-15">survminer<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsurvplot_df</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fit =</span> surv_wb, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">surv.geom =</span> ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>geom_line)</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-12-22-survival-analysis/index_files/figure-html/weibull-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-22-survival-analysis/</guid>
  <pubDate>Fri, 22 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Comparativa pequeña entre tidyverse y R base</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-07-tidyverse-rbase/</link>
  <description><![CDATA[ 





<p>Me gusta leer <a href="https://github.com/matloff/TidyverseSkeptic">críticas contra tidyverse</a>. ¿Porque lo odio?</p>
<p>No, lo uso todo el rato. Todos los días. Mi trabajo se basa en <a href="https://www.tidyverse.org/">el tidyverse</a>.</p>
<p>¿Por qué leo críticas entonces?</p>
<p>Porque no entiendo que las haya. Así que me obligo a leer otros puntos de vista para ver en qué estoy equivocado.</p>
<p>Por ahora, gano yo. El link que publico al principio no es convincente. Un día le responderé al autor. Mientras tanto, estudio R base.</p>
<p>Me parece entretenido. Incluso bonito.</p>
<p>Y bromas aparte, le reconozco una cosa: <strong>me quita toda la gestión de dependencias.</strong> Cuando ejecuto este blog en GitHub Actions o cuando creo una librería, quitar dependencias simplifica mucho el trabajo y el proceso.</p>
<p>Eso sí me gusta de R base.</p>
<p>Pero para el día a día es un infierno.</p>
<p>Así que se me ha ocurrido hacerme un diccionario de R base y tidyverse, de cosas que consulto a veces.</p>
<p>Es un mini diccionario: faltarán muchas cosas aquí que te harán falta. Pero aquí encontrarás algunas que quizá te hagan falta. Y oye, si es así, tu búsqueda ha terminado.</p>
<section id="conversión-r-base---tidyverse" class="level2">
<h2 class="anchored" data-anchor-id="conversión-r-base---tidyverse">Conversión R base - Tidyverse</h2>
<p>Para simplificar dependencias trabajaré, por supuesto, con <code>iris</code>.</p>
<table class="table">
<caption>Comparativa R base - Tidyverse</caption>
<colgroup>
<col style="width: 39%">
<col style="width: 18%">
<col style="width: 41%">
</colgroup>
<tbody>
<tr class="odd">
<td><strong>Operación</strong></td>
<td><strong>Tidyverse</strong></td>
<td><strong>R base</strong></td>
</tr>
<tr class="even">
<td>Calcula la media de una métrica por grupo.</td>
<td><p><code>iris |&gt;</code></p>
<p><code>group_by(Species) |&gt;</code></p>
<p><code>summarise(mean(Sepal.Length))</code></p></td>
<td><p><code>aggregate(</code></p>
<p><code>Sepal.Length ~ Species,</code></p>
<p><code>iris,</code></p>
<p><code>mean)</code></p></td>
</tr>
<tr class="odd">
<td>Extrae los números de un texto (aplica a cualquer patrón, como DNI, razón social, etc).</td>
<td><p><code>str_extract(</code></p>
<p><code>"cosa123cosa",</code></p>
<p><code>"\\d+")</code></p></td>
<td><p><code>regmatches(</code></p>
<p><code>"cosa123cosa",</code></p>
<p><code>m = regexpr("\\d+", "cosa123cosa", perl = TRUE))</code></p></td>
</tr>
<tr class="even">
<td>Quédate con las observaciones cuyo valor (en una métrica) sea mayor que la media de su grupo.</td>
<td><p><code>iris |&gt;</code></p>
<p><code>group_by(Species) |&gt;</code></p>
<p><code>filter(Sepal.Lengh &gt;= mean(Sepal.Length))</code></p></td>
<td><p><code>do.call("rbind",</code></p>
<p><code>lapply(split(iris, iris$Species),</code></p>
<p><code>function(df) {               subset(df, Sepal.Length &gt;= mean(df$Sepal.Length)) }))</code></p></td>
</tr>
<tr class="odd">
<td>(*) Pasa de formato ancho a formato largo - Transformación <em>melt</em> - Pasa métricas a filas</td>
<td><p><code>iris |&gt;</code></p>
<p><code>pivot_longer(-Species)</code></p></td>
<td><p><code>iris$id &lt;- 1:nrow(iris)</code><br>
<code>reshape(iris,</code></p>
<p><code>idvar="id",</code></p>
<p><code>direction="long",          varying=list(1:4),         v.names = "value",         timevar="metric")</code></p></td>
</tr>
</tbody>
</table>
<p>En la 4ª he puesto un asterisco porque está mal. No soy capaz de hacer eso en R base de una manera razonablemente cómoda para mí.</p>
<p>Pero yo lo sigo intentando.</p>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-07-tidyverse-rbase/</guid>
  <pubDate>Thu, 07 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Advent of code (2)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-05-adventofcode-ii/</link>
  <description><![CDATA[ 





<p>Segundo ejercicio de <a href="https://adventofcode.com/">Advent of Code</a> de 2023. Voy con retraso, lo sé.</p>
<section id="parte-1" class="level2">
<h2 class="anchored" data-anchor-id="parte-1">Parte 1</h2>
<p>Mi propuesta con R base:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">total_cubes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">red =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">green =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">13</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">blue =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>)</span>
<span id="cb1-2">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readLines</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-02.txt"</span>)</span>
<span id="cb1-3"></span>
<span id="cb1-4">data[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Game 1: 12 red, 2 green, 5 blue; 9 red, 6 green, 4 blue; 10 red, 2 green, 5 blue; 8 blue, 9 red"
[2] "Game 2: 3 green, 7 red; 3 blue, 5 red; 2 green, 1 blue, 6 red; 3 green, 2 red, 3 blue"          
[3] "Game 3: 12 red, 18 blue, 3 green; 14 red, 4 blue, 2 green; 4 green, 15 red"                     
[4] "Game 4: 14 blue, 8 red, 10 green; 7 green, 9 blue, 4 red; 4 green, 5 red"                       
[5] "Game 5: 2 red, 1 blue, 4 green; 1 blue, 1 red, 5 green; 6 green, 3 red; 10 blue, 4 green, 1 red"</code></pre>
</div>
</div>
<p>Para cada juego (o sea, cada elemento en <code>data</code>) tengo que comprobar si las extracciones son posibles dada la cantidad de cubos original mencionada: 12 rojos, 13 verdes y 14 azules.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">validate_game <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(fila, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.total_cubes =</span> total_cubes){</span>
<span id="cb3-2">  fila <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Game [0-9]+: "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fila)</span>
<span id="cb3-3">  fila <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fila)</span>
<span id="cb3-4">  </span>
<span id="cb3-5">  is_valid_extract <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(fila, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">";"</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]], </span>
<span id="cb3-7">    validate_extract, </span>
<span id="cb3-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logical</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-9">  )</span>
<span id="cb3-10"> </span>
<span id="cb3-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(is_valid_extract)</span>
<span id="cb3-12"></span>
<span id="cb3-13">}</span>
<span id="cb3-14"></span>
<span id="cb3-15">validate_extract <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.total_cubes =</span> total_cubes) {</span>
<span id="cb3-16">  lgl_out <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>),</span>
<span id="cb3-18">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(color, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> x) {</span>
<span id="cb3-19">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Extract with regex the number preceding word blue</span></span>
<span id="cb3-20">      pattern <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]+(?=%s)"</span>, color)</span>
<span id="cb3-21">      count_txt <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regexpr</span>(pattern, text, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb3-22">      <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(count_txt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb3-23">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)</span>
<span id="cb3-24">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span>  {</span>
<span id="cb3-25">        count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(count_txt)</span>
<span id="cb3-26">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(count <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> total_cubes[[color]]  )</span>
<span id="cb3-27">      }</span>
<span id="cb3-28">      </span>
<span id="cb3-29">    }, </span>
<span id="cb3-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logical</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-31">  )</span>
<span id="cb3-32">  </span>
<span id="cb3-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">all</span>(lgl_out)</span>
<span id="cb3-34">}</span>
<span id="cb3-35"></span>
<span id="cb3-36">valid_games <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-37">  data, </span>
<span id="cb3-38">  validate_game, </span>
<span id="cb3-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">logical</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-40">)</span>
<span id="cb3-41"></span>
<span id="cb3-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Count IDs of valid games</span></span>
<span id="cb3-43"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(valid_games))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2600</code></pre>
</div>
</div>
</section>
<section id="parte-2" class="level2">
<h2 class="anchored" data-anchor-id="parte-2">Parte 2</h2>
<p>Debería poner los enunciados aquí… pero paso.</p>
<p>Mi propuesta para la parte 2, siempre con R base:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">compute_power_game <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(fila){</span>
<span id="cb5-2">  fila <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Game [0-9]+: "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fila)</span>
<span id="cb5-3">  fila <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">" "</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, fila)</span>
<span id="cb5-4">  </span>
<span id="cb5-5">  color_counts <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb5-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"blue"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"green"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"red"</span>),</span>
<span id="cb5-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(color) {</span>
<span id="cb5-8">      pattern <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]+(?=%s)"</span>, color)</span>
<span id="cb5-9">      color_count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(fila, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gregexpr</span>(pattern, fila, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]]</span>
<span id="cb5-10">      color_count <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(color_count)</span>
<span id="cb5-11">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(color_count)    </span>
<span id="cb5-12">    }, </span>
<span id="cb5-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-14">  )</span>
<span id="cb5-15">  </span>
<span id="cb5-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Reduce</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">*</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">`</span>, color_counts)</span>
<span id="cb5-17"></span>
<span id="cb5-18">}</span>
<span id="cb5-19"></span>
<span id="cb5-20">game_powers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb5-21">  data, </span>
<span id="cb5-22">  compute_power_game, </span>
<span id="cb5-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-24">)</span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># part 2 solution</span></span>
<span id="cb5-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(game_powers)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 86036</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-05-adventofcode-ii/</guid>
  <pubDate>Sat, 02 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Advent of code (1)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-12-01-adventofcode-i/</link>
  <description><![CDATA[ 





<p>Nunca he jugado con el <a href="https://adventofcode.com/">Advent of code</a>. Hoy me ha apetecido.</p>
<p>Para el ejercicio de hoy, me he empeñado <strong>en hacerlo en R base.</strong></p>
<section id="parte-1" class="level2">
<h2 class="anchored" data-anchor-id="parte-1">Parte 1</h2>
<p>El día 1 del <a href="https://adventofcode.com/2023">Advent of code 2023</a> nos pide que sumemos los números que aparecen en un texto.</p>
<p>El texto tiene una pinta así: <code>"four95qvkvveight5"</code>, y hay 1.000 como ese.</p>
<p>La idea es:</p>
<ul>
<li>tomar el primer dígito, 9,</li>
<li>y el último, 5</li>
<li>y concatenarlos: 95</li>
</ul>
<p>Así obtendrás 1000 números. La solución es la suma de esos 1.000 números.</p>
<p>Mi propuesta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">readLines</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2023-01.txt"</span>)</span>
<span id="cb1-2"></span>
<span id="cb1-3">get_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb1-4">  str_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[^0-9]"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, x)</span>
<span id="cb1-5">  len <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(str_number)</span>
<span id="cb1-6">  str_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(str_number, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">substr</span>(str_number, len, len))</span>
<span id="cb1-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(str_number))</span>
<span id="cb1-8">}</span>
<span id="cb1-9">numbers <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb1-10">  data, </span>
<span id="cb1-11">  get_number,</span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-13">)</span>
<span id="cb1-14"></span>
<span id="cb1-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(numbers)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55208</code></pre>
</div>
</div>
</section>
<section id="parte-2" class="level2">
<h2 class="anchored" data-anchor-id="parte-2">Parte 2</h2>
<p>Ahora hay un matiz. Fíjate de nuevo en el texto: <code>"four95qvkvveight5"</code>. Realmente, el primer número es <code>"four"</code>, o sea, 4. Lo que hay que hacer ahora es identificar el primer dígito y el último pero tanto si viene en número como en texto.</p>
<p>Luego igual, concatenarlos y sumarlos.</p>
<p>Mi propuesta:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># a character vector with the numbers from zero to nine in letters</span></span>
<span id="cb3-2">words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"zero"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"one"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"two"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"three"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"four"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"five"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"six"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"seven"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"eight"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"nine"</span>)</span>
<span id="cb3-3"></span>
<span id="cb3-4">split_words <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(words, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb3-5">words_inv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-6">  split_words, </span>
<span id="cb3-7">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(x[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>), </span>
<span id="cb3-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">character</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-9">)</span>
<span id="cb3-10"></span>
<span id="cb3-11">words_regex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-12">words_inv_regex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(words_inv, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-13"></span>
<span id="cb3-14">pattern <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]"</span>, words_regex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-15">pattern_inv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"[0-9]"</span>, words_inv_regex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sep =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"|"</span>)</span>
<span id="cb3-16"></span>
<span id="cb3-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Change the order of a text</span></span>
<span id="cb3-18">invert <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x) {</span>
<span id="cb3-19">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb3-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(x)</span>
<span id="cb3-21">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb3-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strsplit</span>(x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)[[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(x)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">collapse =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) )</span>
<span id="cb3-23">  }</span>
<span id="cb3-24">}</span>
<span id="cb3-25"></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert a text to a number, based on the words and words_inv vectors</span></span>
<span id="cb3-27">to_numeric <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words_inv =</span> words_inv) {</span>
<span id="cb3-28">  <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nchar</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb3-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(x))</span>
<span id="cb3-30">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">if</span> (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> words) {</span>
<span id="cb3-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(words <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-32">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">else</span> {</span>
<span id="cb3-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">which</span>(words_inv <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-34">  }</span>
<span id="cb3-35">}</span>
<span id="cb3-36"></span>
<span id="cb3-37">get_number2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(x, </span>
<span id="cb3-38">                        pattern, </span>
<span id="cb3-39">                        pattern_inv,</span>
<span id="cb3-40">                        words, </span>
<span id="cb3-41">                        words_inv) {</span>
<span id="cb3-42">  </span>
<span id="cb3-43">  first <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regexpr</span>(pattern, x))</span>
<span id="cb3-44">  first <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_numeric</span>(first, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words_inv =</span> words_inv)</span>
<span id="cb3-45">  </span>
<span id="cb3-46">  x_inv <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">invert</span>(x)</span>
<span id="cb3-47">  last <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regmatches</span>(x_inv, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">regexpr</span>(pattern_inv, x_inv))</span>
<span id="cb3-48">  last <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">invert</span>(last)</span>
<span id="cb3-49">  last <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">to_numeric</span>(last, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> words, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words_inv =</span> words_inv)</span>
<span id="cb3-50">  </span>
<span id="cb3-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(first <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> last)</span>
<span id="cb3-52">  </span>
<span id="cb3-53">}</span>
<span id="cb3-54"></span>
<span id="cb3-55"></span>
<span id="cb3-56">numbers2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vapply</span>(</span>
<span id="cb3-57">  data, </span>
<span id="cb3-58">  get_number2,</span>
<span id="cb3-59">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern =</span> pattern,</span>
<span id="cb3-60">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">pattern_inv =</span> pattern_inv,</span>
<span id="cb3-61">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words =</span> words, </span>
<span id="cb3-62">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">words_inv =</span> words_inv,</span>
<span id="cb3-63">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">FUN.VALUE =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-64">)</span>
<span id="cb3-65"></span>
<span id="cb3-66"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sum</span>(numbers2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 54578</code></pre>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-12-01-adventofcode-i/</guid>
  <pubDate>Fri, 01 Dec 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>¿Qué formato de datos es más rápido de leer y escribir?</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-11-26-comparativa-tiempos-formatos-ficheros/</link>
  <description><![CDATA[ 





<p>He leído <a href="https://www.blog.dailydoseofds.com/p/the-most-overlooked-source-of-optimization">aquí</a> una comparativa entre tiempos de ejecución de lectura y escritura de varios tipos de ficheros de datos. Con Python.</p>
<p>Y he pensado:</p>
<blockquote class="blockquote">
<p>Lo voy a hacer yo con R.</p>
</blockquote>
<p>He creado dos data frames, a los que he llamado <code>df_numeric</code> y <code>df_mixed</code>. Ambos tienen un millón de filas y 20 columnas.</p>
<ul>
<li><code>df_numeric</code> tiene todas las columnas numéricas</li>
<li><code>df_mixed</code> tiene 10 columnas de tipo <code>character</code> y otras 10 de tipo <code>numeric</code>.</li>
</ul>
<p>Y lo que quiero es ver cuánto tardo en guardar cada uno en disco, en función del tipo de fichero y la función que elija.</p>
<section id="ficheros-con-columnas-numéricas" class="level2">
<h2 class="anchored" data-anchor-id="ficheros-con-columnas-numéricas">Ficheros con columnas numéricas</h2>
<p>Empiezo con el de todo numérico. Uso mi librería favorita, <code>microbenchmark</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">runtimes_numeric <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> microbenchmark<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">microbenchmark</span>(</span>
<span id="cb1-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">csv_utils =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write.csv</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_utils.csv"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>),</span>
<span id="cb1-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">csv_readr =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_csv</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_readr.csv"</span>),</span>
<span id="cb1-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fwrite =</span> data.table<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fwrite</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_fwrite.csv"</span>),</span>
<span id="cb1-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rds_base =</span> base<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">saveRDS</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_base.rds"</span>),</span>
<span id="cb1-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">rds_readr =</span> readr<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_rds</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric_readr.rds"</span>),</span>
<span id="cb1-7">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parquet =</span> arrow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_parquet</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric.parquet"</span>),</span>
<span id="cb1-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">feather =</span> arrow<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">write_feather</span>(df_numeric, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric.feather"</span>),</span>
<span id="cb1-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">times =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>L</span>
<span id="cb1-10">)</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Unit: milliseconds
      expr         min         lq       mean     median         uq        max
 csv_utils 202203.9288 266623.082 282231.496 281121.287 302487.454 331668.044
 csv_readr   9055.3445   9846.454  20284.347  10764.766  12634.343 104354.622
    fwrite   1610.8502   8701.182   8911.451   9409.666  10717.019  11205.837
  rds_base  25460.8486  26287.225  29357.257  28765.523  32329.897  35358.147
 rds_readr    330.9374   3041.022   3080.719   3132.418   3334.561   5672.141
   parquet   3234.5500   8282.600   9649.330   9843.929  12261.475  12863.989
   feather    410.0282   4370.313   4700.664   4539.408   5586.161   7597.147
 neval
    10
    10
    10
    10
    10
    10
    10</code></pre>
</div>
</div>
<p>Voy a visualizar esto (se puede hacer directamente sobre la salida de la función <code>microbenchmark()</code> pero lo paso a data frame porque he querido hacer algunas pruebas con las que necesitaba más control, aunque al final no las muestro aquí porque no aportan nada).</p>
<p>Creo dos data frames para pintar los tiempos de cómputo y el tamaño de los ficheros. Los tiempos (milisegundos) vienen dados para ejecución: aquí están los primeros casos.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       case       time
1   feather   410.0282
2    fwrite  1610.8502
3 rds_readr   330.9374
4   parquet  3234.5500
5  rds_base 27254.9053
6   feather  4436.2614
7   feather  7597.1466</code></pre>
</div>
</div>
<p>Tomo también el tamaño de los ficheros generados:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>       size      case
1 106522192  rds_base
2 359999269    fwrite
3 385418847 csv_readr
4 160000514 rds_readr
5 359998865 csv_utils
6 133286834   feather
7 143632169   parquet</code></pre>
</div>
</div>
<p>Creo los gráficos por separado aunque se puede visualizar todo junto (pero me parece ganas de complicar).</p>
<p>Estos son los tiempos de cómputo (quito <code>utils::write.csv()</code> porque ya sabemos que tarda mucho).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-11-26-comparativa-tiempos-formatos-ficheros/index_files/figure-html/plot-numeric-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-11-26-comparativa-tiempos-formatos-ficheros/</guid>
  <pubDate>Sun, 26 Nov 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Cómo interpretas un intervalo de confianza</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-11-05-confianza/</link>
  <description><![CDATA[ 





<p>Creo que no entendí qué eran los intervalos de confianza en ninguna clase de estadística.</p>
<p>A ver, no digo que no me los explicaran.</p>
<p>Digo que, pese a que me los explicaron, no entendí nada de ellos.</p>
<p>En el mundo laboral me encuentro con dos situaciones contradictorias:</p>
<ul>
<li>Hay personas que defienden que todas las estimaciones que se dan deberían incluir los intervalos de confianza.</li>
<li>Pero hay personas, normalmente los consumidores o clientes de esas estimaciones, que no tienen ni idea de qué es un intervalo de confianza.</li>
</ul>
<p>Y no digo que sea culpa suya.</p>
<p>La verdad, con lo complicado que es el concepto (porque no tiene ni pies ni cabeza) y lo mal que lo dan, normal que no se enteren.</p>
<p>¿Se deberían dar los intervalos de confianza? Pues dado que algo de la incertidumbre de tus estimaciones deberías dar, mientras no tengas nada mejor, sí, deberías darlos.</p>
<p>Te muestro aquí un ejemplo de <strong>cómo se interpretan.</strong></p>
<section id="cálculo-del-intervalo" class="level2">
<h2 class="anchored" data-anchor-id="cálculo-del-intervalo">Cálculo del intervalo</h2>
<p>Voy a usar un ejemplo muy concreto.</p>
<p>¿Significa eso que lo que te voy a explicar solo sirve para este ejemplo?</p>
<p>No, es extrapolable. Pero necesito un ejemplo concreto porque si no, pasa lo de siempre: que nadie se entera de nada.</p>
<p>El ejemplo es <strong>estimar la media de una población a partir de la media de una muestra.</strong> Parece una bobada, lo sé, pero verás en breve que hay cierta incertidumbre al usar la media muestral para esto.</p>
<p>Con esto no digo que no uses la media muestral. Lo que digo es que seas consciente de que hay cierta incertidumbre.</p>
<p>Para jugar con esta incertidumbre, voy a recrear un ejemplo del que conozco la media poblacional, y veremos qué tal se comporta la media muestra.</p>
<p>Uso una población de distribución <strong>normal de media 1000 y desviación típica 100</strong>. ¿Lo puedes hacer con otros números? Sí, claro. Ya te he dicho que esto es extrapolable a cualquier cosa de estimación.</p>
<p>Voy a tomar una muestra de tamaño 100 de esta población. Y calculo la media y desviación típica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3718</span>)</span>
<span id="cb1-2">sample_size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-3">population_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb1-4">population_sd <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb1-5"></span>
<span id="cb1-6">norm_values <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(sample_size, population_mean, population_sd)</span>
<span id="cb1-7"></span>
<span id="cb1-8">sample_mean <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(norm_values)</span></code></pre></div>
</div>
<p>La media muestral es 1007.718297.</p>
<p>El objetivo de estos párrafos es calcular el intervalo de confianza para esa estimación, o sea, a la hora de usar la media muestral como estimación de la media poblacional.</p>
<p>Para ello necesitamos la media y <strong>desviación típica poblacional</strong>[^1] (las tenemos), el tamaño muestral (me lo he inventado yo, 100).</p>
<p>[^1 Si no tienes la poblacional y usas una muestral necesitas hacer un ajuste en lo que voy a contar hoy. Te lo cuento otro día.]</p>
<p>Y necesitamos también los valores de la distribución normal que delimitan la confianza al nivel que queramos (95% para no salir de lo habitual). En R lo puedes calcular con <code>qnorm(0.975)</code> y <code>qnorm(0.025)</code>.</p>
<p>El intervalo estará centrado en tu media muestral. Las cotas vendrán dadas por un margen de error.</p>
<p>Este margen de error se calcula con:</p>
<ul>
<li>La desviación típica <strong>poblacional.</strong></li>
<li>La raíz cuadrada del tamaño muestral.</li>
<li>Un valor que ahora te explico.</li>
</ul>
<p>La desviación típica de la muestra dividida por la raíz cuadrada del tamaño muestral no es un valor cualquiera. Es <strong>la desviación típica de la media muestral.</strong></p>
<p>O sea, tienes una población, y tomas una muestra; con esa muestra te calculas la media y te la guardas. Ahora tomas otra muestra, vuelves a calcular la media y te la guardas. Y así muchas veces. Todas estas medias no serán iguales entre sí: serán parecidas, y deberían estar cerca de la media poblacional, pero varían. Varían con una desviación típica. ¿Cuál? Ese valor que hemos dicho.</p>
<p>Mira.</p>
<p>Voy a calcular 1000 medias muestrales de diferentes muestras de tamaño 100 y calculo su desviación típica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">muchas_medias <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">replicate</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, {</span>
<span id="cb2-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mean</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(sample_size, population_mean, population_sd))</span>
<span id="cb2-3">})</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sd</span>(muchas_medias)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10.00571</code></pre>
</div>
</div>
<p>Y ahora lo comparo con la división de la desviación típica de la población entre la raíz cuadrada del tamaño muestral: 10. ¿A que se parecen bastante?</p>
<p>Pero el margen de error no depende solo de eso, sino que falta el numerito extra. O sea, tiene sentido que el margen de error dependa de la desviación típica de lo que estás estimando, pero falta lo de la <em>confianza</em>. Si quieres mucha confianza, tendrás que aumentar de alguna forma el margen de error; y si quieres menos confianza, tendrás que reducirlo.</p>
<p>Para eso necesitas el estadístico <img src="https://latex.codecogs.com/png.latex?z">. Nos interesa el intervalo de confianza al 95%, ¿no? Pues este valor <img src="https://latex.codecogs.com/png.latex?z"> lo puedes ver como el valor de la distribución normal <img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BN%7D(0,%201)"> que deja a su izquierda el 95% de la probabilidad. O sea, los números mayores que él, solo aparecerán en una distribución normal con un 5% de probabilidad.</p>
<p>Al multiplicar este valor por la desviación típica de la media muestral, lo que estás haciendo es llevar el margen de error a la escala de tu población (y no dejarla en la de una normal 0-1).</p>
<p>Pues ahora ya está todo.</p>
<p>Si eres alguien anclado en el siglo XX, buscarás el valor de <img src="https://latex.codecogs.com/png.latex?z"> en una tabla. Si vives en el presente, usarás algún software que te lo busque.</p>
<p>En R puedes usar la función <code>qnorm()</code>.</p>
<p>Quieres el 95% de probabilidad, pero ten en cuenta que la distribución normal es simétrica. Así que necesitas el extremo que deje el 2.5% a su derecha y el que deje el 2.5% a su izquierda. Lo puedes hacer con <code>qnorm(c(0.025, 0.975))</code>.</p>
<p>El resultado es que el intervalo es (988.1186572, 1027.3179369).</p>
<p>Si tienes en cuenta que la media poblacional era 1000, no es una estimación horrible.</p>
<p>Pero…</p>
</section>
<section id="interpretación-del-intervalo" class="level2">
<h2 class="anchored" data-anchor-id="interpretación-del-intervalo">Interpretación del intervalo</h2>
<p>¿Cómo interpretas esos valores? La interpretación <strong>no</strong> es que el valor de la media poblacional está ahí dentro con un 95% de probabilidad.</p>
<p>La media poblacional es un dato, es una realidad. No sabemos si está dentro o no, pero no hay una probabilidad para indicar dónde está.</p>
<p>Vamos a ver cómo se interpreta.</p>
<p>En lugar de dar la definición formal de intervalo de confianza, que no hay dios que la entienda, vamos a construir muchos intervalos de confianza.</p>
<p>Construyo 10^{4} intervalos de confianza, cada uno a partir de una muestra diferente, pero todas provenientes de la misma población.</p>
<p>Cada muestra tendrá una media, que aprovecho y calculo también.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(purrr)</span>
<span id="cb4-2">experiments <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(computations), <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(i) {</span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">compute_interval</span>(sample_size, population_mean, population_sd) </span>
<span id="cb4-4">})</span></code></pre></div>
</div>
<p>Fíjate en el siguiente gráfico. Ha habido muestras cuya media muestral ha sido cercana a 960 ó a 1040. Y esas muestras tendrán sus intervalos de confianza centrados en ese valor… tiene pinta de que van a estar lejos de la media poblacional.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-11-05-confianza/index_files/figure-html/sample-mean-distribution-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>De esos experimentos que hemos hecho, podemos extraer también los intervalos de confianza. Voy a pintártelos para que veas dónde han caído.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-11-05-confianza/index_files/figure-html/plot-confints-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Toda esa banda morada son los 10^{4} intervalos de confianza calculados. La línea amarilla realmente es una sucesión de puntos (como todas las líneas) con cada media muestral.</p>
<p>La línea negra es la media poblacional. Y fíjate en que hay unos pocos intervalos (los de más abajo y los de más arriba, los extremos) que no tocan esa línea negra. O sea, <strong>hay intervalos que no contienen a la media poblacional.</strong></p>
<p>Esto es muy fuerte.</p>
<p>Al principio he tomado una muestra, he calculado la media muestral como estimación de la poblacional, y en torno a ella he construido un intervalo de confianza.</p>
<p>Ese intervalo era un posible intervalo de confianza al 95% por ciento. Y en ese caso sí contenía a la media poblacional (cosa que sé porque estoy en un experimento controlado, pero lo normal es que no sepas la media poblacional).</p>
<p><strong>Pero si me hubiera salido como muestra una diferente, podría haber ocurrido que el intervalo no hubiera contenido a la media poblacional.</strong></p>
<p>Muy fuerte esto.</p>
<p>Pero la pregunta que surge ahora es: <strong>¿cuántos intervalos no contienen a la media poblacional?</strong></p>
<p>Pues aquí entra el 95%.</p>
<section id="el-95-de-los-intervalos-de-confianza-al-95-contienen-la-media-poblacional" class="level3">
<h3 class="anchored" data-anchor-id="el-95-de-los-intervalos-de-confianza-al-95-contienen-la-media-poblacional">El 95% de los intervalos de confianza al 95% contienen la media poblacional</h3>
<p>A continuación calculo el porcentaje de intervalos que sí contienen a la media poblacional, teniendo en cuenta a los 10^{4} que he calculado.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9519</code></pre>
</div>
</div>
<p>Me sale que el 95,19% de los intervalos calculados contienen a la media poblacional.</p>
<p>Eso es lo que quiere decir que tengas un intervalo de confianza al 95%. Significa que, de todos los intervalos que puedes calcular, el 95% tendrá al parámetro real. Pero el tuyo no sabes si está en ese 95% o no lo está (repito, en este experimento sí sabemos si está en ese porcentaje porque es un experimento controlado pero normalmente no lo sabes).</p>
<p>De hecho, puedo cambiar el nivel de confianza, y el porcentaje cambiará acorde a ello:</p>
<p><strong>Confianza al 99%</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
    pct
  &lt;dbl&gt;
1 0.990</code></pre>
</div>
</div>
<p><strong>Confianza al 80%</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
    pct
  &lt;dbl&gt;
1 0.803</code></pre>
</div>
</div>


</section>
</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-11-05-confianza/</guid>
  <pubDate>Sat, 11 Nov 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Pirámide de población española, desde 1971</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-10-20-piramide-de-poblacion/</link>
  <description><![CDATA[ 





<p>Te traigo una película de terror, llamada <em>La quiebra de las pensiones en España</em>.</p>
<p>Es un GIF que he hecho con la librería ggplot2 de R, y gganimate.</p>
<p>Si quieres el código, me lo pides y te lo mando (o lo buscas en mi GitHub).</p>
<p>Los datos vienen del INE.</p>
<p>En el gráfico aparecen unos valores missing en un momento dado, pero ni idea de por qué, porque dato hay.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] ""</code></pre>
</div>
</div>
<p><img src="https://lhansa.github.io/posts/2023-10-20-piramide-de-poblacion/piramide-poblacion.gif" class="img-fluid"></p>
<p>Puede serte más práctico tener todos los gráficos seguidos, en lugar de quedarte mirando un GIF.</p>
<p>Aquí los tienes:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-10-20-piramide-de-poblacion/facets.jpeg" class="img-fluid figure-img"></p>
<figcaption>Pirámides de población desde 1971 hasta 2021</figcaption>
</figure>
</div>



 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-10-20-piramide-de-poblacion/</guid>
  <pubDate>Fri, 20 Oct 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Paseo en bicicleta eléctrica por Madrid</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-10-12-bicimad/</link>
  <description><![CDATA[ 





<p>Últimamente tengo la sensación de que las estaciones de Bicimad, el servicio de bicis públicas de Madrid, están vacías.</p>
<p>Cuando abro la app, veo que las estaciones de la mitad sur de Madrid están llenas, y las de la mitad norte están vacías.</p>
<p>Quería ver si los datos públicos me decían algo pero:</p>
<ul>
<li>He tardado casi dos horas en leer el json de datos, porque está escrito como si… no sé. O sea, se suele decir que los datos en json están semiestructurados. Pues mira, los datos de una fotografía tienen más estructura que el json de estos datos públicos.</li>
<li>Los datos que me he puesto a ver (los de estaciones) solo están hasta diciembre de 2022. Como me di cuenta de esto en verano, he cogido los datos de julio de 2022.</li>
</ul>
<p>Los datos de junio los he agregado a nivel horario y calculo la proporción media horaria de bases disponibles.</p>
<p>Eso es lo que puedes ver aquí:</p>
<p><img src="https://lhansa.github.io/posts/2023-10-12-bicimad/output.gif" class="img-fluid"></p>



 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-10-12-bicimad/</guid>
  <pubDate>Thu, 12 Oct 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Cómo visualizar cualquier conjunto de datos en 2 dimensiones</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-09-30-tsne/</link>
  <description><![CDATA[ 





<p>En este post te muestro cómo puedes usar el algoritmo t-SNE con R para visualizar datos de grandes dimensiones en solo 2.</p>
<p>Utilizo el conjunto de datos MNIST, que tiene 60.000 observaciones de cifras escritas a mano, determinadas por una malla de 28x28 con un indicador del nivel de gris que hay en cada píxel del mallado.</p>
<p>Cada una de las observaciones viene dada por el nivel de gris que hay en cada píxel, o sea, por 784 variables.</p>
<p>Si quisieras hacer una visualización de cómo se distribuyen tus observaciones en todas esas variables… pues simplemente no podrías.</p>
<p>t-SNE te lo proyecta todo en 2 dimensiones, para que puedas luego visualizarlo.</p>
<section id="preparación-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="preparación-de-datos">Preparación de datos</h2>
<p>He hecho un poco de trampa y los datos ya los tengo preparados. Pero vamos, que voy a usar los datos que tienes si ejecutas <code>keras::dataset_mnist()</code>. Concretamente la parte de entrenamiento.</p>
<p>Y bueno, tendrás que ejecutar eso y configurarlo bien, porque menuda aventura: Python y sus entornos virtuales.</p>
<p>Aparte, usaré librerías de tidyverse para dar forma a los datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(dplyr)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyr)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(purrr)</span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(Rtsne)</span>
<span id="cb1-6"></span>
<span id="cb1-7">ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_set</span>(ggplot2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_light</span>())</span></code></pre></div>
</div>
<p>Para lo que quiero hacer no necesito las 60.000 observaciones que hay, así que me quedo con las 1000 primeras.</p>
<div class="cell" data-labs="prep-data">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">max_number <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># map_dfr(seq_len(dim(mnist)[1]), function(i) {</span></span>
<span id="cb2-3">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dfr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(max_number), <span class="cf" style="color: #003B4F;
background-color: null;
font-style: inherit;">function</span>(i) {</span>
<span id="cb2-4">  data_aux <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> mnist[i, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>] </span>
<span id="cb2-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">colnames</span>(data_aux) <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Y"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>)</span>
<span id="cb2-6">  </span>
<span id="cb2-7">  data_aux <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"X"</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">28</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unite</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"variable"</span>, x, y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">case =</span> i)  </span>
<span id="cb2-13">})</span>
<span id="cb2-14"></span>
<span id="cb2-15">data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> data <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|&gt;</span> </span>
<span id="cb2-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> variable, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> value)</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(data)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000  785</code></pre>
</div>
</div>
<p>La columna extra es la que me indica que son observaciones diferentes.</p>
</section>
<section id="cómo-aplicas-t-sne" class="level2">
<h2 class="anchored" data-anchor-id="cómo-aplicas-t-sne">Cómo aplicas t-SNE</h2>
<p>Mira, sinceramente ni idea.</p>
<p>O sea, tú ejecuta <code>Rtsne()</code> sobre tu <em>data frame</em> y surge la magia.</p>
<div class="cell" data-labs="tsne">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">tsne_fit <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Rtsne</span>(data)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">dim</span>(tsne_fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1000    2</code></pre>
</div>
</div>
</section>
<section id="cómo-puedes-visualizar-t-sne" class="level2">
<h2 class="anchored" data-anchor-id="cómo-puedes-visualizar-t-sne">Cómo puedes visualizar t-SNE</h2>
<p>Recupero de los datos originales la etiqueta del número que se supone que representa cada mallado. Como estoy trabajando solo con los 1.000 primeros, me quedo solo con esos.</p>
<p>En el gráfico muestro cómo se distribuyen los puntos y los coloreo en función de si son un 0, 1, 2, 3, etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">df_to_plot <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_tibble</span>(tsne_fit<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>Y)</span>
<span id="cb6-2">df_to_plot<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>label <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(number_labels[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span>max_number])</span>
<span id="cb6-3"></span>
<span id="cb6-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(df_to_plot) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> V1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> V2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> label)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(</span>
<span id="cb6-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"t-SNE applied to MNIST dataset"</span>,</span>
<span id="cb6-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sprintf</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Sample of first %i elements"</span>, max_number), </span>
<span id="cb6-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">caption =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Source: keras::dataset_mnist()"</span></span>
<span id="cb6-10">  )</span></code></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-09-30-tsne/index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-09-30-tsne/</guid>
  <pubDate>Sat, 30 Sep 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>¿Existe la suerte?</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-09-28-fooled-by-randomness/</link>
  <description><![CDATA[ 





<ul>
<li><p><strong>Probabilidad:</strong> falta de certidumbre en nuestro conocimiento y el desarrollo de métodos para lidiar con nuestra ignorancia. en el mundo real muchas veces tienes que averiguar el problema más que la solución.</p></li>
<li><p>De la misma forma que un antepasado se rescaba la nariz y veía llover, pensaba que el rascarse la nariz inducía lluvia, acualmente ligamos la prosperidad económica a un recorte de los bancos centrales.</p></li>
<li><p>Presentamos conjeturas como verdades porque no manejamos bien las probabilidades.</p></li>
<li><p>Lo que obtienes por suerte es fácil que te desaparezca por azar. Lo que obtienes sin la cción de la suerte es más robusto a la incertidumbre.</p></li>
<li><p>Dos problemas ante un estado:</p>
<ul>
<li>Los cisnes negros.</li>
<li>La simetría (de poco sirven muchos éxitos si un fracaso te lo quita todo)</li>
</ul></li>
<li><p>Experimento s xix. Paciente amnésica, hay que presentarse cada 15 minutos. Un día, estrechan la mano con una chincheta. Al día siguiente, la paciente no recuerda al interlocutor pero retira la mano de manera instintiva.</p></li>
<li><p>Nos fijamos en los éxitos (como tecnologías que han cambiado nuestra vida) pero no en los fracasos (como patentes que se han quedado en el olvido)</p></li>
<li><p>El ratio de información no verificada frente a la verificada aumenta.</p>
<ul>
<li>Misma idea de <em>la señal y el ruido</em> de Nate Silver.</li>
</ul></li>
<li><p>En la Italia renacentista, las aseguradoras cobraban la misma tasa a un varón de 20 años que a uno de 50, porque su vida extra esperada era la misma (alguien que sobrepasaba los 40 había demostrado resistencia a muchos obstáculos y posiblemente ya llegaría a viejo).</p></li>
<li><p>Lo que uno observa en los mercados financieros es, en el mejor de los casos, varianza más retornos, no solo retornos.</p></li>
<li><p>Centrarse en la aleatoriedad, en el corto plazo, desgasta, quema, frustra y deprime, por la constante exposición a sus golpes de dolor.</p></li>
<li><p>my problem is that I’m not rational and I’m extremely prone to drown in randomness and to incur emotional torture. My only advantage in life is that i know some of my weaknesses, mostly that I’m incapable of taming my emotions facing news and incapable of seeing a performance with a clear head. Silence is far better.</p></li>
<li><p>Fashionable nonsense, by alan sokal</p></li>
<li><p><em>and such a crowd</em> (y esta banda)</p></li>
<li><p>si lo siguiente se parece a un discurso de un mandamás de tu empresa, búscate otro trabajo:</p></li>
</ul>
<blockquote class="blockquote">
<p>We look after our customer’s interests/the road ahead / our assets are our people / creation of shareholder value / our vision / our expertise lies in / we provide interactive solutions / we position ourselves in this market / how to serve our customers better / short- term pain for long-term gain/we will be rewarded in the long run / we play from our strength and improve our weaknesses / courage and determination will prevail / we are committed to innovation and technology / a happy employee is a productive employee / commitment to excellence / strategic plan / our work ethics.</p>
</blockquote>
<ul>
<li><p>Le preguntaron en un evento si creía que el mercado iba a subir o bajar en la próxima semana. Dijo que subiría. Y respondieron que entonces por qué estaba en corto. Por asimetría. Él creía que había mucha probabilidad de que subiera (pero muy poco, solo un 1%). - Pero había una probabilidad de 30% de bajar 10%. Con todo, el resultado esperado era una bajada.</p></li>
<li><p>we could either be too lax or too stringent in accepting past information as a prediction of the future. I need a lot more than data. My major reason is the rare event, but i have plenty of others.</p></li>
<li><p>la historia nos enseña que cosas que nunca han ocurrido ocurren.</p></li>
<li><p>Tiendes a ser más sensible a la presencia o ausencia de un estímulo que a la variación en su magnitud. Esto implica (en mercados financieros) que una pérdida es al principio solo una pérdida, con drásticas consecuencias a la larga</p></li>
<li><p>Emocionalmente, prefieres muchas ganancias y pocas pérdidas, aunque en magnitud eso no tenga que ser bueno.</p></li>
<li><p>En ciencia, puedes estar haciendo experimentos fallidos muchas veces, hasta que una por fin sale un resultado exitoso.</p></li>
<li><p>La serie temporal de éxito puede parecer plana con un pico al final, pero se puede ver como una probabilidad acumulada (relación con James Clear)</p></li>
<li><p>Esto mismo se puede aplicar al mercado editorial, a entrenamiento físico (basado en el ritmo de cazadores recolectores del paleolítico) o inversión para aprovechar crisis.</p></li>
<li><p>La estadística nos falla cuando tenemos distribuciones asimétricas: imagina una urna con bolas rojas y negras, pero en la que sacar bola roja tiene una probabilidad muy muy baja. Si quiero saber si hay bolas rojas y mi método consiste en ir sacando bolas (por probabilidad, serán casi siempre negras), el aumentar el tamaño muestral no me ayuda a estar más seguro de si hay bolas rojas o no si siempre saco bolas negras. Y si saco una roja, aumentar el tamaño muestral tampoco me aporta más información.</p></li>
<li><p>Lo importante de esto es que aumentar progresivamente el tamaño muestral no garantiza que aumente la información</p></li>
<li><p>Robert Lucas: si la gente fuera racional, entonces aplicarían es razón para entender patrones del pasado y adaptarse, de forma que la información pasada seria inutil para predecir el futuro.</p></li>
<li><p>Aprende a gestionar la aleatoriedad manteniendo una mente abierta y cambiando de opinión sin que te dé vergüenza.</p></li>
<li><p>Usaré la estadística cuando me beneficie y la evitaré cuando me perjudique. Aprenderé del pasado pero sin caer en sus peligros. Por ello usaré la estadística para hacer apuestas agresivas (estadísticamente, qué probabilidad hay de que algo poco probable pero beneficioso ocurra) pero no la usaré para protegerme frente a riesgos (que algo malo históricamente nunca haya ocurrido no significa que no vaya a ocurrir).</p></li>
<li><p>El coste de estar equivocado en una apuesta tiene que ser asumible y estar limitado.</p></li>
<li><p>Si juntas a infinitos monos frente a un teclado, alguno acabará tecleando la Iliada. Ahora bien, ¿cuál es la probabilidad de que ese mono esceiba a continuación la Odisea? Dicho de otra forma, ¿hasta qué punto el rendimiento pasado es un buen indicador del rendimiento futuro?</p></li>
<li><p>De cara a valorar una empresa, si tienes muchas empresas, es probable que alguna lo esté haciendo bien por casualidad, no por capacidad. ¿Cómo sabes cuál es para no invertir en ella? y en inversiones, ves a inversores que les sale bien su inversión, pero ¿cómo sabes que no es por casualidad? Además, solo ves a los buenos. Los fracasados están escondidos y no conoces la probabilidad de ser bueno.</p></li>
<li><p>El sesgo del superviviente es habitual porque estamos acostumbrados a aprovechar la información que tenemos delante de nosotros e ignorar la que no vemos.</p></li>
<li><p>Nadie acepta la aleatoriedad en su éxito; solo en su fracaso.</p></li>
<li><p>Si la nariz de Cleopatra hubiera sido distinta el mundo sería totalmente diferente (porque Julio César quedó prendado por su nariz). - (Pascal, ejemplo de caos)</p></li>
<li><p>what has gone wrong with the development of economics as a science? Answer: there was a bunch of inteligent people who felt compelled to use mathematics just to tell themselves that they were rigorous in their thinking, that theirs was a science.</p></li>
<li><p>El camino hacia el éxito no tiene por qué depender de la suerte, sino de la constancia. La constancia en un camino sin frutos es la que acaba llevándote al evento raro, al momento en que ves que has avanzado y progresado. El camino hacia el éxito puede no ser alestorio, pero muy poca gente tiene la entereza de seguirlo hasta el final. Aquellos que dan el paso extra son los recompensados.</p></li>
<li><p>Me estoy dando cuenta del efecto no lineal tras el éxito en cualquier campo. Es mejor tener unos pocos entusiastas de tu trabajo que muchos seguidores a los que les pareces bien. Mejor ser amado por una docena que gustar a cientos.</p></li>
<li><p>El valor esperado es aquel en el que si te quieres ir de vacaciones a París o al Caribe, puedes imaginarte a la vez tumbado en una playa paridisíaca visitando el museo de Orsay. O sea, algo imposible pero que se usa una y otra vez para cuantificar escenarios. las reglas tienen su utilidad. No las seguimos porque sean correctas, sino porque nos ahorran tiempo y esfuerzo (por ejemplo, salir corriendo cuando ves algo que pueda ser un depredador, lo sea o no lo sea).</p></li>
<li><p>Sesgos cognitivos: si vemos un número, tendemos a anclarnos a él en nuestras estimaciones. Las emociones son atajos para tomar decisiones. Una decisión puramente matemática requeriría tiempo infinito por la cantidad de información que hay que procesar.</p></li>
<li><p>Si estás pensando en equipaje para un viaje, la varianza en la temperatura puede condicionarte más que el valor esperado.</p></li>
<li><p>No soy tan inteligente ni tan fuerte como para controlar mis emociones. Es más, las necesito para tomar decisiones y ejecutarlas.</p></li>
<li><p>Si mides una mesa con una regla de cuya precisión no te fías, obtienes más información de la regla que de la mesa. Si lees una valoración de un usuario al que no conoces, obtienes más información del usuario que del contenido revisado. tratado sobre la risa, henri Bergson</p></li>
<li><p>A los 25, ignoraba totalmente la ciencia del comportamiento. Me habían hecho creer erróneamente en mi juventud que mis supersticiones eran culturales, y que por ello podía deshacerme de ellas mediante el uso del raciocinio.</p></li>
<li><p>La ciencia está bien; los científicos son humanos. Un científico puede tener que actuar como un picapleitos defensor de una causa sin sentido en lugar de limitarse a buscar la verdad.</p></li>
<li><p>No culpes a otros por tu destino (incluso aunque tengan algo de culpa).</p></li>
<li><p>Lo único de ti sobre lo que no tiene control la suerte es tu comportamiento.</p></li>
<li><p>Cuanto más asciendes profesionalmente, más te pagan. Esto puede estar justificado, ya que tiene sentido pagar a un trabajador acorde a su contribución. Sin embargo, cuanto más asciendes, la evidencia de esta contribución disminuye.</p></li>
<li><p>Un empleado en un nivel bajo en la jerarquía (un perfil técnico) se le evalúa tanto por sus resultados como por su metodología. A medida que asciende, se le evalúa más por resultados. En niveles altos, cómo llegar a buenos resultados da igual, con tal de que se llegue a buenos resultados. Pero el jefe de una gran compañía se puede enfrentar a unas cuantas grandes decisiones cuyo método no se puede repetir (porque las circunstancias del mercado y de la empresa no se repitan). Así, “ser CEO” puede no requerir unas habilidades especiales para conseguir buenos resultados, ya que estos dependen en gran medida de que la empresa esté en las circunstancias adecuadas. Y lo que requiere realmente es tener el carisma y las habilidades sociales correspondientes para caer bien, sin más.</p></li>
<li><p>Si algo se rige por normas aleatorias, viene a funcionarte de la misma forma que si no lo conocieras.</p></li>
<li><p>Valoramos lo visible, lo asentado, lo personal, lo narrado, lo medible, lo tangible; desdeñamos lo abstracto.</p></li>
</ul>



 ]]></description>
  <category>lecturas</category>
  <guid>https://lhansa.github.io/posts/2023-09-28-fooled-by-randomness/</guid>
  <pubDate>Thu, 28 Sep 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Muertes de humanos causadas por otros animales</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-08-14-muertes-humanas/</link>
  <description><![CDATA[ 





<p>Siempre me ha fascinado el dato que te voy a enseñar ahora.</p>
<p><strong>¿Cuál es el animal que más humanos mata al año?</strong></p>
<p>Hay gente que se come el coco sin llegar a nada. Otros dicen que el humano.</p>
<p>Pero no.</p>
<p>El gráfico siguiente además ayudar a desmitificar peligros, como los tiburones.</p>
<p><strong>Observación.</strong> No consigo encontrar la fuente original de los datos. No es el único sitio donde lo he visto y me gusta la idea general, pero los números quizá no sean fiables (y la traducciones menos todavía, porque esas las he hecho yo, así que eso sí que no xD)</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-08-14-muertes-humanas/index_files/figure-html/everything-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Hay 5 ideas que me encantan de esto:</p>
<ul>
<li>Los insectos matan a mazo, mazo de humanos.</li>
<li>Los tiburones, mal vistos por películas, no suponen mucho problema.</li>
<li>Los humanos matamos mucho, pero no somos lo peor (casi sí).</li>
<li>Los perros, ellos tan amigos, pero cuidado con ellos.</li>
<li>¿Algo parecido a regla de Pareto?</li>
</ul>
<p>La fuente es <a href="https://www.cbsnews.com/pictures/the-20-deadliest-animals-on-earth-ranked/">esta.</a></p>



 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-08-14-muertes-humanas/</guid>
  <pubDate>Mon, 14 Aug 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Personas centenarias [tidytuesday]</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-07-21-tidytuesday-oldest-people/</link>
  <description><![CDATA[ 





<p>Exploración de datos del <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2023/2023-05-30/readme.md">tidytuesday del 30 de mayo de 2023.</a></p>
<p>Sitúo por año de nacimiento a los centenarios. Habrá en los años más recientes, seguramente porque la población era mayor (en un periodo tan breve, no creo que los avances médicos supusieran tanta diferencia).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-tidytuesday-oldest-people/index_files/figure-html/per-year-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="cómo-varía-en-función-de-las-variables-que-hay" class="level2">
<h2 class="anchored" data-anchor-id="cómo-varía-en-función-de-las-variables-que-hay">¿Cómo varía en función de las variables que hay?</h2>
<p>No tengo a mano los datos de población de los países pero me vale esto para hacerme una idea.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-tidytuesday-oldest-people/index_files/figure-html/per-country-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No hay diferencia entre chico/chica:</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Género</th>
<th style="text-align: right;">Personas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">female</td>
<td style="text-align: right;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">male</td>
<td style="text-align: right;">100</td>
</tr>
</tbody>
</table>
</div>
</div>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-07-21-tidytuesday-oldest-people/</guid>
  <pubDate>Fri, 21 Jul 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Muestreo (II)</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-07-21-muestreo-ii/</link>
  <description><![CDATA[ 





<p><a href="https://longitudsinanchura.com/posts/2023-07-18-muestreo/">Hace unos días</a> cacharreaba con algunos conceptos sobre el muestro.</p>
<p>Hoy verás conceptos sobre distribuciones de un estadístico de una muestra.</p>
<section id="distribución-muestral-exacta" class="level2">
<h2 class="anchored" data-anchor-id="distribución-muestral-exacta">Distribución muestral exacta</h2>
<p>Imagina que tienes cuatro dados y los lanzas. El primer dado puede sacar uno de seis posibles valores; el segundo, igual; y así… Es decir, el primero puede sacar 6 valores, el segundo, otros 6… Matemáticamente:</p>
<p><img src="https://latex.codecogs.com/png.latex?6%20%5Ctimes%206%20%5Ctimes%206%20%5Ctimes%206%20=%206%20%5E%204%20=%206%20%5E%20%7B%5Cmbox%7Bdados%7D%7D"></p>
<p>Lanzas una vez y calculas la suma de las caras que ves sobre la mesa (un juego de dados típicos es apostar a la suma de las caras tras lanzar dos dados). Lanzas otra vez y calculas la suma de nuevo. Y así…</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/generate-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Este, con 4 dados, es un caso razonablemente pequeño y has podido calcular todos los resultados posibles. Concretamente, ese gráfico representa la distribución exacta de la suma de lanzar 4 dados.</p>
<p>En el gráfico puedes ver que el resultado con más casos favorables es 14, con 146 repeticiones.</p>
<p><strong>¿Pero qué ocurre si tienes más dados?</strong></p>
</section>
<section id="simulación-de-la-distribución-muestral" class="level2">
<h2 class="anchored" data-anchor-id="simulación-de-la-distribución-muestral">Simulación de la distribución muestral</h2>
<p>En el curso de Datacamp de donde estoy sacando estas ideas dicen que, si tiras 100 dados, tienes tantas combinaciones posibles como átomos hay en el universo: 6.5331862^{77}</p>
<p>Cuando no puedes replicar la distribución exacta porque el número de casos es enorme, o porque no tienes acceso a toda la población (bien por tecnología, bien por coste, …), necesitas una aproximación a esa distribución.</p>
<p>Por ejemplo, si en el caso de 4 dados no pudiéramos replicar todos los lanzamientos, podríamos buscar una aproximación mediante algunos lanzamientos. En el gráfico anterior están los 1296 casos posibles. Vamos a ver cómo queda esa distribución si lo aproximamos con 750 simulaciones.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/sim750-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>No es igual pero la forma es parecida. <strong>Una nota importante:</strong> en este caso estamos simulando, o sea, no estamos tomando los resultados posibles reales, sino que estamos haciendo como que tiramos los dados y apuntamos la suma. Es decir, como no es el caso teórico, incluso aunque repitiéramos la simulación tantas veces como casos posibles hay, nada garantiza que vayamos a obtener la distribución exacta de antes.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/sim1296-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="y-esto-para-qué-sirve" class="level3">
<h3 class="anchored" data-anchor-id="y-esto-para-qué-sirve">Y esto, ¿para qué sirve?</h3>
<p><em>Oye, Leo, pero yo ya he calculado la distribución exacta. ¿Para qué quiero esta aproximación?</em></p>
<p>Como esa aproximación se parece a la distribución exacta, cuando no puedes acceder a la exacta, puedes usar esta:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/sim10000-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="teorema-central-del-límite" class="level2">
<h2 class="anchored" data-anchor-id="teorema-central-del-límite">Teorema central del límite</h2>
<p>Imagina que fijas un tamaño muestral. Y para ese tamaño muestral, replicas muchas veces un experimento.</p>
<p>El experimento va a consistir en calcular la media de la profundidad de unos <a href="https://ggplot2.tidyverse.org/reference/diamonds.html">diamantes.</a></p>
<p>La media de toda la muestra es 61.7494049.</p>
<p>En el siguiente gráfico tienes la distribución de la media muestral cuando el tamaño muestral es 5, 100, 500 y 1.000 (el total de la muestra es superior a 50.000).</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="https://lhansa.github.io/posts/2023-07-21-muestreo-ii/index_files/figure-html/diamonds-sample-mean-plot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Lo interesante de este gráfico es que puedes ver cómo, a medida que aumenta el tamaño muestral, los cálculos de la media con ese tamaño son cada vez más estables. La línea vertical es la media <em>poblacional</em> y puedes ver que las colas son cada vez menos pesadas (más <em>normales</em>).</p>
<hr>
<p>Pero realmente he hablado de estadístico poblacional cuando realmente estoy trabajando con una muestra (aunque tenga 50.000 diamantes, eso no es toda la población de la muestra).</p>
<p>La solución a este problema te lo cuento el próximo día.</p>


</section>

 ]]></description>
  <category>datos</category>
  <guid>https://lhansa.github.io/posts/2023-07-21-muestreo-ii/</guid>
  <pubDate>Fri, 21 Jul 2023 00:00:00 GMT</pubDate>
</item>
<item>
  <title>7 hábitos de la gente altamente efectiva</title>
  <dc:creator>Leonardo Hansa</dc:creator>
  <link>https://lhansa.github.io/posts/2023-07-20-7-habitos-gente-altamente-efectiva/</link>
  <description><![CDATA[ 





<section id="ideas-introductorias" class="level2">

<ul>
<li>Mapa y territorio. Un cambio de paradigma te puede ayudar a controlar mejor el territorio.
<ul>
<li>Mucha autoayuda falla porque enseñan un mapa sobre un territorio equivocado. Si estás usando un mapa que no se ajusta a tu territorio, no lo puedes aplicar.</li>
</ul></li>
<li>Inside-out. Las victorias personales van antes que las públicas. Para mejorar las relaciones con los demás debes mejorar antes la tuya contigo mismo.</li>
</ul>
</section>
<section id="sé-proactivo" class="level2">
<h2 class="anchored" data-anchor-id="sé-proactivo">1. Sé proactivo</h2>
<ul>
<li>El amor es un verbo. La gente proactiva se sacrifica por otros.</li>
<li>Aplicación:
<ol type="1">
<li>Durante un día fíjate en tu lenguaje y el de los demás. “Cuántas veces escuchas no puedo”, “ojalá”, “tengo que”…</li>
<li>Identifica una experiencia con la que si te encuentras reaccionarías de manera reactiva. ¿Cómo la convertirás en proactiva?</li>
<li>Elige un problema personal o profesional que te frustre. ¿Qué puedes hacer que ayude a mejorarlo.</li>
<li>Durante treinta días trabaja en tu círculo de influencia con pequeños compromisos: no juzgues, no critiques, no discutas, no culpes. Trabaja en las cosas sobre las que tienes control.</li>
</ol></li>
</ul>
</section>
<section id="empieza-con-el-final-en-mente" class="level2">
<h2 class="anchored" data-anchor-id="empieza-con-el-final-en-mente">2. Empieza con el final en mente</h2>
<ul>
<li>En tu funeral van a decir unas palabras sobre ti. ¿Qué te gustaría que dijeran? ¿Cómo te gustaría que te recordaran?</li>
<li>Empieza cada día con la imagen del final de tu vida, que ese sea tu criterio para evaluar tus acciones.</li>
<li>Todo se crea en dos fases: una mental y otra física. Tú eres la segunda creación de tu propio diseño proactivo previo, o la segunda creación de los planes de otras personas, o circunstancias o costumbres pasadas.</li>
<li>El hábito 1 es “tú eres el creador”. El hábito 2 es la primera creación.</li>
<li>Solemos necesitar más un destino y una brújula (conjunto de principios y direcciones) y menos una hoja de ruta. <strong>El camino por delante no lo conocemos y necesitarás improvisar más de lo previsto.</strong></li>
<li>Soy quien soy hoy por las decisiones que tomé ayer.</li>
<li>Cuando quieras ser efectivo, piensa de manera amplia. No tiene sentido que te centres en tu éxito profesional si dejas de lado tu salud.</li>
<li>Piensa en tu visión a largo y misión en varios roles. Eso te dará balance</li>
</ul>
</section>
<section id="pon-primero-lo-primero" class="level2">
<h2 class="anchored" data-anchor-id="pon-primero-lo-primero">3. Pon primero lo primero</h2>
<ul>
<li>Las personas exitosas tienen el hábito de hacer lo que los fracasados no quieren hacer.</li>
<li>La gente poco efectiva dedica mucho tiempo a <strong>cosas urgentes poco importantes</strong> (en general, actividades con origen en otras personas). Luego desconectan un poco con actividades poco urgentes y poco importantes (Netflix…).</li>
<li>No te hagas planes de organización diarios sino semanales.</li>
</ul>
</section>
<section id="piensa-en-winwin" class="level2">
<h2 class="anchored" data-anchor-id="piensa-en-winwin">4. Piensa en win/win</h2>
<ul>
<li>Busca soluciones que beneficien a todas las partes involucradas.</li>
<li>Hay casos contrarios a eso:
<ul>
<li>Hay incentivos para pensar en <strong>win/lose</strong>. La ley está motivada por el que hay un enemigo al que hay que ganar, mediante abogados y juicios.</li>
<li>El <strong>lose/lose</strong> ocurre cuando se juntan dos personas cuyo objetivo es hacer que su enemigo pierda, aunque sea a costa de su propio bienestar.</li>
</ul></li>
<li><strong>win/win or no deal.</strong> Si no podemos llegar a un acuerdo en el que los dos salgamos beneficiados, es mejor no cerrar acuerdo.</li>
<li>la actitud de un individuo tiene dos dimensiones: valor y consideración. <strong>Win/win</strong> consiste en maximizar ambos.</li>
<li><strong>Mentalidad de abundancia:</strong> hay suficiente para todos.</li>
</ul>
</section>
<section id="busca-primero-entender-luego-ser-entendido" class="level2">
<h2 class="anchored" data-anchor-id="busca-primero-entender-luego-ser-entendido">5. Busca primero entender, luego ser entendido</h2>
<ul>
<li>Imagina un óptico que recomienda a un cliente las gafas que tiene él, sin diagnosticar.</li>
<li>Historia del Padre que no escucha a su hijo…</li>
<li>Las necesidades cubiertas no motivan.</li>
</ul>
</section>
<section id="sinergiza" class="level2">
<h2 class="anchored" data-anchor-id="sinergiza">6. Sinergiza</h2>
<ul>
<li>Trabaja en equipo y crea sinergias para buscar equipos comunes.</li>
<li>Ejemplo de los fundadores de Apple</li>
</ul>
</section>
<section id="afila-la-sierra" class="level2">
<h2 class="anchored" data-anchor-id="afila-la-sierra">7. Afila la sierra</h2>
<ul>
<li>Cuidar y mejorar continuamente los cuatro aspectos de tu vida: físico, mental, emocional y espiritual.
<ul>
<li>Queremos estar saludables pero no dedicamos 30 minutos al ejercicio.</li>
<li>Queremos ser inteligentes pero no pasamos 20 minutos leyendo.</li>
<li><strong>Trabajo, familia, relajación…</strong></li>
</ul></li>
<li>Cuatro dimensiones de control introspectivo: físico, mental, social y espiritual.</li>
<li>Ejercicio de fuerza. Hay que apurar hasta el final porque es como el cuerpo sabrá que hay que regenerar fibras musculares más fuertes. Igual pasa con la paciencia.</li>
<li>Aspecto espiritual: hay personas que encuentran en la inmersión en la música o literatura la misma satisfacción espiritual que otras personas en la meditación o en la lectura de escrituras sagradas.</li>
<li>Prescripción médica: ve a un sitio que tengas buen recuerdo de niño. A las 9, escucha. A las 12, try reaching back (estudia el pasado). A las 3, explora tus motivos (si tus motivos están mal, entonces todo lo que haces está mal). A las 6, escribe tus preocupaciones en la arena.</li>
<li>La lectura nos ayuda con el hábito de primero entender, ya que nos educa en el hábito de no poner nuestra autobiografía en medio de cada idea que nos llegue.</li>
<li>Hans Selye: “una vida larga, sana y feliz es el resultado de hacer contribuciones”</li>
<li>“Trata a una persona como es, y seguirá igual. Trata a un persona como puede ser, y llegará a ello” (Goethe)</li>
</ul>


</section>

 ]]></description>
  <category>lecturas</category>
  <guid>https://lhansa.github.io/posts/2023-07-20-7-habitos-gente-altamente-efectiva/</guid>
  <pubDate>Thu, 20 Jul 2023 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
